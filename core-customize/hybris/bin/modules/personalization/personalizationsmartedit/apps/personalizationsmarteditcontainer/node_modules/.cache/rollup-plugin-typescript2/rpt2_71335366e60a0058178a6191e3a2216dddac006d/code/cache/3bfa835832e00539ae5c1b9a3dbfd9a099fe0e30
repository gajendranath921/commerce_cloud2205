{"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { IPersonalizationsmarteditContextMenuServiceProxy, PersonalizationsmarteditMessageHandler } from 'personalizationcommons';\r\nimport { PersonalizationsmarteditContextService } from 'personalizationsmarteditcontainer/service/PersonalizationsmarteditContextServiceOuter';\r\nimport { PersonalizationsmarteditRestService } from 'personalizationsmarteditcontainer/service/PersonalizationsmarteditRestService';\r\nimport { GatewayProxied, SeDowngradeService, IEditorModalService, IModalService, IRenderService, ModalButtonAction, ModalButtonStyle, LogService } from 'smarteditcommons';\r\nimport { ContextMenuDeleteActionComponent } from './ContextMenuDeleteActionComponent';\r\nimport { PersonalizationsmarteditContextMenuAddEditActionComponent } from './PersonalizationsmarteditContextMenuAddEditActionComponent';\r\nconst MODAL_BUTTONS = [\r\n    {\r\n        id: 'confirmOk',\r\n        label: 'personalization.modal.deleteaction.button.ok',\r\n        style: ModalButtonStyle.Primary,\r\n        action: ModalButtonAction.Close\r\n    },\r\n    {\r\n        id: 'confirmCancel',\r\n        label: 'personalization.modal.deleteaction.button.cancel',\r\n        style: ModalButtonStyle.Default,\r\n        action: ModalButtonAction.Dismiss\r\n    }\r\n];\r\nlet /* @ngInject */ PersonalizationsmarteditContextMenuServiceProxy = class /* @ngInject */ PersonalizationsmarteditContextMenuServiceProxy extends IPersonalizationsmarteditContextMenuServiceProxy {\r\n    constructor(modalService, renderService, editorModalService, personalizationsmarteditContextService, personalizationsmarteditRestService, personalizationsmarteditMessageHandler, translateService, logService) {\r\n        super();\r\n        this.modalService = modalService;\r\n        this.renderService = renderService;\r\n        this.editorModalService = editorModalService;\r\n        this.personalizationsmarteditContextService = personalizationsmarteditContextService;\r\n        this.personalizationsmarteditRestService = personalizationsmarteditRestService;\r\n        this.personalizationsmarteditMessageHandler = personalizationsmarteditMessageHandler;\r\n        this.translateService = translateService;\r\n        this.logService = logService;\r\n    }\r\n    openDeleteAction(config) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!(yield this.confirmDelete())) {\r\n                return;\r\n            }\r\n            yield this.deleteContext(config);\r\n            const combinedView = this.personalizationsmarteditContextService.getCombinedView();\r\n            if (combinedView.enabled) {\r\n                try {\r\n                    const response = yield this.personalizationsmarteditRestService.getActions(config.selectedCustomizationCode, config.selectedVariationCode, config);\r\n                    if (combinedView.customize.selectedComponents) {\r\n                        combinedView.customize.selectedComponents = this.removeItemFromCollection(combinedView.customize.selectedComponents, config.containerSourceId);\r\n                    }\r\n                    combinedView.selectedItems = this.addActionsToVariation(combinedView.selectedItems, config, response.actions);\r\n                    this.personalizationsmarteditContextService.setCombinedView(combinedView);\r\n                }\r\n                catch (_a) {\r\n                    this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant('personalization.error.gettingactions'));\r\n                }\r\n            }\r\n            else {\r\n                const customize = this.personalizationsmarteditContextService.getCustomize();\r\n                customize.selectedComponents = this.removeItemFromCollection(customize.selectedComponents, config.containerSourceId);\r\n                this.personalizationsmarteditContextService.setCustomize(customize);\r\n            }\r\n            this.renderService.renderSlots(config.slotsToRefresh);\r\n        });\r\n    }\r\n    openAddAction(config) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const resultContainer = yield this.modalService\r\n                .open({\r\n                component: PersonalizationsmarteditContextMenuAddEditActionComponent,\r\n                data: config,\r\n                templateConfig: {\r\n                    title: 'personalization.modal.addaction.title',\r\n                    isDismissButtonVisible: true\r\n                },\r\n                config: {\r\n                    focusTrapped: false,\r\n                    backdropClickCloseable: false,\r\n                    modalPanelClass: 'yPersonalizationContextModal'\r\n                }\r\n            })\r\n                .afterClosed.toPromise();\r\n            const combinedView = this.personalizationsmarteditContextService.getCombinedView();\r\n            if (combinedView.enabled) {\r\n                combinedView.customize.selectedComponents.push(resultContainer);\r\n                this.personalizationsmarteditContextService.setCombinedView(combinedView);\r\n            }\r\n            else {\r\n                const customize = this.personalizationsmarteditContextService.getCustomize();\r\n                customize.selectedComponents.push(resultContainer);\r\n                this.personalizationsmarteditContextService.setCustomize(customize);\r\n            }\r\n            this.renderService.renderSlots(config.slotsToRefresh);\r\n        });\r\n    }\r\n    openEditAction(config) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            config.editEnabled = true;\r\n            yield this.modalService\r\n                .open({\r\n                component: PersonalizationsmarteditContextMenuAddEditActionComponent,\r\n                data: config,\r\n                templateConfig: {\r\n                    title: 'personalization.modal.editaction.title',\r\n                    isDismissButtonVisible: true\r\n                },\r\n                config: {\r\n                    focusTrapped: false,\r\n                    backdropClickCloseable: false,\r\n                    modalPanelClass: 'yPersonalizationContextModal'\r\n                }\r\n            })\r\n                .afterClosed.toPromise();\r\n            this.renderService.renderSlots(config.slotsToRefresh);\r\n        });\r\n    }\r\n    openEditComponentAction(config) {\r\n        this.editorModalService.open(config);\r\n    }\r\n    deleteContext(config) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const filter = {\r\n                catalog: config.catalog,\r\n                catalogVersion: config.catalogVersion\r\n            };\r\n            try {\r\n                yield this.personalizationsmarteditRestService.deleteAction(config.selectedCustomizationCode, config.selectedVariationCode, config.actionId, filter);\r\n            }\r\n            catch (error) {\r\n                this.logService.error('An error occurred while deleting context', error);\r\n            }\r\n        });\r\n    }\r\n    removeItemFromCollection(collection, itemToRemove) {\r\n        return collection.filter((item) => item !== itemToRemove);\r\n    }\r\n    addActionsToVariation(items, config, actions) {\r\n        return items.map((item) => {\r\n            if (item.customization.code === config.selectedCustomizationCode &&\r\n                item.variation.code === config.selectedVariationCode) {\r\n                item.variation.actions = actions;\r\n            }\r\n            return item;\r\n        });\r\n    }\r\n    confirmDelete() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            try {\r\n                yield this.modalService\r\n                    .open({\r\n                    component: ContextMenuDeleteActionComponent,\r\n                    config: {\r\n                        modalPanelClass: 'yFrontModal modal-md'\r\n                    },\r\n                    templateConfig: {\r\n                        buttons: MODAL_BUTTONS,\r\n                        title: 'personalization.modal.deleteaction.title'\r\n                    }\r\n                })\r\n                    .afterClosed.toPromise();\r\n                return true;\r\n            }\r\n            catch (_a) {\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n};\r\n/* @ngInject */ PersonalizationsmarteditContextMenuServiceProxy = __decorate([\r\n    GatewayProxied('openDeleteAction', 'openAddAction', 'openEditAction', 'openEditComponentAction'),\r\n    SeDowngradeService(IPersonalizationsmarteditContextMenuServiceProxy),\r\n    __metadata(\"design:paramtypes\", [IModalService,\r\n        IRenderService,\r\n        IEditorModalService,\r\n        PersonalizationsmarteditContextService,\r\n        PersonalizationsmarteditRestService,\r\n        PersonalizationsmarteditMessageHandler,\r\n        TranslateService,\r\n        LogService])\r\n], /* @ngInject */ PersonalizationsmarteditContextMenuServiceProxy);\r\nexport { /* @ngInject */ PersonalizationsmarteditContextMenuServiceProxy };\r\n//# sourceMappingURL=PersonalizationsmarteditContextMenuServiceOuterProxy.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@ngx-translate+core@11.0.1_@angular+core@8.2.14+rxjs@6.5.4/node_modules/@ngx-translate/core/ngx-translate-core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/personalization/personalizationsmartedit/apps/personalizationcommons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/personalization/personalizationsmartedit/apps/personalizationsmarteditcontainer/src/service/PersonalizationsmarteditContextServiceOuter.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/personalization/personalizationsmartedit/apps/personalizationsmarteditcontainer/src/service/PersonalizationsmarteditRestService.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/personalization/personalizationsmartedit/apps/personalizationsmarteditcontainer/src/contextMenu/ContextMenuDeleteActionComponent.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/personalization/personalizationsmartedit/apps/personalizationsmarteditcontainer/src/contextMenu/PersonalizationsmarteditContextMenuAddEditActionComponent.ts"],"map":"{\"version\":3,\"file\":\"PersonalizationsmarteditContextMenuServiceOuterProxy.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/contextMenu/PersonalizationsmarteditContextMenuServiceOuterProxy.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/personalization/personalizationsmartedit/apps/personalizationsmarteditcontainer/node_modules/.cache/rollup-plugin-typescript2/placeholder/contextMenu/PersonalizationsmarteditContextMenuServiceOuterProxy.d.ts","writeByteOrderMark":false,"text":"import { TranslateService } from '@ngx-translate/core';\r\nimport { ContextMenuDto, IPersonalizationsmarteditContextMenuServiceProxy, PersonalizationsmarteditMessageHandler } from 'personalizationcommons';\r\nimport { PersonalizationsmarteditContextService } from 'personalizationsmarteditcontainer/service/PersonalizationsmarteditContextServiceOuter';\r\nimport { PersonalizationsmarteditRestService } from 'personalizationsmarteditcontainer/service/PersonalizationsmarteditRestService';\r\nimport { IEditorModalService, IModalService, IRenderService, LogService } from 'smarteditcommons';\r\nexport declare class PersonalizationsmarteditContextMenuServiceProxy extends IPersonalizationsmarteditContextMenuServiceProxy {\r\n    private modalService;\r\n    private renderService;\r\n    private editorModalService;\r\n    private personalizationsmarteditContextService;\r\n    private personalizationsmarteditRestService;\r\n    private personalizationsmarteditMessageHandler;\r\n    private translateService;\r\n    private logService;\r\n    constructor(modalService: IModalService, renderService: IRenderService, editorModalService: IEditorModalService, personalizationsmarteditContextService: PersonalizationsmarteditContextService, personalizationsmarteditRestService: PersonalizationsmarteditRestService, personalizationsmarteditMessageHandler: PersonalizationsmarteditMessageHandler, translateService: TranslateService, logService: LogService);\r\n    openDeleteAction(config: ContextMenuDto): Promise<void>;\r\n    openAddAction(config: ContextMenuDto): Promise<void>;\r\n    openEditAction(config: ContextMenuDto): Promise<void>;\r\n    openEditComponentAction(config: ContextMenuDto): void;\r\n    private deleteContext;\r\n    private removeItemFromCollection;\r\n    private addActionsToVariation;\r\n    private confirmDelete;\r\n}\r\n"}}
