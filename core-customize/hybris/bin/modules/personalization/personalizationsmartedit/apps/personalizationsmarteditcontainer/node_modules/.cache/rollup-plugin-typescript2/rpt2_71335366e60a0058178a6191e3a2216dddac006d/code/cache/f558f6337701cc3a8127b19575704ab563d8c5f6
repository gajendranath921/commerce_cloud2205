{"code":"import { __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { PersonalizationsmarteditUtils, PERSONALIZATION_MODEL_STATUS_CODES } from 'personalizationcommons';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { SeDowngradeService } from 'smarteditcommons';\r\nexport const defaultCustomization = {\r\n    name: '',\r\n    enabledStartDate: '',\r\n    enabledEndDate: '',\r\n    status: PERSONALIZATION_MODEL_STATUS_CODES.ENABLED,\r\n    statusBoolean: true,\r\n    variations: [],\r\n    catalog: '',\r\n    catalogVersion: '',\r\n    code: '',\r\n    rank: null\r\n};\r\nconst defaultCustomizationViewState = {\r\n    customization: defaultCustomization,\r\n    visibleVariations: []\r\n};\r\nlet /* @ngInject */ CustomizationViewService = class /* @ngInject */ CustomizationViewService {\r\n    constructor(persoUtils) {\r\n        this.persoUtils = persoUtils;\r\n        this.editVariationActionSubject = new BehaviorSubject(undefined);\r\n        this.stateSubject = new BehaviorSubject(defaultCustomizationViewState);\r\n    }\r\n    getState$() {\r\n        return this.stateSubject.asObservable();\r\n    }\r\n    getState() {\r\n        return this.stateSubject.getValue();\r\n    }\r\n    setState(state) {\r\n        this.stateSubject.next(state);\r\n    }\r\n    addVariation(variation) {\r\n        const customization = this.selectCustomization();\r\n        const variations = [...customization.variations, variation];\r\n        this.setVariations(variations);\r\n    }\r\n    setVariations(variations) {\r\n        const customization = this.selectCustomization();\r\n        customization.variations = variations.map((variation, idx) => {\r\n            variation.rank = idx;\r\n            return variation;\r\n        });\r\n        this.setState(this.prepareState(customization));\r\n    }\r\n    setCustomization(customization) {\r\n        this.setState(this.prepareState(customization));\r\n    }\r\n    getCustomization$() {\r\n        return this.getState$().pipe(map((state) => state.customization));\r\n    }\r\n    // Actions\r\n    editVariationAction(variation) {\r\n        this.editVariationActionSubject.next(variation);\r\n    }\r\n    editVariationAction$() {\r\n        return this.editVariationActionSubject.asObservable();\r\n    }\r\n    // Selectors\r\n    selectCustomization() {\r\n        return this.getState().customization;\r\n    }\r\n    selectVisibleVariations() {\r\n        return this.getState().visibleVariations;\r\n    }\r\n    selectVariationByCode(code) {\r\n        return this.getState().customization.variations.find((variation) => variation.code === code);\r\n    }\r\n    /** Calculate visible items */\r\n    prepareState(customization) {\r\n        return {\r\n            customization,\r\n            visibleVariations: this.persoUtils.getVisibleItems(customization.variations)\r\n        };\r\n    }\r\n};\r\n/* @ngInject */ CustomizationViewService = __decorate([\r\n    SeDowngradeService(),\r\n    __metadata(\"design:paramtypes\", [PersonalizationsmarteditUtils])\r\n], /* @ngInject */ CustomizationViewService);\r\nexport { /* @ngInject */ CustomizationViewService };\r\n//# sourceMappingURL=CustomizationViewService.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/personalization/personalizationsmartedit/apps/personalizationcommons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/rxjs@6.5.4/node_modules/rxjs/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/rxjs@6.5.4/node_modules/rxjs/operators/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"CustomizationViewService.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/management/manageCustomizationView/CustomizationViewService.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/personalization/personalizationsmartedit/apps/personalizationsmarteditcontainer/node_modules/.cache/rollup-plugin-typescript2/placeholder/management/manageCustomizationView/CustomizationViewService.d.ts","writeByteOrderMark":false,"text":"import { Customization, CustomizationVariation, PersonalizationsmarteditUtils } from 'personalizationcommons';\r\nimport { Observable } from 'rxjs';\r\ninterface CustomizationViewState {\r\n    customization: Customization;\r\n    /** Variations that are displayed in TargetGroupVariationList component. */\r\n    visibleVariations: CustomizationVariation[];\r\n}\r\nexport declare const defaultCustomization: Customization;\r\nexport declare class CustomizationViewService {\r\n    private persoUtils;\r\n    private editVariationActionSubject;\r\n    private stateSubject;\r\n    constructor(persoUtils: PersonalizationsmarteditUtils);\r\n    getState$(): Observable<CustomizationViewState>;\r\n    getState(): CustomizationViewState;\r\n    setState(state: CustomizationViewState): void;\r\n    addVariation(variation: CustomizationVariation): void;\r\n    setVariations(variations: CustomizationVariation[]): void;\r\n    setCustomization(customization: Customization): void;\r\n    getCustomization$(): Observable<Customization>;\r\n    editVariationAction(variation: CustomizationVariation): void;\r\n    editVariationAction$(): Observable<CustomizationVariation | undefined>;\r\n    selectCustomization(): Customization;\r\n    selectVisibleVariations(): CustomizationViewState['visibleVariations'];\r\n    selectVariationByCode(code: string): CustomizationVariation | undefined;\r\n    /** Calculate visible items */\r\n    private prepareState;\r\n}\r\nexport {};\r\n"}}
