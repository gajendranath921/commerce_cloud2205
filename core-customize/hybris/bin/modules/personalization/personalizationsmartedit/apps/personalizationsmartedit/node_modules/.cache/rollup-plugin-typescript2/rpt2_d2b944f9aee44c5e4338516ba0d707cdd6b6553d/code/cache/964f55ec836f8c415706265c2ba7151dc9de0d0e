{"code":"import { __decorate, __metadata, __param } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { Component, ElementRef, Inject, ChangeDetectionStrategy } from '@angular/core';\r\nimport { CONTAINER_SOURCE_ID_ATTR } from 'personalizationcommons';\r\nimport { AbstractDecorator, CATALOG_VERSION_UUID_ATTRIBUTE, CONTAINER_TYPE_ATTRIBUTE, CrossFrameEventService, ID_ATTRIBUTE, OVERLAY_COMPONENT_CLASS, SeDecorator, TYPE_ATTRIBUTE, YJQUERY_TOKEN } from 'smarteditcommons';\r\nimport { PersonalizationsmarteditContextService, PersonalizationsmarteditComponentHandlerService } from '../service';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"PersonalizationsmarteditComponentLightUpDecorator\", {\r\n    selector: 'personalizationsmartedit-component-light-up',\r\n    template: `<div><ng-content></ng-content></div>`,\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nlet /* @ngInject */ PersonalizationsmarteditComponentLightUpDecorator = class /* @ngInject */ PersonalizationsmarteditComponentLightUpDecorator extends AbstractDecorator {\r\n    constructor(personalizationsmarteditContextService, personalizationsmarteditComponentHandlerService, crossFrameEventService, element, yjQuery) {\r\n        super();\r\n        this.personalizationsmarteditContextService = personalizationsmarteditContextService;\r\n        this.personalizationsmarteditComponentHandlerService = personalizationsmarteditComponentHandlerService;\r\n        this.crossFrameEventService = crossFrameEventService;\r\n        this.CONTAINER_TYPE = 'CxCmsComponentContainer';\r\n        this.ACTION_ID_ATTR = 'data-smartedit-personalization-action-id';\r\n        this.$element = yjQuery(element.nativeElement);\r\n        this.PARENT_CONTAINER_SELECTOR = `[class~=\"${OVERLAY_COMPONENT_CLASS}\"][${CONTAINER_SOURCE_ID_ATTR}][${CONTAINER_TYPE_ATTRIBUTE}=\"${this.CONTAINER_TYPE}\"]`;\r\n        this.PARENT_CONTAINER_WITH_ACTION_SELECTOR = `[class~=\"${OVERLAY_COMPONENT_CLASS}\"][${CONTAINER_TYPE_ATTRIBUTE}=\"${this.CONTAINER_TYPE}\"][${this.ACTION_ID_ATTR}]`;\r\n        this.COMPONENT_SELECTOR = `[${ID_ATTRIBUTE}][${CATALOG_VERSION_UUID_ATTRIBUTE}][${TYPE_ATTRIBUTE}]`;\r\n    }\r\n    ngAfterViewInit() {\r\n        this.unRegisterCustomizeContextSynchronized = this.crossFrameEventService.subscribe('PERSONALIZATION_CUSTOMIZE_CONTEXT_SYNCHRONIZED', () => this.delayToggleCssClasses());\r\n        this.delayToggleCssClasses();\r\n    }\r\n    ngOnDestroy() {\r\n        this.unRegisterCustomizeContextSynchronized();\r\n    }\r\n    /**\r\n     * There is an issue that the DOM instance of $element has been created but it has not been appended to the DOM yet and hence it is not possible to access its parent element.\r\n     * By using timeout we ensure that the element has been already appended to DOM.\r\n     */\r\n    delayToggleCssClasses() {\r\n        setTimeout(() => {\r\n            this.toggleCssClasses();\r\n        }, 500);\r\n    }\r\n    toggleCssClasses() {\r\n        const component = this.$element.parent().closest(this.COMPONENT_SELECTOR); // personalizationsmartedit-combined-view-component-light-up\r\n        const container = component.closest(this.PARENT_CONTAINER_SELECTOR); // smartedit-element\r\n        const isVariationComponentSelected = this.isVariationComponentSelected(component);\r\n        // when Customization has been selected, a border displays on customized components\r\n        container.toggleClass('perso__component-decorator', isVariationComponentSelected);\r\n        // when Customization has been selected, checked icon is displayed in top left corner of the decorator\r\n        container.toggleClass('hyicon hyicon-checkedlg perso__component-decorator-icon', isVariationComponentSelected);\r\n        // when Customization is clicked in, a border displays on customized components\r\n        container.toggleClass('personalizationsmarteditComponentSelected', this.isComponentSelected());\r\n    }\r\n    isVariationComponentSelected(component) {\r\n        let isSelected = false;\r\n        const customize = this.personalizationsmarteditContextService.getCustomize();\r\n        if (customize.selectedCustomization && customize.selectedVariations) {\r\n            const container = component.closest(this.PARENT_CONTAINER_WITH_ACTION_SELECTOR);\r\n            isSelected = container.length > 0;\r\n        }\r\n        return isSelected;\r\n    }\r\n    isComponentSelected() {\r\n        if (!Array.isArray(this.personalizationsmarteditContextService.getCustomize().selectedVariations)) {\r\n            return false;\r\n        }\r\n        const containerId = this.personalizationsmarteditComponentHandlerService.getParentContainerIdForComponent(this.$element);\r\n        const selectedComponents = this.personalizationsmarteditContextService.getCustomize()\r\n            .selectedComponents;\r\n        return !!(selectedComponents === null || selectedComponents === void 0 ? void 0 : selectedComponents.includes(containerId));\r\n    }\r\n};\r\n/* @ngInject */ PersonalizationsmarteditComponentLightUpDecorator = __decorate([\r\n    SeDecorator(),\r\n    Component({\r\n        selector: 'personalizationsmartedit-component-light-up',\r\n        template: `<div><ng-content></ng-content></div>`,\r\n        changeDetection: ChangeDetectionStrategy.OnPush\r\n    }),\r\n    __param(4, Inject(YJQUERY_TOKEN)),\r\n    __metadata(\"design:paramtypes\", [PersonalizationsmarteditContextService,\r\n        PersonalizationsmarteditComponentHandlerService,\r\n        CrossFrameEventService,\r\n        ElementRef, Function])\r\n], /* @ngInject */ PersonalizationsmarteditComponentLightUpDecorator);\r\nexport { /* @ngInject */ PersonalizationsmarteditComponentLightUpDecorator };\r\n//# sourceMappingURL=ComponentLightUpDecorator.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/personalization/personalizationsmartedit/apps/personalizationcommons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/personalization/personalizationsmartedit/apps/personalizationsmartedit/src/service/index.ts"],"map":"{\"version\":3,\"file\":\"ComponentLightUpDecorator.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/componentLightUpDecorator/ComponentLightUpDecorator.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/personalization/personalizationsmartedit/apps/personalizationsmartedit/node_modules/.cache/rollup-plugin-typescript2/placeholder/componentLightUpDecorator/ComponentLightUpDecorator.d.ts","writeByteOrderMark":false,"text":"import { OnDestroy, ElementRef, AfterViewInit } from '@angular/core';\r\nimport { AbstractDecorator, CrossFrameEventService } from 'smarteditcommons';\r\nimport { PersonalizationsmarteditContextService, PersonalizationsmarteditComponentHandlerService } from '../service';\r\nexport declare class PersonalizationsmarteditComponentLightUpDecorator extends AbstractDecorator implements OnDestroy, AfterViewInit {\r\n    private personalizationsmarteditContextService;\r\n    private personalizationsmarteditComponentHandlerService;\r\n    private crossFrameEventService;\r\n    private $element;\r\n    private CONTAINER_TYPE;\r\n    private ACTION_ID_ATTR;\r\n    private PARENT_CONTAINER_SELECTOR;\r\n    private PARENT_CONTAINER_WITH_ACTION_SELECTOR;\r\n    private COMPONENT_SELECTOR;\r\n    /** Event when selecting a customization.  */\r\n    private unRegisterCustomizeContextSynchronized;\r\n    constructor(personalizationsmarteditContextService: PersonalizationsmarteditContextService, personalizationsmarteditComponentHandlerService: PersonalizationsmarteditComponentHandlerService, crossFrameEventService: CrossFrameEventService, element: ElementRef, yjQuery: JQueryStatic);\r\n    ngAfterViewInit(): void;\r\n    ngOnDestroy(): void;\r\n    /**\r\n     * There is an issue that the DOM instance of $element has been created but it has not been appended to the DOM yet and hence it is not possible to access its parent element.\r\n     * By using timeout we ensure that the element has been already appended to DOM.\r\n     */\r\n    private delayToggleCssClasses;\r\n    private toggleCssClasses;\r\n    private isVariationComponentSelected;\r\n    private isComponentSelected;\r\n}\r\n"}}
