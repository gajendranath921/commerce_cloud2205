{"code":"import { __awaiter, __decorate, __metadata, __param } from \"tslib\";\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\r\nimport { WORKFLOW_CREATED_EVENT } from 'cmscommons';\r\nimport { SeDowngradeComponent, SystemEventService, TOOLBAR_ITEM, WorkflowTasksPollingService, UserTrackingService, USER_TRACKING_FUNCTIONALITY } from 'smarteditcommons';\r\nimport { CMS_EVENT_OPEN_WORKFLOW_INBOX_DROPDOWN, WORKFLOW_TASKS_MENU_OPENED_EVENT } from '../../constants';\r\nimport { WorkflowFacade } from '../../services';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"WorkflowInboxComponent\", {\r\n    selector: 'se-workflow-inbox',\r\n    template: `<fd-popover class=\"toolbar-action se-workflow-inbox-container dropdown\" [class.open]=\"actionItem.isOpen\" [(isOpen)]=\"actionItem.isOpen\" (isOpenChange)=\"onDropdownToggle(isOpen)\" [closeOnOutsideClick]=\"true\" [triggers]=\"['click']\" [placement]=\"'bottom-' + actionItem.dropdownPosition\"><fd-popover-control class=\"se-workflow-inbox-toggle-control\"><button type=\"button\" class=\"se-workflow-inbox-toggle toolbar-action--button--compact\" [attr.aria-pressed]=\"actionItem.isOpen\"><span class=\"se-toolbar-actions__icon sap-icon--task\"></span><se-workflow-inbox-badge></se-workflow-inbox-badge></button></fd-popover-control><fd-popover-body><div [ngClass]=\"{\n                'se-toolbar__dropdown--right': actionItem.dropdownPosition === 'right',\n                'se-toolbar__dropdown--center': actionItem.dropdownPosition === 'center',\n                'se-toolbar__dropdown--left': actionItem.dropdownPosition === 'left'\n            }\" class=\"toolbar-action--include--compact\"><div *ngIf=\"actionItem.isOpen\" class=\"se-workflow-inbox\"><div class=\"se-workflow-inbox\"><div class=\"se-workflow-inbox-header\"><div class=\"se-workflow-inbox-header__title\" [translate]=\"'se.cms.workflow.toolbar.inbox'\"></div></div><div class=\"se-workflow-inbox-tasks se-cms-dev-workflow-inbox-tasks fd-panel__body\"><div *ngIf=\"!tasksNotReady && totalNumberOfTasks === 0\" class=\"se-workflow-inbox-tasks__no-tasks\"><img src=\"static-resources/images/Inbox.svg\" alt=\"empty-inbox\"/> <span class=\"se-workflow-inbox__empty-inbox-message\" [translate]=\"'se.cms.workflow.toolbar.inbox.emptyinbox.message'\"></span> <span class=\"se-workflow-inbox__empty-inbox-message-alt\" [translate]=\"'se.cms.workflow.toolbar.inbox.emptyinbox.message.alt'\"></span></div><se-infinite-scrolling class=\"se-version-panel__infinite-scroll se-infinite-scrolling--narrowed\" [pageSize]=\"pageSize\" [fetchPage]=\"fetchPageOfInboxTasks\" (itemsChange)=\"onInboxTasksLoaded($event)\"><div *ngFor=\"let task of workflowTasks; let i = index; let last = last; trackBy: trackByIndex\" class=\"se-workflow-inbox-task se-cms-dev-workflow-inbox-task\"><se-workflow-inbox-task id=\"workflow-inbox-task-{{i}}\" [class.se-workflow-inbox-task-last]=\"last\" [task]=\"task\"></se-workflow-inbox-task></div></se-infinite-scrolling></div></div></div></div></fd-popover-body></fd-popover>`,\r\n    styles: [`.se-workflow-inbox-toggle{outline:0}.se-workflow-inbox-header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px;padding-top:15px;height:48px;font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a;border-bottom:1px solid #d9d9d9;padding:10px 0 15px 20px;height:46px}.se-workflow-inbox-header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-workflow-inbox-tasks{padding:16px 0 8px;width:280px}.se-workflow-inbox-tasks__no-tasks{display:flex;flex-direction:column;align-items:center}.se-workflow-inbox__empty-inbox-message{color:#51555a;padding:8px 0 4px}.se-workflow-inbox__empty-inbox-message-alt{font-size:13px;color:#6a6d70;padding-bottom:30px}`],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nlet /* @ngInject */ WorkflowInboxComponent = class /* @ngInject */ WorkflowInboxComponent {\r\n    constructor(workflowFacade, systemEventService, workflowTasksPollingService, userTrackingService, actionItem, cdr) {\r\n        this.workflowFacade = workflowFacade;\r\n        this.systemEventService = systemEventService;\r\n        this.workflowTasksPollingService = workflowTasksPollingService;\r\n        this.userTrackingService = userTrackingService;\r\n        this.actionItem = actionItem;\r\n        this.cdr = cdr;\r\n        this.pageSize = 10;\r\n        this.workflowTasks = [];\r\n        this.fetchPageOfInboxTasks = (search, pageSize, currentPage) => this.loadInboxTasks(search, pageSize, currentPage);\r\n    }\r\n    ngOnInit() {\r\n        this.tasksNotReady = true;\r\n        this.unRegisterOpenDropdownEvent = this.systemEventService.subscribe(CMS_EVENT_OPEN_WORKFLOW_INBOX_DROPDOWN, () => this.openDropdown());\r\n        this.unRegisterWorkflowCreatedEvent = this.systemEventService.subscribe(WORKFLOW_CREATED_EVENT, () => this.loadInboxTasks('', this.pageSize, 0));\r\n        this.unRegWorkflowTasksMenuOpenedEvent = this.systemEventService.subscribe(WORKFLOW_TASKS_MENU_OPENED_EVENT, () => this.hideDropdown());\r\n        this.workflowTasksPollingService.startPolling();\r\n    }\r\n    ngOnDestroy() {\r\n        this.workflowTasksPollingService.stopPolling();\r\n        this.unRegisterOpenDropdownEvent();\r\n        this.unRegisterWorkflowCreatedEvent();\r\n        this.unRegWorkflowTasksMenuOpenedEvent();\r\n    }\r\n    loadInboxTasks(mask, pageSize, currentPage) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const page = yield this.workflowFacade.getWorkflowInboxTasks({\r\n                currentPage,\r\n                mask,\r\n                pageSize\r\n            });\r\n            this.tasksNotReady = false;\r\n            this.totalNumberOfTasks = page.pagination.totalCount;\r\n            this.workflowFacade.updateWorkflowTasksCount(this.totalNumberOfTasks);\r\n            if (!this.cdr.destroyed) {\r\n                this.cdr.detectChanges();\r\n            }\r\n            return page;\r\n        });\r\n    }\r\n    onInboxTasksLoaded(workflowTasks) {\r\n        this.workflowTasks = workflowTasks;\r\n    }\r\n    onDropdownToggle(isOpen) {\r\n        if (isOpen) {\r\n            this.workflowTasksPollingService.stopPolling();\r\n            return;\r\n        }\r\n        this.userTrackingService.trackingUserAction(USER_TRACKING_FUNCTIONALITY.HEADER_TOOL, 'Inbox');\r\n        this.workflowTasksPollingService.startPolling();\r\n        this.tasksNotReady = true;\r\n    }\r\n    trackByIndex(index) {\r\n        return index;\r\n    }\r\n    openDropdown() {\r\n        this.actionItem.isOpen = true;\r\n        if (!this.cdr.destroyed) {\r\n            this.cdr.detectChanges();\r\n        }\r\n    }\r\n    hideDropdown() {\r\n        this.actionItem.isOpen = false;\r\n        if (!this.cdr.destroyed) {\r\n            this.cdr.detectChanges();\r\n        }\r\n    }\r\n};\r\n/* @ngInject */ WorkflowInboxComponent = __decorate([\r\n    SeDowngradeComponent(),\r\n    Component({\r\n        selector: 'se-workflow-inbox',\r\n        template: `<fd-popover class=\"toolbar-action se-workflow-inbox-container dropdown\" [class.open]=\"actionItem.isOpen\" [(isOpen)]=\"actionItem.isOpen\" (isOpenChange)=\"onDropdownToggle(isOpen)\" [closeOnOutsideClick]=\"true\" [triggers]=\"['click']\" [placement]=\"'bottom-' + actionItem.dropdownPosition\"><fd-popover-control class=\"se-workflow-inbox-toggle-control\"><button type=\"button\" class=\"se-workflow-inbox-toggle toolbar-action--button--compact\" [attr.aria-pressed]=\"actionItem.isOpen\"><span class=\"se-toolbar-actions__icon sap-icon--task\"></span><se-workflow-inbox-badge></se-workflow-inbox-badge></button></fd-popover-control><fd-popover-body><div [ngClass]=\"{\n                'se-toolbar__dropdown--right': actionItem.dropdownPosition === 'right',\n                'se-toolbar__dropdown--center': actionItem.dropdownPosition === 'center',\n                'se-toolbar__dropdown--left': actionItem.dropdownPosition === 'left'\n            }\" class=\"toolbar-action--include--compact\"><div *ngIf=\"actionItem.isOpen\" class=\"se-workflow-inbox\"><div class=\"se-workflow-inbox\"><div class=\"se-workflow-inbox-header\"><div class=\"se-workflow-inbox-header__title\" [translate]=\"'se.cms.workflow.toolbar.inbox'\"></div></div><div class=\"se-workflow-inbox-tasks se-cms-dev-workflow-inbox-tasks fd-panel__body\"><div *ngIf=\"!tasksNotReady && totalNumberOfTasks === 0\" class=\"se-workflow-inbox-tasks__no-tasks\"><img src=\"static-resources/images/Inbox.svg\" alt=\"empty-inbox\"/> <span class=\"se-workflow-inbox__empty-inbox-message\" [translate]=\"'se.cms.workflow.toolbar.inbox.emptyinbox.message'\"></span> <span class=\"se-workflow-inbox__empty-inbox-message-alt\" [translate]=\"'se.cms.workflow.toolbar.inbox.emptyinbox.message.alt'\"></span></div><se-infinite-scrolling class=\"se-version-panel__infinite-scroll se-infinite-scrolling--narrowed\" [pageSize]=\"pageSize\" [fetchPage]=\"fetchPageOfInboxTasks\" (itemsChange)=\"onInboxTasksLoaded($event)\"><div *ngFor=\"let task of workflowTasks; let i = index; let last = last; trackBy: trackByIndex\" class=\"se-workflow-inbox-task se-cms-dev-workflow-inbox-task\"><se-workflow-inbox-task id=\"workflow-inbox-task-{{i}}\" [class.se-workflow-inbox-task-last]=\"last\" [task]=\"task\"></se-workflow-inbox-task></div></se-infinite-scrolling></div></div></div></div></fd-popover-body></fd-popover>`,\r\n        styles: [`.se-workflow-inbox-toggle{outline:0}.se-workflow-inbox-header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px;padding-top:15px;height:48px;font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a;border-bottom:1px solid #d9d9d9;padding:10px 0 15px 20px;height:46px}.se-workflow-inbox-header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-workflow-inbox-tasks{padding:16px 0 8px;width:280px}.se-workflow-inbox-tasks__no-tasks{display:flex;flex-direction:column;align-items:center}.se-workflow-inbox__empty-inbox-message{color:#51555a;padding:8px 0 4px}.se-workflow-inbox__empty-inbox-message-alt{font-size:13px;color:#6a6d70;padding-bottom:30px}`],\r\n        changeDetection: ChangeDetectionStrategy.OnPush\r\n    }),\r\n    __param(4, Inject(TOOLBAR_ITEM)),\r\n    __metadata(\"design:paramtypes\", [WorkflowFacade,\r\n        SystemEventService,\r\n        WorkflowTasksPollingService,\r\n        UserTrackingService, Object, ChangeDetectorRef])\r\n], /* @ngInject */ WorkflowInboxComponent);\r\nexport { /* @ngInject */ WorkflowInboxComponent };\r\n//# sourceMappingURL=WorkflowInboxComponent.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/workflow/constants.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/workflow/services/index.ts"],"map":"{\"version\":3,\"file\":\"WorkflowInboxComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/components/workflow/components/workflowInbox/WorkflowInboxComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/workflow/components/workflowInbox/WorkflowInboxComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef, OnDestroy, OnInit } from '@angular/core';\r\nimport { FetchPageStrategy, Page, SystemEventService, ToolbarItemInternal, WorkflowTasksPollingService, WorkflowTask, UserTrackingService } from 'smarteditcommons';\r\nimport { WorkflowFacade } from '../../services';\r\nexport declare class WorkflowInboxComponent implements OnInit, OnDestroy {\r\n    private workflowFacade;\r\n    private systemEventService;\r\n    private workflowTasksPollingService;\r\n    private userTrackingService;\r\n    actionItem: ToolbarItemInternal;\r\n    private cdr;\r\n    pageSize: number;\r\n    tasksNotReady: boolean;\r\n    totalNumberOfTasks: number;\r\n    workflowTasks: WorkflowTask[];\r\n    private unRegisterOpenDropdownEvent;\r\n    private unRegisterWorkflowCreatedEvent;\r\n    private unRegWorkflowTasksMenuOpenedEvent;\r\n    constructor(workflowFacade: WorkflowFacade, systemEventService: SystemEventService, workflowTasksPollingService: WorkflowTasksPollingService, userTrackingService: UserTrackingService, actionItem: ToolbarItemInternal, cdr: ChangeDetectorRef);\r\n    ngOnInit(): void;\r\n    ngOnDestroy(): void;\r\n    fetchPageOfInboxTasks: FetchPageStrategy<WorkflowTask>;\r\n    loadInboxTasks(mask: string, pageSize: number, currentPage: number): Promise<Page<WorkflowTask>>;\r\n    onInboxTasksLoaded(workflowTasks: WorkflowTask[]): void;\r\n    onDropdownToggle(isOpen: boolean): void;\r\n    trackByIndex(index: number): number;\r\n    private openDropdown;\r\n    private hideDropdown;\r\n}\r\n"}}
