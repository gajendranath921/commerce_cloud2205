{"code":"import { __awaiter, __decorate, __metadata, __param } from \"tslib\";\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\r\nimport { EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV } from 'cmscommons';\r\nimport { ManagePageService } from 'cmssmarteditcontainer/services/pages/ManagePageService';\r\nimport { CrossFrameEventService, DROPDOWN_MENU_ITEM_DATA, ICatalogService, SeDowngradeComponent, CmsitemsRestService, UserTrackingService, USER_TRACKING_FUNCTIONALITY, CMSITEMS_UPDATE_EVENT } from 'smarteditcommons';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"UpdatePageStatusComponent\", {\r\n    selector: 'se-update-page-status',\r\n    template: `<div *ngIf=\"showButton\"><a class=\"se-dropdown-item fd-menu__item\" (click)=\"onClickOnSync()\"><span [translate]=\"'se.cms.actionitem.page.sync'\"></span></a></div>`,\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nlet /* @ngInject */ UpdatePageStatusComponent = class /* @ngInject */ UpdatePageStatusComponent {\r\n    constructor(cdr, managePageService, cmsitemsRestService, catalogService, crossFrameEventService, userTrackingService, dropdownMenuData) {\r\n        this.cdr = cdr;\r\n        this.managePageService = managePageService;\r\n        this.cmsitemsRestService = cmsitemsRestService;\r\n        this.catalogService = catalogService;\r\n        this.crossFrameEventService = crossFrameEventService;\r\n        this.userTrackingService = userTrackingService;\r\n        this.dropdownMenuData = dropdownMenuData;\r\n        this.showButton = false;\r\n    }\r\n    ngOnInit() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.pageInfo = this.dropdownMenuData.selectedItem;\r\n            yield this.setButtonVisibility();\r\n        });\r\n    }\r\n    onClickOnSync() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.userTrackingService.trackingUserAction(USER_TRACKING_FUNCTIONALITY.PAGE_MANAGEMENT, 'Sync');\r\n            yield this.managePageService.trashPageInActiveCatalogVersion(this.pageInfo.uid);\r\n            this.crossFrameEventService.publish(CMSITEMS_UPDATE_EVENT);\r\n            this.crossFrameEventService.publish(EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV);\r\n        });\r\n    }\r\n    setButtonVisibility() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.showButton = yield this.doesPageExistInActiveCatalogVersion();\r\n            if (!this.cdr.destroyed) {\r\n                this.cdr.detectChanges();\r\n            }\r\n        });\r\n    }\r\n    doesPageExistInActiveCatalogVersion() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const uriContext = yield this.catalogService.retrieveUriContext();\r\n            const activeVersion = yield this.catalogService.getContentCatalogActiveVersion(uriContext);\r\n            const result = yield this.cmsitemsRestService.get({\r\n                pageSize: 1,\r\n                currentPage: 0,\r\n                typeCode: 'AbstractPage',\r\n                fields: 'BASIC',\r\n                itemSearchParams: `uid:${this.pageInfo.uid}`,\r\n                catalogId: uriContext.CONTEXT_CATALOG,\r\n                catalogVersion: activeVersion\r\n            });\r\n            return result.pagination.totalCount === 1;\r\n        });\r\n    }\r\n};\r\n/* @ngInject */ UpdatePageStatusComponent = __decorate([\r\n    SeDowngradeComponent(),\r\n    Component({\r\n        selector: 'se-update-page-status',\r\n        template: `<div *ngIf=\"showButton\"><a class=\"se-dropdown-item fd-menu__item\" (click)=\"onClickOnSync()\"><span [translate]=\"'se.cms.actionitem.page.sync'\"></span></a></div>`,\r\n        changeDetection: ChangeDetectionStrategy.OnPush\r\n    }),\r\n    __param(6, Inject(DROPDOWN_MENU_ITEM_DATA)),\r\n    __metadata(\"design:paramtypes\", [ChangeDetectorRef,\r\n        ManagePageService,\r\n        CmsitemsRestService,\r\n        ICatalogService,\r\n        CrossFrameEventService,\r\n        UserTrackingService, Object])\r\n], /* @ngInject */ UpdatePageStatusComponent);\r\nexport { /* @ngInject */ UpdatePageStatusComponent };\r\n//# sourceMappingURL=UpdatePageStatusComponent.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/pages/ManagePageService.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"UpdatePageStatusComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/components/pages/pageItems/updatePageStatus/UpdatePageStatusComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/pages/pageItems/updatePageStatus/UpdatePageStatusComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef, OnInit } from '@angular/core';\r\nimport { ManagePageService } from 'cmssmarteditcontainer/services/pages/ManagePageService';\r\nimport { CrossFrameEventService, ICatalogService, IDropdownMenuItemData, CmsitemsRestService, ICMSPage, UserTrackingService } from 'smarteditcommons';\r\nexport declare class UpdatePageStatusComponent implements OnInit {\r\n    private cdr;\r\n    private managePageService;\r\n    private cmsitemsRestService;\r\n    private catalogService;\r\n    private crossFrameEventService;\r\n    private userTrackingService;\r\n    private dropdownMenuData;\r\n    pageInfo: ICMSPage;\r\n    showButton: boolean;\r\n    constructor(cdr: ChangeDetectorRef, managePageService: ManagePageService, cmsitemsRestService: CmsitemsRestService, catalogService: ICatalogService, crossFrameEventService: CrossFrameEventService, userTrackingService: UserTrackingService, dropdownMenuData: IDropdownMenuItemData);\r\n    ngOnInit(): Promise<void>;\r\n    onClickOnSync(): Promise<void>;\r\n    private setButtonVisibility;\r\n    private doesPageExistInActiveCatalogVersion;\r\n}\r\n"}}
