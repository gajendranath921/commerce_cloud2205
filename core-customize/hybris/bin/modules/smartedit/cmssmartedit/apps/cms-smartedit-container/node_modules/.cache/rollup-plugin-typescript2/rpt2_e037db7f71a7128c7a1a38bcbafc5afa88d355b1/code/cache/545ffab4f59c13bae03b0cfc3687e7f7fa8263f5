{"code":"import { __awaiter, __decorate, __metadata, __param } from \"tslib\";\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\r\nimport { ManagePageService } from 'cmssmarteditcontainer/services/pages/ManagePageService';\r\nimport { CrossFrameEventService, EVENTS, EVENT_CONTENT_CATALOG_UPDATE, SeDowngradeComponent, SystemEventService, TOOLBAR_ITEM, IPageService, UserTrackingService, USER_TRACKING_FUNCTIONALITY } from 'smarteditcommons';\r\nimport { PageFacade } from '../../../facades';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"DeletePageToolbarItemComponent\", {\r\n    selector: 'se-delete-page-toolbar-item',\r\n    template: `<div class=\"toolbar-action\" *ngIf=\"isReady\" [attr.data-item-key]=\"toolbarItem.key\"><button type=\"button\" class=\"btn toolbar-action--button\" [disabled]=\"isDeletePageDisabled\" [ngClass]=\"{ 'toolbar-action__disabled' : isDeletePageDisabled }\" (click)=\"deletePage()\"><span class=\"icon-delete se-toolbar-menu-ddlb--button__icon\"></span><div class=\"toolbar-action-button__txt\" translate=\"se.cms.actionitem.page.trash\"></div></button><se-tooltip *ngIf=\"isDeletePageDisabled\" [appendTo]=\"'body'\" [isChevronVisible]=\"true\" [placement]=\"'bottom'\" [triggers]=\"['mouseenter', 'mouseleave']\" [additionalClasses]=\"['se-tooltip--stretched']\"><div se-tooltip-body><span [translate]=\"tooltipMessage\"></span></div></se-tooltip></div>`,\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nlet /* @ngInject */ DeletePageToolbarItemComponent = class /* @ngInject */ DeletePageToolbarItemComponent {\r\n    constructor(pageService, pageFacade, managePageService, systemEventService, crossFrameEventService, cdr, userTrackingService, toolbarItem) {\r\n        this.pageService = pageService;\r\n        this.pageFacade = pageFacade;\r\n        this.managePageService = managePageService;\r\n        this.systemEventService = systemEventService;\r\n        this.crossFrameEventService = crossFrameEventService;\r\n        this.cdr = cdr;\r\n        this.userTrackingService = userTrackingService;\r\n        this.toolbarItem = toolbarItem;\r\n    }\r\n    ngOnInit() {\r\n        this.unRegPageChange = this.crossFrameEventService.subscribe(EVENTS.PAGE_CHANGE, () => this.updateToolbar());\r\n        return this.updateToolbar();\r\n    }\r\n    ngOnDestroy() {\r\n        this.unRegPageChange();\r\n    }\r\n    get isDeletePageDisabled() {\r\n        return !this.isDeletePageEnabled;\r\n    }\r\n    deletePage() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.userTrackingService.trackingUserAction(USER_TRACKING_FUNCTIONALITY.TOOL_BAR, 'Delete Page');\r\n            const pageInfo = yield this.pageService.getCurrentPageInfo();\r\n            yield this.managePageService.softDeletePage(pageInfo, this.uriContext);\r\n            this.systemEventService.publishAsync(EVENT_CONTENT_CATALOG_UPDATE);\r\n        });\r\n    }\r\n    updateToolbar() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.markAsNotReady();\r\n            if (!this.cdr.destroyed) {\r\n                this.cdr.detectChanges();\r\n            }\r\n            const uriContext = yield this.pageFacade.retrievePageUriContext();\r\n            if (!uriContext) {\r\n                return;\r\n            }\r\n            this.uriContext = uriContext;\r\n            this.pageInfo = yield this.pageService.getCurrentPageInfo();\r\n            this.isDeletePageEnabled = yield this.managePageService.isPageTrashable(this.pageInfo, this.uriContext);\r\n            this.tooltipMessage = yield this.resolveTooltipMessage(this.isDeletePageEnabled, this.pageInfo, this.uriContext);\r\n            this.markAsReady();\r\n            if (!this.cdr.destroyed) {\r\n                this.cdr.detectChanges();\r\n            }\r\n        });\r\n    }\r\n    markAsNotReady() {\r\n        this.isReady = false;\r\n        this.isDeletePageEnabled = false;\r\n        this.tooltipMessage = null;\r\n    }\r\n    markAsReady() {\r\n        this.isReady = true;\r\n    }\r\n    resolveTooltipMessage(isDeleteEnabled, pageInfo, uriContext) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return yield (isDeleteEnabled\r\n                ? null\r\n                : this.managePageService.getDisabledTrashTooltipMessage(pageInfo, uriContext));\r\n        });\r\n    }\r\n};\r\n/* @ngInject */ DeletePageToolbarItemComponent = __decorate([\r\n    SeDowngradeComponent(),\r\n    Component({\r\n        selector: 'se-delete-page-toolbar-item',\r\n        template: `<div class=\"toolbar-action\" *ngIf=\"isReady\" [attr.data-item-key]=\"toolbarItem.key\"><button type=\"button\" class=\"btn toolbar-action--button\" [disabled]=\"isDeletePageDisabled\" [ngClass]=\"{ 'toolbar-action__disabled' : isDeletePageDisabled }\" (click)=\"deletePage()\"><span class=\"icon-delete se-toolbar-menu-ddlb--button__icon\"></span><div class=\"toolbar-action-button__txt\" translate=\"se.cms.actionitem.page.trash\"></div></button><se-tooltip *ngIf=\"isDeletePageDisabled\" [appendTo]=\"'body'\" [isChevronVisible]=\"true\" [placement]=\"'bottom'\" [triggers]=\"['mouseenter', 'mouseleave']\" [additionalClasses]=\"['se-tooltip--stretched']\"><div se-tooltip-body><span [translate]=\"tooltipMessage\"></span></div></se-tooltip></div>`,\r\n        changeDetection: ChangeDetectionStrategy.OnPush\r\n    }),\r\n    __param(7, Inject(TOOLBAR_ITEM)),\r\n    __metadata(\"design:paramtypes\", [IPageService,\r\n        PageFacade,\r\n        ManagePageService,\r\n        SystemEventService,\r\n        CrossFrameEventService,\r\n        ChangeDetectorRef,\r\n        UserTrackingService, Object])\r\n], /* @ngInject */ DeletePageToolbarItemComponent);\r\nexport { /* @ngInject */ DeletePageToolbarItemComponent };\r\n//# sourceMappingURL=DeletePageToolbarItemComponent.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/pages/ManagePageService.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/facades/index.ts"],"map":"{\"version\":3,\"file\":\"DeletePageToolbarItemComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/components/pages/deletePageMenu/DeletePageToolbarItemComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/pages/deletePageMenu/DeletePageToolbarItemComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef, OnDestroy, OnInit } from '@angular/core';\r\nimport { ManagePageService } from 'cmssmarteditcontainer/services/pages/ManagePageService';\r\nimport { CrossFrameEventService, IUriContext, Nullable, SystemEventService, ToolbarItemInternal, IPageService, ICMSPage, UserTrackingService } from 'smarteditcommons';\r\nimport { PageFacade } from '../../../facades';\r\nexport declare class DeletePageToolbarItemComponent implements OnInit, OnDestroy {\r\n    private pageService;\r\n    private pageFacade;\r\n    private managePageService;\r\n    private systemEventService;\r\n    private crossFrameEventService;\r\n    private cdr;\r\n    private userTrackingService;\r\n    toolbarItem: ToolbarItemInternal;\r\n    isReady: boolean;\r\n    isDeletePageEnabled: boolean;\r\n    tooltipMessage: Nullable<string>;\r\n    uriContext: IUriContext;\r\n    pageInfo: ICMSPage;\r\n    private unRegPageChange;\r\n    constructor(pageService: IPageService, pageFacade: PageFacade, managePageService: ManagePageService, systemEventService: SystemEventService, crossFrameEventService: CrossFrameEventService, cdr: ChangeDetectorRef, userTrackingService: UserTrackingService, toolbarItem: ToolbarItemInternal);\r\n    ngOnInit(): Promise<void>;\r\n    ngOnDestroy(): void;\r\n    get isDeletePageDisabled(): boolean;\r\n    deletePage(): Promise<void>;\r\n    private updateToolbar;\r\n    private markAsNotReady;\r\n    private markAsReady;\r\n    private resolveTooltipMessage;\r\n}\r\n"}}
