{"code":"import { __awaiter, __decorate, __metadata, __param } from \"tslib\";\r\nimport { Component, ViewEncapsulation, Inject } from '@angular/core';\r\nimport { ComponentService } from 'cmscommons';\r\nimport { SeDowngradeComponent, ISharedDataService, TAB_DATA, ComponentMenuService, UserTrackingService, USER_TRACKING_FUNCTIONALITY } from 'smarteditcommons';\r\nimport { ENABLE_CLONE_ON_DROP } from '../../../../services';\r\nimport { CatalogVersionItemComponent } from '../components';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"ComponentsTabComponent\", {\r\n    selector: 'se-components-tab',\r\n    template: `<div class=\"se-component-menu__tabs-header\"><div class=\"se-component-menu__tabs-header--upper\" *ngIf=\"hasMultipleContentCatalogs()\"><se-select id=\"se-components-tab-catalog-versions\" class=\"se-component-menu__select\" [(model)]=\"selectedCatalogVersionId\" (modelChange)=\"onCatalogVersionChange()\" [fetchStrategy]=\"catalogVersionsFetchStrategy\" [searchEnabled]=\"false\" [itemComponent]=\"itemComponent\"></se-select></div><div class=\"se-component-menu__tabs-header--lower\"><se-component-search (onChange)=\"onSearchTermChanged($event)\" [placeholderI18nKey]=\"'se.cms.componentmenu.search.placeholder'\" class=\"se-component-menu__tabs-search\"></se-component-search><fieldset class=\"fd-form__set\"><div class=\"fd-form__item fd-form__item--check se-component-menu__clone-on-drop\"><input type=\"checkbox\" class=\"fd-form__control se-component-menu__clone-check-box\" id=\"component-clone-checkbox\" name=\"clone-on-drop\" [(ngModel)]=\"cloneOnDrop\" (ngModelChange)=\"onComponentCloneOnDropChange($event)\"/> <label class=\"fd-form__label se-component-menu__clone-label\" for=\"component-clone-checkbox\" translate=\"se.cms.component.clone.on.drop.label\"></label></div></fieldset></div></div><div class=\"se-component-menu__result-container\" *ngIf=\"forceRecompile\"><se-infinite-scrolling *ngIf=\"isActive()\" class=\"se-component-menu__infinite-scroll\" [ngClass]=\"{'se-component-menu__infinite-scroll--short': hasMultipleContentCatalogs() }\" [pageSize]=\"10\" [mask]=\"searchTerm\" [fetchPage]=\"loadComponentItems\" [context]=\"componentsContext\"><div class=\"se-component-menu__result\" *ngIf=\"componentsContext.items.length\"><se-component-item class=\"se-component-menu__item-wrap\" *ngFor=\"let item of componentsContext.items; trackBy: trackById\" [componentInfo]=\"item\" [cloneOnDrop]=\"cloneOnDrop\"></se-component-item></div></se-infinite-scrolling></div>`,\r\n    styles: [`se-components-tab .se-component-menu__tabs-header{padding:0 20px 16px;border-bottom:1px solid #d9d9d9}se-components-tab .se-component-menu__tabs-header .fd-form__set{margin:0!important}se-components-tab .se-component-menu__tabs-header--upper{margin-bottom:12px}se-components-tab .se-component-menu__tabs-header--lower{display:flex;flex-direction:row;align-items:center}se-components-tab .se-component-menu__tabs-search{width:78%}se-components-tab .se-component-menu__clone-on-drop.fd-form__item{display:flex;flex-direction:row;align-items:center}se-components-tab .se-component-menu__clone-check-box.fd-form__control{margin:0 4px 0 16px}se-components-tab .se-component-menu__clone-label.fd-form__label{white-space:nowrap;color:#32363a}se-components-tab .se-component-menu__infinite-scroll .se-infinite-scrolling__container{max-height:300px}se-components-tab .se-component-menu__infinite-scroll--short .se-infinite-scrolling__container{max-height:250px}se-components-tab .se-component-menu__result{display:grid;grid-template-columns:repeat(2,1fr)}`],\r\n    encapsulation: ViewEncapsulation.None\r\n});\r\nlet /* @ngInject */ ComponentsTabComponent = class /* @ngInject */ ComponentsTabComponent {\r\n    constructor(tabData, componentMenuService, componentService, sharedDataService, userTrackingService) {\r\n        this.tabData = tabData;\r\n        this.componentMenuService = componentMenuService;\r\n        this.componentService = componentService;\r\n        this.sharedDataService = sharedDataService;\r\n        this.userTrackingService = userTrackingService;\r\n        this.loadComponentItems = (mask, pageSize, currentPage) => __awaiter(this, void 0, void 0, function* () {\r\n            if (!this.selectedCatalogVersion) {\r\n                return {\r\n                    results: []\r\n                };\r\n            }\r\n            const payload = {\r\n                catalogId: this.selectedCatalogVersion.catalogId,\r\n                catalogVersion: this.selectedCatalogVersion.catalogVersionId,\r\n                mask,\r\n                pageSize,\r\n                page: currentPage\r\n            };\r\n            const loadedPage = yield this.componentService.loadPagedComponentItemsByCatalogVersion(payload);\r\n            return Object.assign(Object.assign({}, loadedPage), { results: loadedPage.response });\r\n        });\r\n        this.catalogVersions = [];\r\n        this.catalogVersionsFetchStrategy = {\r\n            fetchAll: () => this.fetchCatalogVersions()\r\n        };\r\n        this.componentsContext = { items: [] };\r\n        this.forceRecompile = true;\r\n        this.itemComponent = CatalogVersionItemComponent;\r\n        this.selectedCatalogVersionId = null;\r\n        this.selectedCatalogVersion = null;\r\n        this.searchTerm = '';\r\n    }\r\n    ngOnInit() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.cloneOnDrop = !!(yield this.sharedDataService.get(ENABLE_CLONE_ON_DROP));\r\n            yield this.fetchCatalogVersions();\r\n            if (!this.hasMultipleContentCatalogs()) {\r\n                this.onCatalogVersionChange();\r\n            }\r\n        });\r\n    }\r\n    isActive() {\r\n        return this.tabData.tab.active;\r\n    }\r\n    hasMultipleContentCatalogs() {\r\n        return this.tabData.model.componentsTab.hasMultipleContentCatalogs;\r\n    }\r\n    trackById(item) {\r\n        return item.id;\r\n    }\r\n    onCatalogVersionChange() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (this.selectedCatalogVersionId) {\r\n                this.selectedCatalogVersion = this.catalogVersions.find((catalogVersion) => catalogVersion.id === this.selectedCatalogVersionId);\r\n                yield this.componentMenuService.persistCatalogVersion(this.selectedCatalogVersionId);\r\n                this.forceRecompile = false;\r\n                setTimeout(() => {\r\n                    this.forceRecompile = true;\r\n                });\r\n            }\r\n        });\r\n    }\r\n    onSearchTermChanged(searchTerm) {\r\n        this.searchTerm = searchTerm;\r\n    }\r\n    onComponentCloneOnDropChange() {\r\n        this.userTrackingService.trackingUserAction(USER_TRACKING_FUNCTIONALITY.ADD_COMPONENT, 'Clone on Drop');\r\n        this.sharedDataService.set(ENABLE_CLONE_ON_DROP, this.cloneOnDrop);\r\n    }\r\n    fetchCatalogVersions() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const catalogVersions = yield this.componentMenuService.getValidContentCatalogVersions();\r\n            this.catalogVersions = catalogVersions;\r\n            const selectedCatalogVersion = yield this.componentMenuService.getInitialCatalogVersion(this.catalogVersions);\r\n            this.selectedCatalogVersion = selectedCatalogVersion;\r\n            this.selectedCatalogVersionId = this.selectedCatalogVersion\r\n                ? this.selectedCatalogVersion.id\r\n                : undefined;\r\n            return this.catalogVersions;\r\n        });\r\n    }\r\n};\r\n/* @ngInject */ ComponentsTabComponent = __decorate([\r\n    SeDowngradeComponent(),\r\n    Component({\r\n        selector: 'se-components-tab',\r\n        template: `<div class=\"se-component-menu__tabs-header\"><div class=\"se-component-menu__tabs-header--upper\" *ngIf=\"hasMultipleContentCatalogs()\"><se-select id=\"se-components-tab-catalog-versions\" class=\"se-component-menu__select\" [(model)]=\"selectedCatalogVersionId\" (modelChange)=\"onCatalogVersionChange()\" [fetchStrategy]=\"catalogVersionsFetchStrategy\" [searchEnabled]=\"false\" [itemComponent]=\"itemComponent\"></se-select></div><div class=\"se-component-menu__tabs-header--lower\"><se-component-search (onChange)=\"onSearchTermChanged($event)\" [placeholderI18nKey]=\"'se.cms.componentmenu.search.placeholder'\" class=\"se-component-menu__tabs-search\"></se-component-search><fieldset class=\"fd-form__set\"><div class=\"fd-form__item fd-form__item--check se-component-menu__clone-on-drop\"><input type=\"checkbox\" class=\"fd-form__control se-component-menu__clone-check-box\" id=\"component-clone-checkbox\" name=\"clone-on-drop\" [(ngModel)]=\"cloneOnDrop\" (ngModelChange)=\"onComponentCloneOnDropChange($event)\"/> <label class=\"fd-form__label se-component-menu__clone-label\" for=\"component-clone-checkbox\" translate=\"se.cms.component.clone.on.drop.label\"></label></div></fieldset></div></div><div class=\"se-component-menu__result-container\" *ngIf=\"forceRecompile\"><se-infinite-scrolling *ngIf=\"isActive()\" class=\"se-component-menu__infinite-scroll\" [ngClass]=\"{'se-component-menu__infinite-scroll--short': hasMultipleContentCatalogs() }\" [pageSize]=\"10\" [mask]=\"searchTerm\" [fetchPage]=\"loadComponentItems\" [context]=\"componentsContext\"><div class=\"se-component-menu__result\" *ngIf=\"componentsContext.items.length\"><se-component-item class=\"se-component-menu__item-wrap\" *ngFor=\"let item of componentsContext.items; trackBy: trackById\" [componentInfo]=\"item\" [cloneOnDrop]=\"cloneOnDrop\"></se-component-item></div></se-infinite-scrolling></div>`,\r\n        styles: [`se-components-tab .se-component-menu__tabs-header{padding:0 20px 16px;border-bottom:1px solid #d9d9d9}se-components-tab .se-component-menu__tabs-header .fd-form__set{margin:0!important}se-components-tab .se-component-menu__tabs-header--upper{margin-bottom:12px}se-components-tab .se-component-menu__tabs-header--lower{display:flex;flex-direction:row;align-items:center}se-components-tab .se-component-menu__tabs-search{width:78%}se-components-tab .se-component-menu__clone-on-drop.fd-form__item{display:flex;flex-direction:row;align-items:center}se-components-tab .se-component-menu__clone-check-box.fd-form__control{margin:0 4px 0 16px}se-components-tab .se-component-menu__clone-label.fd-form__label{white-space:nowrap;color:#32363a}se-components-tab .se-component-menu__infinite-scroll .se-infinite-scrolling__container{max-height:300px}se-components-tab .se-component-menu__infinite-scroll--short .se-infinite-scrolling__container{max-height:250px}se-components-tab .se-component-menu__result{display:grid;grid-template-columns:repeat(2,1fr)}`],\r\n        encapsulation: ViewEncapsulation.None\r\n    }),\r\n    __param(0, Inject(TAB_DATA)),\r\n    __metadata(\"design:paramtypes\", [Object, ComponentMenuService,\r\n        ComponentService,\r\n        ISharedDataService,\r\n        UserTrackingService])\r\n], /* @ngInject */ ComponentsTabComponent);\r\nexport { /* @ngInject */ ComponentsTabComponent };\r\n//# sourceMappingURL=ComponentsTabComponent.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/index.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/cmsComponents/componentMenu/components/index.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/cmsComponents/componentMenu/types.ts"],"map":"{\"version\":3,\"file\":\"ComponentsTabComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/components/cmsComponents/componentMenu/tabs/ComponentsTabComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/cmsComponents/componentMenu/tabs/ComponentsTabComponent.d.ts","writeByteOrderMark":false,"text":"import { OnInit, Type } from '@angular/core';\r\nimport { ComponentService } from 'cmscommons';\r\nimport { ISharedDataService, FetchStrategy, Page, TabData, CMSItem, ComponentMenuService, CatalogVersion, UserTrackingService } from 'smarteditcommons';\r\nimport { CatalogVersionItemComponent } from '../components';\r\nimport { ComponentMenuTabModel } from '../types';\r\nexport declare class ComponentsTabComponent implements OnInit {\r\n    private tabData;\r\n    private componentMenuService;\r\n    private componentService;\r\n    private sharedDataService;\r\n    private userTrackingService;\r\n    catalogVersions: CatalogVersion[];\r\n    catalogVersionsFetchStrategy: FetchStrategy<CatalogVersion>;\r\n    cloneOnDrop: boolean;\r\n    componentsContext: {\r\n        items: CMSItem[];\r\n    };\r\n    forceRecompile: boolean;\r\n    itemComponent: Type<CatalogVersionItemComponent>;\r\n    searchTerm: string;\r\n    selectedCatalogVersionId: string;\r\n    selectedCatalogVersion: CatalogVersion;\r\n    constructor(tabData: TabData<ComponentMenuTabModel>, componentMenuService: ComponentMenuService, componentService: ComponentService, sharedDataService: ISharedDataService, userTrackingService: UserTrackingService);\r\n    ngOnInit(): Promise<void>;\r\n    isActive(): boolean;\r\n    hasMultipleContentCatalogs(): boolean;\r\n    trackById(item: CatalogVersion): string;\r\n    onCatalogVersionChange(): Promise<void>;\r\n    onSearchTermChanged(searchTerm: string): void;\r\n    loadComponentItems: (mask: string, pageSize: number, currentPage: number) => Promise<Page<CMSItem>>;\r\n    onComponentCloneOnDropChange(): void;\r\n    private fetchCatalogVersions;\r\n}\r\n"}}
