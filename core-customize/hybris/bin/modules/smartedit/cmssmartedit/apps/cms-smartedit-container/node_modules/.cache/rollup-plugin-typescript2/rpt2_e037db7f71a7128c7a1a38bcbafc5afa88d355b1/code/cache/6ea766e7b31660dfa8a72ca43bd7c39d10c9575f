{"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Input } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { take } from 'rxjs/operators';\r\nimport { ICatalogService, ISharedDataService, L10nPipe, SeDowngradeComponent, EXPERIENCE_STORAGE_KEY, CmsitemsRestService } from 'smarteditcommons';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"PageSynchronizationHeaderComponent\", {\r\n    selector: 'se-page-synchronization-header',\r\n    template: `<ng-container *ngIf=\"ready\"><div class=\"se-sync-panel-header\"><span class=\"se-sync-panel-header__sub-header\" [translate]=\"getSubHeaderText()\"></span></div><div *ngIf=\"isNewPage()\" class=\"se-sync-panel-new-page\"><div class=\"se-sync-panel-new-page__header\" translate=\"se.cms.synchronization.page.new.header\"></div><div class=\"se-sync-panel-new-page__message\">{{ headerText }}</div></div><div class=\"se-sync-panel-header__timestamp\" *ngIf=\"!isNewPage()\"><div translate=\"se.cms.synchronization.panel.lastsync.text\"></div><span class=\"se-sync-panel-header__timestamp-text\">{{ syncStatus.lastSyncStatus | date: 'M/d/yy h:mm a' }}</span></div></ng-container>`,\r\n    styles: [`.se-sync-panel-header{padding:0 20px 20px;border-bottom:1px solid #d9d9d9;min-width:400px}.se-sync-panel-header__sub-header{padding-top:4px;color:#51555a}.se-sync-panel-header__timestamp{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a;position:absolute;left:20px;bottom:23px;width:150px}.se-sync-panel-new-page{padding:20px}.se-sync-panel-new-page__header{font-weight:700;padding-bottom:4px}.se-sync-panel-new-page__message{white-space:normal}`],\r\n    providers: [L10nPipe],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nlet /* @ngInject */ PageSynchronizationHeaderComponent = class /* @ngInject */ PageSynchronizationHeaderComponent {\r\n    constructor(sharedDataService, catalogService, cmsitemsRestService, translateService, l10nPipe, cdr) {\r\n        this.sharedDataService = sharedDataService;\r\n        this.catalogService = catalogService;\r\n        this.cmsitemsRestService = cmsitemsRestService;\r\n        this.translateService = translateService;\r\n        this.l10nPipe = l10nPipe;\r\n        this.cdr = cdr;\r\n        this.ready = false;\r\n    }\r\n    ngOnChanges() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this.syncStatus) {\r\n                return;\r\n            }\r\n            this.ready = false;\r\n            yield this.updateHeaderText();\r\n            this.ready = true;\r\n            if (!this.cdr.destroyed) {\r\n                this.cdr.detectChanges();\r\n            }\r\n        });\r\n    }\r\n    getSubHeaderText() {\r\n        if (this.isDefaultSubHeader()) {\r\n            return 'se.cms.synchronization.page.header';\r\n        }\r\n        else if (this.isSyncOldHomeHeader()) {\r\n            return 'se.cms.synchronization.page.header.old.homepage';\r\n        }\r\n    }\r\n    isNewPage() {\r\n        return this.pageSyncConditions.pageHasNoDepOrNoSyncStatus;\r\n    }\r\n    isSyncOldHomeHeader() {\r\n        return (this.pageSyncConditions.pageHasSyncStatus && !this.pageSyncConditions.canSyncHomepage);\r\n    }\r\n    isDefaultSubHeader() {\r\n        return !this.isSyncOldHomeHeader() && !this.isNewPage();\r\n    }\r\n    updateHeaderText() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const experience = (yield this.sharedDataService.get(EXPERIENCE_STORAGE_KEY));\r\n            const { catalogId, catalogName } = yield this.getCurrentCatalogIdFromExperience(experience);\r\n            const catalogVersion = yield this.catalogService.getActiveContentCatalogVersionByCatalogId(catalogId);\r\n            const itemNames = yield (this.pageSyncConditions.pageHasUnavailableDependencies\r\n                ? this.fetchUnavailableDependencies()\r\n                : null);\r\n            this.headerText = this.pageSyncConditions.pageHasUnavailableDependencies\r\n                ? this.translateService.instant('se.cms.synchronization.page.unavailable.items.description', {\r\n                    itemNames,\r\n                    catalogName,\r\n                    catalogVersion\r\n                })\r\n                : this.translateService.instant('se.cms.synchronization.page.new.description', {\r\n                    catalogName,\r\n                    catalogVersion\r\n                });\r\n        });\r\n    }\r\n    userIsInsidePage(pageContext) {\r\n        return !!pageContext;\r\n    }\r\n    getCurrentCatalogIdFromExperience({ pageContext, catalogDescriptor }) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const catalogId = this.userIsInsidePage(pageContext)\r\n                ? pageContext.catalogId\r\n                : catalogDescriptor.catalogId;\r\n            const catalogName = this.userIsInsidePage(pageContext)\r\n                ? pageContext.catalogName\r\n                : catalogDescriptor.name;\r\n            const catalogNameTranslated = yield this.l10nPipe\r\n                .transform(catalogName)\r\n                .pipe(take(1))\r\n                .toPromise();\r\n            return {\r\n                catalogId,\r\n                catalogName: catalogNameTranslated\r\n            };\r\n        });\r\n    }\r\n    fetchUnavailableDependencies() {\r\n        const itemIds = this.syncStatus.unavailableDependencies.map(({ itemId }) => itemId);\r\n        return this.cmsitemsRestService\r\n            .getByIds(itemIds)\r\n            .then(({ response }) => response.map(({ name }) => name).join(', '));\r\n    }\r\n};\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", Object)\r\n], /* @ngInject */ PageSynchronizationHeaderComponent.prototype, \"syncStatus\", void 0);\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", Object)\r\n], /* @ngInject */ PageSynchronizationHeaderComponent.prototype, \"pageSyncConditions\", void 0);\r\n/* @ngInject */ PageSynchronizationHeaderComponent = __decorate([\r\n    SeDowngradeComponent(),\r\n    Component({\r\n        selector: 'se-page-synchronization-header',\r\n        template: `<ng-container *ngIf=\"ready\"><div class=\"se-sync-panel-header\"><span class=\"se-sync-panel-header__sub-header\" [translate]=\"getSubHeaderText()\"></span></div><div *ngIf=\"isNewPage()\" class=\"se-sync-panel-new-page\"><div class=\"se-sync-panel-new-page__header\" translate=\"se.cms.synchronization.page.new.header\"></div><div class=\"se-sync-panel-new-page__message\">{{ headerText }}</div></div><div class=\"se-sync-panel-header__timestamp\" *ngIf=\"!isNewPage()\"><div translate=\"se.cms.synchronization.panel.lastsync.text\"></div><span class=\"se-sync-panel-header__timestamp-text\">{{ syncStatus.lastSyncStatus | date: 'M/d/yy h:mm a' }}</span></div></ng-container>`,\r\n        styles: [`.se-sync-panel-header{padding:0 20px 20px;border-bottom:1px solid #d9d9d9;min-width:400px}.se-sync-panel-header__sub-header{padding-top:4px;color:#51555a}.se-sync-panel-header__timestamp{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a;position:absolute;left:20px;bottom:23px;width:150px}.se-sync-panel-new-page{padding:20px}.se-sync-panel-new-page__header{font-weight:700;padding-bottom:4px}.se-sync-panel-new-page__message{white-space:normal}`],\r\n        providers: [L10nPipe],\r\n        changeDetection: ChangeDetectionStrategy.OnPush\r\n    }),\r\n    __metadata(\"design:paramtypes\", [ISharedDataService,\r\n        ICatalogService,\r\n        CmsitemsRestService,\r\n        TranslateService,\r\n        L10nPipe,\r\n        ChangeDetectorRef])\r\n], /* @ngInject */ PageSynchronizationHeaderComponent);\r\nexport { /* @ngInject */ PageSynchronizationHeaderComponent };\r\n//# sourceMappingURL=PageSynchronizationHeaderComponent.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@ngx-translate+core@11.0.1_@angular+core@8.2.14+rxjs@6.5.4/node_modules/@ngx-translate/core/ngx-translate-core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/rxjs@6.5.4/node_modules/rxjs/operators/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/synchronize/types.ts"],"map":"{\"version\":3,\"file\":\"PageSynchronizationHeaderComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/components/synchronize/components/pageSynchronizationHeader/PageSynchronizationHeaderComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/synchronize/components/pageSynchronizationHeader/PageSynchronizationHeaderComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef, OnChanges } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { ISyncStatus } from 'cmscommons';\r\nimport { ICatalogService, ISharedDataService, L10nPipe, CmsitemsRestService } from 'smarteditcommons';\r\nimport { PageSyncConditions } from '../../types';\r\nexport declare class PageSynchronizationHeaderComponent implements OnChanges {\r\n    private sharedDataService;\r\n    private catalogService;\r\n    private cmsitemsRestService;\r\n    private translateService;\r\n    private l10nPipe;\r\n    private cdr;\r\n    syncStatus: ISyncStatus;\r\n    pageSyncConditions: PageSyncConditions;\r\n    ready: boolean;\r\n    headerText: string;\r\n    constructor(sharedDataService: ISharedDataService, catalogService: ICatalogService, cmsitemsRestService: CmsitemsRestService, translateService: TranslateService, l10nPipe: L10nPipe, cdr: ChangeDetectorRef);\r\n    ngOnChanges(): Promise<void>;\r\n    getSubHeaderText(): string;\r\n    isNewPage(): boolean;\r\n    isSyncOldHomeHeader(): boolean;\r\n    isDefaultSubHeader(): boolean;\r\n    private updateHeaderText;\r\n    private userIsInsidePage;\r\n    private getCurrentCatalogIdFromExperience;\r\n    private fetchUnavailableDependencies;\r\n}\r\n"}}
