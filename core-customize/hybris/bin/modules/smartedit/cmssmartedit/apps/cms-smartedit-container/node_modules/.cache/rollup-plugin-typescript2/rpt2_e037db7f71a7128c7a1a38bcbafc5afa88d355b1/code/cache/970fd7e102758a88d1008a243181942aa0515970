{"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { IContextAwareEditableItemService } from 'cmscommons';\r\nimport { GatewayProxied, SeDowngradeService, IPageService, WorkflowService } from 'smarteditcommons';\r\nlet /* @ngInject */ ContextAwareEditableItemService = class /* @ngInject */ ContextAwareEditableItemService extends IContextAwareEditableItemService {\r\n    constructor(workflowService, pageService) {\r\n        super();\r\n        this.workflowService = workflowService;\r\n        this.pageService = pageService;\r\n    }\r\n    isItemEditable(itemUid) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const workflowEditableItems = yield this.workflowService.getWorkflowEditableItems([\r\n                itemUid\r\n            ]);\r\n            const item = workflowEditableItems.find((data) => data.uid === itemUid);\r\n            if (item.editableInWorkflow) {\r\n                const editable = yield this.editableInCurrentPageContext(item.editableInWorkflow);\r\n                return item.editableByUser && editable;\r\n            }\r\n            return item.editableByUser;\r\n        });\r\n    }\r\n    /**\r\n     * Verifies whether the item's active workflow equals to the workflow of page currently in preview.\r\n     */\r\n    editableInCurrentPageContext(editableInWorkflow) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            try {\r\n                const pageInfo = yield this.pageService.getCurrentPageInfo();\r\n                const activeWorkflow = yield this.workflowService.getActiveWorkflowForPageUuid(pageInfo.uid);\r\n                return activeWorkflow !== null && activeWorkflow.workflowCode === editableInWorkflow;\r\n            }\r\n            catch (_a) {\r\n                return true;\r\n            }\r\n        });\r\n    }\r\n};\r\n/* @ngInject */ ContextAwareEditableItemService = __decorate([\r\n    SeDowngradeService(IContextAwareEditableItemService),\r\n    GatewayProxied(),\r\n    __metadata(\"design:paramtypes\", [WorkflowService, IPageService])\r\n], /* @ngInject */ ContextAwareEditableItemService);\r\nexport { /* @ngInject */ ContextAwareEditableItemService };\r\n//# sourceMappingURL=ContextAwareEditableItemServiceOuter.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"ContextAwareEditableItemServiceOuter.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/services/contextAwareEditableItem/ContextAwareEditableItemServiceOuter.ts\"],\"names\":[],\"mappings\":\";AAAA;;GAEG;AACH,OAAO,EAAE,gCAAgC,EAAE,MAAM,YAAY,CAAC;AAC9D,OAAO,EACH,cAAc,EACd,kBAAkB,EAClB,YAAY,EACZ,eAAe,EAClB,MAAM,kBAAkB,CAAC;AAI1B,sDAAA,qDAA6C,SAAQ,gCAAgC;IACjF,YAAoB,eAAgC,EAAU,WAAyB;QACnF,KAAK,EAAE,CAAC;QADQ,oBAAe,GAAf,eAAe,CAAiB;QAAU,gBAAW,GAAX,WAAW,CAAc;IAEvF,CAAC;IAEY,cAAc,CAAC,OAAe;;YACvC,MAAM,qBAAqB,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,wBAAwB,CAAC;gBAC9E,OAAO;aACV,CAAC,CAAC;YACH,MAAM,IAAI,GAAG,qBAAqB,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,KAAK,OAAO,CAAC,CAAC;YAExE,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBACzB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,4BAA4B,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;gBAClF,OAAO,IAAI,CAAC,cAAc,IAAI,QAAQ,CAAC;aAC1C;YAED,OAAO,IAAI,CAAC,cAAc,CAAC;QAC/B,CAAC;KAAA;IAED;;OAEG;IACW,4BAA4B,CAAC,kBAA0B;;YACjE,IAAI;gBACA,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE,CAAC;gBAC7D,MAAM,cAAc,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,4BAA4B,CAC1E,QAAQ,CAAC,GAAG,CACf,CAAC;gBACF,OAAO,cAAc,KAAK,IAAI,IAAI,cAAc,CAAC,YAAY,KAAK,kBAAkB,CAAC;aACxF;YAAC,WAAM;gBACJ,OAAO,IAAI,CAAC;aACf;QACL,CAAC;KAAA;CACJ,CAAA;AAjCD;IAFC,kBAAkB,CAAC,gCAAgC,CAAC;IACpD,cAAc,EAAE;qCAEwB,eAAe,EAAuB,YAAY;mDAgC1F\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/services/contextAwareEditableItem/ContextAwareEditableItemServiceOuter.d.ts","writeByteOrderMark":false,"text":"import { IContextAwareEditableItemService } from 'cmscommons';\r\nimport { IPageService, WorkflowService } from 'smarteditcommons';\r\nexport declare class ContextAwareEditableItemService extends IContextAwareEditableItemService {\r\n    private workflowService;\r\n    private pageService;\r\n    constructor(workflowService: WorkflowService, pageService: IPageService);\r\n    isItemEditable(itemUid: string): Promise<boolean>;\r\n    /**\r\n     * Verifies whether the item's active workflow equals to the workflow of page currently in preview.\r\n     */\r\n    private editableInCurrentPageContext;\r\n}\r\n"}}
