{"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\n/* eslint-disable max-classes-per-file */\r\nimport { ICatalogService, SeDowngradeService, CmsitemsRestService } from 'smarteditcommons';\r\nexport class RestrictionManagementSelectModel {\r\n    constructor(cmsitemsRestService, catalogService, fetchRestrictionTypes, getSupportedRestrictionTypes) {\r\n        this.cmsitemsRestService = cmsitemsRestService;\r\n        this.catalogService = catalogService;\r\n        this.fetchRestrictionTypes = fetchRestrictionTypes;\r\n        this.getSupportedRestrictionTypes = getSupportedRestrictionTypes;\r\n        this.selectedIds = {};\r\n        this.model = {\r\n            restrictionTypes: [],\r\n            selectedRestrictionType: null\r\n        };\r\n        this.restrictions = [];\r\n        this.supportedRestrictionTypes = [];\r\n    }\r\n    initialize() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const restrictionTypesResponse = yield this.fetchRestrictionTypes();\r\n            this.model.restrictionTypes = restrictionTypesResponse.map((type, index) => (Object.assign(Object.assign({}, type), { id: index })));\r\n            if (typeof this.getSupportedRestrictionTypes === 'function') {\r\n                this.supportedRestrictionTypes = yield this.getSupportedRestrictionTypes();\r\n            }\r\n            else {\r\n                this.supportedRestrictionTypes = this.model.restrictionTypes.map((type) => type.code);\r\n            }\r\n        });\r\n    }\r\n    getRestrictionsPaged(mask, pageSize, currentPage) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const requestParams = {\r\n                pageSize,\r\n                currentPage,\r\n                typeCode: this.model.selectedRestrictionType.code,\r\n                mask,\r\n                itemSearchParams: ''\r\n            };\r\n            if (currentPage === 0) {\r\n                this.restrictions = [];\r\n            }\r\n            const restrictionsResponse = yield this.cmsitemsRestService.get(requestParams);\r\n            const restrictionResult = restrictionsResponse.response.map((restriction) => (Object.assign(Object.assign({}, restriction), { id: restriction.uid })));\r\n            this.restrictions = this.restrictions.concat(restrictionResult);\r\n            return {\r\n                pagination: restrictionsResponse.pagination,\r\n                results: restrictionResult\r\n            };\r\n        });\r\n    }\r\n    getRestrictionFromBackend() {\r\n        return Promise.resolve({});\r\n    }\r\n    getRestrictionTypes() {\r\n        return Promise.resolve(this.model.restrictionTypes);\r\n    }\r\n    restrictionSelected() {\r\n        if (this.selectedIds.restriction) {\r\n            this.selectedRestriction = this.restrictions.find((restriction) => restriction.id === this.selectedIds.restriction);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    restrictionTypeSelected() {\r\n        this.selectedIds.restriction = null;\r\n        this.model.selectedRestrictionType =\r\n            (this.model.restrictionTypes || []).find((restrictionType) => restrictionType.id === this.selectedIds.restrictionType) || null;\r\n        if (this.model.selectedRestrictionType) {\r\n            this.selectedRestriction = {\r\n                typeCode: this.model.selectedRestrictionType.code\r\n            };\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    createRestrictionSelected(name, uriContext) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.selectedRestriction = {\r\n                itemtype: this.model.selectedRestrictionType.code,\r\n                name\r\n            };\r\n            const catalogVersionUuid = yield this.catalogService.getCatalogVersionUUid(uriContext);\r\n            this.selectedRestriction.catalogVersion = catalogVersionUuid;\r\n        });\r\n    }\r\n    getRestrictionTypeCode() {\r\n        var _a;\r\n        return (_a = this.model.selectedRestrictionType) === null || _a === void 0 ? void 0 : _a.code;\r\n    }\r\n    getRestriction() {\r\n        return this.selectedRestriction;\r\n    }\r\n    isTypeSupported() {\r\n        if (this.getRestrictionTypeCode()) {\r\n            return this.supportedRestrictionTypes.includes(this.model.selectedRestrictionType.code);\r\n        }\r\n        return false;\r\n    }\r\n}\r\nlet /* @ngInject */ RestrictionManagementSelectModelFactory = class /* @ngInject */ RestrictionManagementSelectModelFactory {\r\n    constructor(cmsitemsRestService, catalogService) {\r\n        this.cmsitemsRestService = cmsitemsRestService;\r\n        this.catalogService = catalogService;\r\n    }\r\n    createRestrictionManagementSelectModel(fetchRestrictionTypes, getSupportedRestrictionTypes) {\r\n        const instance = new RestrictionManagementSelectModel(this.cmsitemsRestService, this.catalogService, fetchRestrictionTypes, getSupportedRestrictionTypes);\r\n        instance.initialize();\r\n        return instance;\r\n    }\r\n};\r\n/* @ngInject */ RestrictionManagementSelectModelFactory = __decorate([\r\n    SeDowngradeService(),\r\n    __metadata(\"design:paramtypes\", [CmsitemsRestService,\r\n        ICatalogService])\r\n], /* @ngInject */ RestrictionManagementSelectModelFactory);\r\nexport { /* @ngInject */ RestrictionManagementSelectModelFactory };\r\n//# sourceMappingURL=RestrictionManagementSelectModelFactory.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/dao/RestrictionTypesRestService.ts"],"map":"{\"version\":3,\"file\":\"RestrictionManagementSelectModelFactory.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/components/restrictions/services/RestrictionManagementSelectModelFactory.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/restrictions/services/RestrictionManagementSelectModelFactory.d.ts","writeByteOrderMark":false,"text":"import { ICatalogService, IUriContext, Page, CmsitemsRestService, CMSItem } from 'smarteditcommons';\r\nimport { IRestrictionType } from '../../../dao/RestrictionTypesRestService';\r\ninterface SelectedIdsModel {\r\n    restriction?: string;\r\n    restrictionType?: number;\r\n}\r\nexport declare class RestrictionManagementSelectModel {\r\n    private cmsitemsRestService;\r\n    private catalogService;\r\n    private fetchRestrictionTypes;\r\n    private getSupportedRestrictionTypes;\r\n    selectedIds: SelectedIdsModel;\r\n    private model;\r\n    private restrictions;\r\n    private selectedRestriction;\r\n    private supportedRestrictionTypes;\r\n    constructor(cmsitemsRestService: CmsitemsRestService, catalogService: ICatalogService, fetchRestrictionTypes: () => Promise<IRestrictionType[]>, getSupportedRestrictionTypes: () => Promise<string[]>);\r\n    initialize(): Promise<void>;\r\n    getRestrictionsPaged(mask: string, pageSize: number, currentPage: number): Promise<Page<CMSItem>>;\r\n    getRestrictionFromBackend(): Promise<CMSItem>;\r\n    getRestrictionTypes(): Promise<IRestrictionType[]>;\r\n    restrictionSelected(): boolean;\r\n    restrictionTypeSelected(): boolean;\r\n    createRestrictionSelected(name: string, uriContext: IUriContext): Promise<void>;\r\n    getRestrictionTypeCode(): string;\r\n    getRestriction(): Partial<CMSItem>;\r\n    isTypeSupported(): boolean;\r\n}\r\nexport declare class RestrictionManagementSelectModelFactory {\r\n    private cmsitemsRestService;\r\n    private catalogService;\r\n    constructor(cmsitemsRestService: CmsitemsRestService, catalogService: ICatalogService);\r\n    createRestrictionManagementSelectModel(fetchRestrictionTypes: () => Promise<IRestrictionType[]>, getSupportedRestrictionTypes: () => Promise<string[]>): RestrictionManagementSelectModel;\r\n}\r\nexport {};\r\n"}}
