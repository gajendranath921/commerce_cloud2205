{"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { Injectable } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { IContextAwareEditableItemService } from 'cmscommons';\r\nimport { CmsitemsRestService, IPageService } from 'smarteditcommons';\r\nimport { ContextAwarePageStructureService } from '../../../services';\r\nlet /* @ngInject */ PageEditorModalConfigService = class /* @ngInject */ PageEditorModalConfigService {\r\n    constructor(cmsitemsRestService, pageService, contextAwarePageStructureService, contextAwareEditableItemService, translateService) {\r\n        this.cmsitemsRestService = cmsitemsRestService;\r\n        this.pageService = pageService;\r\n        this.contextAwarePageStructureService = contextAwarePageStructureService;\r\n        this.contextAwareEditableItemService = contextAwareEditableItemService;\r\n        this.translateService = translateService;\r\n    }\r\n    /** Creates a config for given Page that can be used to open a modal.  */\r\n    create(page) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const config = {\r\n                title: 'se.cms.pageeditormodal.editpagetab.title',\r\n                componentUuid: page.uuid,\r\n                componentType: page.typeCode\r\n            };\r\n            // set content\r\n            const [cmsPage, isPagePrimary] = yield Promise.all([\r\n                this.cmsitemsRestService.getById(page.uuid),\r\n                this.pageService.isPagePrimary(page.uid)\r\n            ]);\r\n            config.content = cmsPage;\r\n            config.content.template = cmsPage.masterTemplateId;\r\n            // set structure\r\n            const fields = yield this.contextAwarePageStructureService.getPageStructureForPageEditing(config.content.typeCode, config.content.uid);\r\n            config.structure = fields;\r\n            if (isPagePrimary) {\r\n                config.structure.attributes = this.filterPrimaryPageAttributes(config.structure.attributes);\r\n            }\r\n            if (!!page.uid) {\r\n                yield this.ensureReadOnlyMode(page, config);\r\n            }\r\n            return config;\r\n        });\r\n    }\r\n    filterPrimaryPageAttributes(attributes) {\r\n        return attributes.filter((field) => this.isPrimaryPageAttribute(field));\r\n    }\r\n    isPrimaryPageAttribute(attribute) {\r\n        return (attribute.qualifier !== 'restrictions' &&\r\n            attribute.qualifier !== 'onlyOneRestrictionMustApply');\r\n    }\r\n    ensureReadOnlyMode(page, config) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const isEditable = yield this.contextAwareEditableItemService.isItemEditable(page.uid);\r\n            config.readOnlyMode = !isEditable;\r\n            if (config.readOnlyMode) {\r\n                config.messages = [\r\n                    {\r\n                        type: 'info',\r\n                        message: this.translateService.instant('se.cms.pageeditormodal.page.readonly.message')\r\n                    }\r\n                ];\r\n            }\r\n            return config;\r\n        });\r\n    }\r\n};\r\n/* @ngInject */ PageEditorModalConfigService = __decorate([\r\n    Injectable(),\r\n    __metadata(\"design:paramtypes\", [CmsitemsRestService,\r\n        IPageService,\r\n        ContextAwarePageStructureService,\r\n        IContextAwareEditableItemService,\r\n        TranslateService])\r\n], /* @ngInject */ PageEditorModalConfigService);\r\nexport { /* @ngInject */ PageEditorModalConfigService };\r\n//# sourceMappingURL=PageEditorModalConfigService.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@ngx-translate+core@11.0.1_@angular+core@8.2.14+rxjs@6.5.4/node_modules/@ngx-translate/core/ngx-translate-core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/index.ts"],"map":"{\"version\":3,\"file\":\"PageEditorModalConfigService.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/components/pages/services/PageEditorModalConfigService.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/pages/services/PageEditorModalConfigService.d.ts","writeByteOrderMark":false,"text":"import { TranslateService } from '@ngx-translate/core';\r\nimport { IContextAwareEditableItemService } from 'cmscommons';\r\nimport { CmsitemsRestService, IPageService, ICMSPage, IGenericEditorModalServiceComponent } from 'smarteditcommons';\r\nimport { ContextAwarePageStructureService } from '../../../services';\r\nexport declare class PageEditorModalConfigService {\r\n    private cmsitemsRestService;\r\n    private pageService;\r\n    private contextAwarePageStructureService;\r\n    private contextAwareEditableItemService;\r\n    private translateService;\r\n    constructor(cmsitemsRestService: CmsitemsRestService, pageService: IPageService, contextAwarePageStructureService: ContextAwarePageStructureService, contextAwareEditableItemService: IContextAwareEditableItemService, translateService: TranslateService);\r\n    /** Creates a config for given Page that can be used to open a modal.  */\r\n    create(page: ICMSPage): Promise<IGenericEditorModalServiceComponent>;\r\n    private filterPrimaryPageAttributes;\r\n    private isPrimaryPageAttribute;\r\n    private ensureReadOnlyMode;\r\n}\r\n"}}
