{"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { SeDowngradeService, LogService, IPageService } from 'smarteditcommons';\r\nimport { PageRestrictionsService } from '../services/pageRestrictions/PageRestrictionsService';\r\nlet /* @ngInject */ DisplayConditionsFacade = class /* @ngInject */ DisplayConditionsFacade {\r\n    constructor(pageService, pageRestrictionsService, logService) {\r\n        this.pageService = pageService;\r\n        this.pageRestrictionsService = pageRestrictionsService;\r\n        this.logService = logService;\r\n    }\r\n    getPageInfoForPageUid(pageId) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const pagePromise = this.pageService.getPageById(pageId);\r\n            const displayConditionsPromise = this.pageService.isPagePrimary(pageId);\r\n            const [page, isPrimary] = yield Promise.all([pagePromise, displayConditionsPromise]);\r\n            return {\r\n                pageName: page.name,\r\n                pageType: page.typeCode,\r\n                isPrimary\r\n            };\r\n        });\r\n    }\r\n    getVariationsForPageUid(primaryPageId) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const variationPages = yield this.pageService.getVariationPages(primaryPageId);\r\n            if (variationPages.length === 0) {\r\n                return [];\r\n            }\r\n            const restrictionCounts = yield Promise.all(variationPages.map((variationPage) => this.pageRestrictionsService.getPageRestrictionsCountForPageUID(variationPage.uid)));\r\n            return variationPages.map((variationPage, index) => ({\r\n                pageName: variationPage.name,\r\n                creationDate: variationPage.creationtime,\r\n                restrictions: restrictionCounts[index]\r\n            }));\r\n        });\r\n    }\r\n    updatePage(pageId, pageData) {\r\n        return this.pageService.updatePageById(pageId, pageData);\r\n    }\r\n    isPagePrimary(pageId) {\r\n        return this.pageService.isPagePrimary(pageId);\r\n    }\r\n    getPrimaryPageForVariationPage(variationPageId) {\r\n        return this.pageService.getPrimaryPage(variationPageId).then((primaryPage) => ({\r\n            uid: primaryPage.uid,\r\n            name: primaryPage.name,\r\n            label: primaryPage.label\r\n        }));\r\n    }\r\n    getPrimaryPagesForPageType(pageTypeCode, uriParams, fetchPageParams) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            try {\r\n                const page = yield this.pageService.getPaginatedPrimaryPagesForPageType(pageTypeCode, uriParams, fetchPageParams);\r\n                return {\r\n                    pagination: page.pagination,\r\n                    results: page.response.map((rawPage) => ({\r\n                        id: rawPage.uid,\r\n                        label: rawPage.name || rawPage.label\r\n                    }))\r\n                };\r\n            }\r\n            catch (error) {\r\n                this.logService.warn(`[getPrimaryPagesForPageType] - Cannot retrieve list of primary pages. ${error}`);\r\n            }\r\n        });\r\n    }\r\n};\r\n/* @ngInject */ DisplayConditionsFacade = __decorate([\r\n    SeDowngradeService(),\r\n    __metadata(\"design:paramtypes\", [IPageService,\r\n        PageRestrictionsService,\r\n        LogService])\r\n], /* @ngInject */ DisplayConditionsFacade);\r\nexport { /* @ngInject */ DisplayConditionsFacade };\r\n//# sourceMappingURL=DisplayConditionsFacade.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/pageRestrictions/PageRestrictionsService.ts"],"map":"{\"version\":3,\"file\":\"DisplayConditionsFacade.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/facades/DisplayConditionsFacade.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/facades/DisplayConditionsFacade.d.ts","writeByteOrderMark":false,"text":"import { IUriContext, Page as SePage, SelectItem, LogService, IPageService, ICMSPage } from 'smarteditcommons';\r\nimport { PageRestrictionsService } from '../services/pageRestrictions/PageRestrictionsService';\r\nexport interface IDisplayConditionsPageVariation {\r\n    pageName: string;\r\n    creationDate: string | Date;\r\n    restrictions: number;\r\n}\r\nexport interface IDisplayConditionsPageInfo {\r\n    pageName: string;\r\n    pageType: string;\r\n    isPrimary: boolean;\r\n}\r\nexport interface IDisplayConditionsPrimaryPage {\r\n    uid: string;\r\n    uuid: string;\r\n    name: string;\r\n    label: string;\r\n}\r\nexport declare class DisplayConditionsFacade {\r\n    private pageService;\r\n    private pageRestrictionsService;\r\n    private logService;\r\n    constructor(pageService: IPageService, pageRestrictionsService: PageRestrictionsService, logService: LogService);\r\n    getPageInfoForPageUid(pageId: string): Promise<IDisplayConditionsPageInfo>;\r\n    getVariationsForPageUid(primaryPageId: string): Promise<IDisplayConditionsPageVariation[]>;\r\n    updatePage(pageId: string, pageData: ICMSPage): Promise<ICMSPage>;\r\n    isPagePrimary(pageId: string): Promise<boolean>;\r\n    getPrimaryPageForVariationPage(variationPageId: string): Promise<Partial<IDisplayConditionsPrimaryPage>>;\r\n    getPrimaryPagesForPageType(pageTypeCode: string, uriParams?: IUriContext, fetchPageParams?: {\r\n        search: string;\r\n        pageSize: number;\r\n        currentPage: number;\r\n    }): Promise<SePage<SelectItem>>;\r\n}\r\n"}}
