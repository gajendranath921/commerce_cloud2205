{"code":"import { __awaiter, __decorate, __metadata, __param } from \"tslib\";\r\nimport { Component, Inject } from '@angular/core';\r\nimport { EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV } from 'cmscommons';\r\nimport { ManagePageService } from 'cmssmarteditcontainer/services/pages/ManagePageService';\r\nimport { CrossFrameEventService, DROPDOWN_MENU_ITEM_DATA, ICatalogService, SeDowngradeComponent, CmsitemsRestService, CMSPageStatus, UserTrackingService, USER_TRACKING_FUNCTIONALITY } from 'smarteditcommons';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"PermanentlyDeletePageItemComponent\", {\r\n    selector: 'se-permanently-delete-page-item',\r\n    template: `<div *seHasOperationPermission=\"permanentlyDeletePagePermission\"><div class=\"se-dropdown-item__delete-wrapper\"><div class=\"se-dropdown-item__delete-link-wrapper\" [ngClass]=\"{'se-dropdown-item__delete-link-wrapper--disabled': isDeleteButtonDisabled()}\"><a class=\"se-dropdown-item se-dropdown-item__delete fd-menu__item\" [ngClass]=\"{'se-dropdown-item--disabled': isDeleteButtonDisabled()}\" (click)=\"permanentlyDelete()\"><span [translate]=\"'se.cms.actionitem.page.permanently.delete'\"></span></a></div><se-tooltip class=\"se-dropdown-item__delete-page-popover\" *ngIf=\"isDeleteButtonDisabled()\" [placement]=\"'left'\" [triggers]=\"['mouseenter', 'mouseleave']\" [isChevronVisible]=\"true\" [appendTo]=\"'body'\"><span se-tooltip-trigger class=\"sap-icon--message-error\"></span> <span se-tooltip-body [translate]=\"'se.cms.actionitem.page.permanently.delete.blocked'\"></span></se-tooltip></div></div>`,\r\n    styles: [`.se-dropdown-item__delete-wrapper{display:flex;flex-direction:row;align-items:center;width:100%}.se-dropdown-item__delete-page-popover{margin-right:16px}.se-dropdown-item__delete-page-popover .sap-icon--message-error{color:#0a6ed1}.se-dropdown-item__delete-link-wrapper{width:100%}.se-dropdown-item__delete-link-wrapper--disabled{cursor:not-allowed}`]\r\n});\r\nlet /* @ngInject */ PermanentlyDeletePageItemComponent = class /* @ngInject */ PermanentlyDeletePageItemComponent {\r\n    constructor(managePageService, cmsitemsRestService, catalogService, crossFrameEventService, userTrackingService, dropdownMenuData) {\r\n        this.managePageService = managePageService;\r\n        this.cmsitemsRestService = cmsitemsRestService;\r\n        this.catalogService = catalogService;\r\n        this.crossFrameEventService = crossFrameEventService;\r\n        this.userTrackingService = userTrackingService;\r\n        this.dropdownMenuData = dropdownMenuData;\r\n        this.isDeletable = false;\r\n    }\r\n    ngOnInit() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.pageInfo = this.dropdownMenuData.selectedItem;\r\n            this.permanentlyDeletePagePermission = [\r\n                {\r\n                    names: ['se.permanently.delete.page.type'],\r\n                    context: {\r\n                        typeCode: this.pageInfo.typeCode\r\n                    }\r\n                }\r\n            ];\r\n            this.unregPageSyncStatusUpdate = this.crossFrameEventService.subscribe(EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV, this.fetchPageDeletableConditions.bind(this));\r\n            yield this.fetchPageDeletableConditions();\r\n        });\r\n    }\r\n    ngOnDestroy() {\r\n        this.unregPageSyncStatusUpdate();\r\n    }\r\n    permanentlyDelete() {\r\n        this.userTrackingService.trackingUserAction(USER_TRACKING_FUNCTIONALITY.PAGE_MANAGEMENT, 'Permanently Delete');\r\n        if (this.isDeletable) {\r\n            this.managePageService.hardDeletePage(this.pageInfo);\r\n        }\r\n    }\r\n    isDeleteButtonDisabled() {\r\n        return !this.isDeletable;\r\n    }\r\n    fetchPageDeletableConditions() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const uriContext = yield this.catalogService.retrieveUriContext();\r\n            const activeVersion = yield this.catalogService.getContentCatalogActiveVersion(uriContext);\r\n            const cmsItemResult = yield this.cmsitemsRestService.get({\r\n                pageSize: 1,\r\n                currentPage: 0,\r\n                typeCode: 'AbstractPage',\r\n                fields: 'BASIC',\r\n                itemSearchParams: `uid:${this.pageInfo.uid}`,\r\n                catalogId: uriContext.CURRENT_CONTEXT_CATALOG,\r\n                catalogVersion: activeVersion\r\n            });\r\n            this.isDeletable =\r\n                cmsItemResult.pagination.totalCount === 0 ||\r\n                    cmsItemResult.response[0].pageStatus === CMSPageStatus.DELETED;\r\n        });\r\n    }\r\n};\r\n/* @ngInject */ PermanentlyDeletePageItemComponent = __decorate([\r\n    SeDowngradeComponent(),\r\n    Component({\r\n        selector: 'se-permanently-delete-page-item',\r\n        template: `<div *seHasOperationPermission=\"permanentlyDeletePagePermission\"><div class=\"se-dropdown-item__delete-wrapper\"><div class=\"se-dropdown-item__delete-link-wrapper\" [ngClass]=\"{'se-dropdown-item__delete-link-wrapper--disabled': isDeleteButtonDisabled()}\"><a class=\"se-dropdown-item se-dropdown-item__delete fd-menu__item\" [ngClass]=\"{'se-dropdown-item--disabled': isDeleteButtonDisabled()}\" (click)=\"permanentlyDelete()\"><span [translate]=\"'se.cms.actionitem.page.permanently.delete'\"></span></a></div><se-tooltip class=\"se-dropdown-item__delete-page-popover\" *ngIf=\"isDeleteButtonDisabled()\" [placement]=\"'left'\" [triggers]=\"['mouseenter', 'mouseleave']\" [isChevronVisible]=\"true\" [appendTo]=\"'body'\"><span se-tooltip-trigger class=\"sap-icon--message-error\"></span> <span se-tooltip-body [translate]=\"'se.cms.actionitem.page.permanently.delete.blocked'\"></span></se-tooltip></div></div>`,\r\n        styles: [`.se-dropdown-item__delete-wrapper{display:flex;flex-direction:row;align-items:center;width:100%}.se-dropdown-item__delete-page-popover{margin-right:16px}.se-dropdown-item__delete-page-popover .sap-icon--message-error{color:#0a6ed1}.se-dropdown-item__delete-link-wrapper{width:100%}.se-dropdown-item__delete-link-wrapper--disabled{cursor:not-allowed}`]\r\n    }),\r\n    __param(5, Inject(DROPDOWN_MENU_ITEM_DATA)),\r\n    __metadata(\"design:paramtypes\", [ManagePageService,\r\n        CmsitemsRestService,\r\n        ICatalogService,\r\n        CrossFrameEventService,\r\n        UserTrackingService, Object])\r\n], /* @ngInject */ PermanentlyDeletePageItemComponent);\r\nexport { /* @ngInject */ PermanentlyDeletePageItemComponent };\r\n//# sourceMappingURL=PermanentlyDeletePageItemComponent.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/pages/ManagePageService.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"PermanentlyDeletePageItemComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/components/pages/pageItems/permanentlyDeletePageItem/PermanentlyDeletePageItemComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/pages/pageItems/permanentlyDeletePageItem/PermanentlyDeletePageItemComponent.d.ts","writeByteOrderMark":false,"text":"import { OnDestroy, OnInit } from '@angular/core';\r\nimport { ManagePageService } from 'cmssmarteditcontainer/services/pages/ManagePageService';\r\nimport { CrossFrameEventService, ICatalogService, IDropdownMenuItemData, MultiNamePermissionContext, CmsitemsRestService, ICMSPage, UserTrackingService } from 'smarteditcommons';\r\nexport declare class PermanentlyDeletePageItemComponent implements OnInit, OnDestroy {\r\n    private managePageService;\r\n    private cmsitemsRestService;\r\n    private catalogService;\r\n    private crossFrameEventService;\r\n    private userTrackingService;\r\n    private dropdownMenuData;\r\n    pageInfo: ICMSPage;\r\n    permanentlyDeletePagePermission: MultiNamePermissionContext[];\r\n    private unregPageSyncStatusUpdate;\r\n    private isDeletable;\r\n    constructor(managePageService: ManagePageService, cmsitemsRestService: CmsitemsRestService, catalogService: ICatalogService, crossFrameEventService: CrossFrameEventService, userTrackingService: UserTrackingService, dropdownMenuData: IDropdownMenuItemData);\r\n    ngOnInit(): Promise<void>;\r\n    ngOnDestroy(): void;\r\n    permanentlyDelete(): void;\r\n    isDeleteButtonDisabled(): boolean;\r\n    private fetchPageDeletableConditions;\r\n}\r\n"}}
