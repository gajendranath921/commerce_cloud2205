{"code":"import { __decorate, __metadata, __param } from \"tslib\";\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject } from '@angular/core';\r\nimport { GENERIC_EDITOR_WIDGET_DATA, LINKED_DROPDOWN, SystemEventService } from 'smarteditcommons';\r\nimport { CMS_LINK_TO_RELOAD_STRUCTURE_EVENT_ID } from '../../../constants';\r\nimport { LinkToOption } from './types';\r\nconst SelectOptions = [\r\n    {\r\n        id: LinkToOption.content,\r\n        structureApiMode: 'CONTENT'\r\n    },\r\n    {\r\n        id: LinkToOption.product,\r\n        structureApiMode: 'PRODUCT',\r\n        hasCatalog: true\r\n    },\r\n    {\r\n        id: LinkToOption.category,\r\n        structureApiMode: 'CATEGORY',\r\n        hasCatalog: true\r\n    },\r\n    {\r\n        id: LinkToOption.external,\r\n        structureApiMode: 'EXTERNAL'\r\n    }\r\n];\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"CmsLinkToSelectComponent\", {\r\n    selector: 'se-cms-link-to-select',\r\n    template: `<se-generic-editor-dropdown [id]=\"id\" [field]=\"field\" [qualifier]=\"qualifier\" [model]=\"optionModel\"></se-generic-editor-dropdown>`,\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nlet CmsLinkToSelectComponent = class CmsLinkToSelectComponent {\r\n    constructor(cdr, systemEventService, data) {\r\n        this.cdr = cdr;\r\n        this.systemEventService = systemEventService;\r\n        this.data = data;\r\n        ({\r\n            id: this.id,\r\n            field: this.field,\r\n            model: this.optionModel,\r\n            qualifier: this.qualifier\r\n        } = data);\r\n    }\r\n    ngOnInit() {\r\n        const linkTo = this.getLinkToValue(this.optionModel);\r\n        if (linkTo !== null) {\r\n            this.optionModel.linkTo = linkTo;\r\n        }\r\n        this.data.editor.api.considerFormDirty();\r\n        this.data.editor.api.setAlwaysEnableSubmit(true);\r\n        const onSelectValueChangedEventName = `${this.id}${LINKED_DROPDOWN}`;\r\n        this.unRegSelectValueChanged = this.systemEventService.subscribe(onSelectValueChangedEventName, (_eventId, data) => this.onLinkToSelectValueChanged(data));\r\n    }\r\n    ngOnDestroy() {\r\n        this.unRegSelectValueChanged();\r\n    }\r\n    onLinkToSelectValueChanged({ optionObject: option, qualifier }) {\r\n        if (this.qualifier !== qualifier) {\r\n            return;\r\n        }\r\n        if (!option) {\r\n            return;\r\n        }\r\n        const optionValue = option.id;\r\n        const selectedOption = SelectOptions.find(({ id }) => id === optionValue);\r\n        if (!selectedOption) {\r\n            throw new Error('Selected option is not supported');\r\n        }\r\n        if (optionValue === this.optionModel.currentSelectedOptionValue) {\r\n            return;\r\n        }\r\n        this.optionModel.currentSelectedOptionValue = optionValue;\r\n        this.optionModel.external = optionValue !== LinkToOption.external;\r\n        this.clearModel(selectedOption);\r\n        this.systemEventService.publishAsync(CMS_LINK_TO_RELOAD_STRUCTURE_EVENT_ID, {\r\n            content: this.optionModel,\r\n            structureApiMode: selectedOption.structureApiMode,\r\n            editorId: this.id\r\n        });\r\n        if (!this.cdr.destroyed) {\r\n            this.cdr.detectChanges();\r\n        }\r\n    }\r\n    getLinkToValue(model) {\r\n        if (model.product) {\r\n            return LinkToOption.product;\r\n        }\r\n        else if (model.contentPage) {\r\n            return LinkToOption.content;\r\n        }\r\n        else if (model.category) {\r\n            return LinkToOption.category;\r\n        }\r\n        else if (model.url || (model.linkToggle && model.linkToggle.urlLink) || model.urlLink) {\r\n            return LinkToOption.external;\r\n        }\r\n        return null;\r\n    }\r\n    clearModel({ id, hasCatalog }) {\r\n        if (id !== LinkToOption.category) {\r\n            delete this.optionModel.category;\r\n        }\r\n        if (id !== LinkToOption.product) {\r\n            delete this.optionModel.product;\r\n        }\r\n        if (!hasCatalog) {\r\n            delete this.optionModel.productCatalog;\r\n        }\r\n        if (id !== LinkToOption.content) {\r\n            delete this.optionModel.contentPage;\r\n        }\r\n        if (id !== LinkToOption.external) {\r\n            delete this.optionModel.url;\r\n            delete this.optionModel.urlLink;\r\n            if (this.optionModel.linkToggle && this.optionModel.linkToggle.urlLink) {\r\n                delete this.optionModel.linkToggle.urlLink;\r\n            }\r\n        }\r\n    }\r\n};\r\nCmsLinkToSelectComponent = __decorate([\r\n    Component({\r\n        selector: 'se-cms-link-to-select',\r\n        template: `<se-generic-editor-dropdown [id]=\"id\" [field]=\"field\" [qualifier]=\"qualifier\" [model]=\"optionModel\"></se-generic-editor-dropdown>`,\r\n        changeDetection: ChangeDetectionStrategy.OnPush\r\n    }),\r\n    __param(2, Inject(GENERIC_EDITOR_WIDGET_DATA)),\r\n    __metadata(\"design:paramtypes\", [ChangeDetectorRef,\r\n        SystemEventService, Object])\r\n], CmsLinkToSelectComponent);\r\nexport { CmsLinkToSelectComponent };\r\n//# sourceMappingURL=CmsLinkToSelectComponent.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/constants.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/genericEditor/cmsLinkToSelect/types.ts"],"map":"{\"version\":3,\"file\":\"CmsLinkToSelectComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/components/genericEditor/cmsLinkToSelect/CmsLinkToSelectComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/genericEditor/cmsLinkToSelect/CmsLinkToSelectComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef, OnDestroy, OnInit } from '@angular/core';\r\nimport { GenericEditorField, GenericEditorWidgetData, SystemEventService } from 'smarteditcommons';\r\nimport { CmsLinkToSelectOption } from './types';\r\nexport declare class CmsLinkToSelectComponent implements OnInit, OnDestroy {\r\n    private cdr;\r\n    private systemEventService;\r\n    data: GenericEditorWidgetData<CmsLinkToSelectOption>;\r\n    id: string;\r\n    field: GenericEditorField;\r\n    optionModel: CmsLinkToSelectOption;\r\n    qualifier: string;\r\n    private unRegSelectValueChanged;\r\n    constructor(cdr: ChangeDetectorRef, systemEventService: SystemEventService, data: GenericEditorWidgetData<CmsLinkToSelectOption>);\r\n    ngOnInit(): void;\r\n    ngOnDestroy(): void;\r\n    private onLinkToSelectValueChanged;\r\n    private getLinkToValue;\r\n    private clearModel;\r\n}\r\n"}}
