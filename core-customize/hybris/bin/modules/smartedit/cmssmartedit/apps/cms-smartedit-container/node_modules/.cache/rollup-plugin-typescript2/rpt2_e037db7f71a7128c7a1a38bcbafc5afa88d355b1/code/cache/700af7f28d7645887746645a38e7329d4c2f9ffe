{"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\n/* eslint-disable max-classes-per-file */\r\nimport { ICatalogService, SeDowngradeService } from 'smarteditcommons';\r\nimport { ContextAwarePageStructureService } from '../ContextAwarePageStructureService';\r\nexport class PageBuilder {\r\n    constructor(catalogService, contextAwarePageStructureService, restrictionsStepHandler, uriContext) {\r\n        this.catalogService = catalogService;\r\n        this.contextAwarePageStructureService = contextAwarePageStructureService;\r\n        this.restrictionsStepHandler = restrictionsStepHandler;\r\n        this.uriContext = uriContext;\r\n        this.model = {};\r\n        this.page = {\r\n            restrictions: []\r\n        };\r\n        this.catalogService.getCatalogVersionUUid(this.uriContext).then((catalogVersionUuid) => {\r\n            this.page.catalogVersion = catalogVersionUuid;\r\n        });\r\n    }\r\n    pageTypeSelected(pageTypeObject) {\r\n        this.model.pageType = pageTypeObject;\r\n        this.model.pageTemplate = null;\r\n        return this.updatePageInfoFields();\r\n    }\r\n    pageTemplateSelected(pageTemplateObject) {\r\n        this.model.pageTemplate = pageTemplateObject;\r\n    }\r\n    getPageTypeCode() {\r\n        var _a;\r\n        return ((_a = this.model.pageType) === null || _a === void 0 ? void 0 : _a.code) || null;\r\n    }\r\n    getTemplateUuid() {\r\n        var _a;\r\n        return ((_a = this.model.pageTemplate) === null || _a === void 0 ? void 0 : _a.uuid) || '';\r\n    }\r\n    getPage() {\r\n        var _a, _b;\r\n        this.page.typeCode = this.getPageTypeCode();\r\n        this.page.itemtype = this.page.typeCode;\r\n        this.page.type = ((_a = this.model.pageType) === null || _a === void 0 ? void 0 : _a.type) || null;\r\n        this.page.masterTemplate = this.getTemplateUuid() || null;\r\n        this.page.template = ((_b = this.model.pageTemplate) === null || _b === void 0 ? void 0 : _b.uid) || null;\r\n        return this.page;\r\n    }\r\n    getPageRestrictions() {\r\n        return this.page.restrictions;\r\n    }\r\n    setPageUid(uid) {\r\n        this.page.uid = uid;\r\n    }\r\n    setRestrictions(onlyOneRestrictionMustApply, restrictions) {\r\n        this.page.onlyOneRestrictionMustApply = onlyOneRestrictionMustApply;\r\n        this.page.restrictions = restrictions;\r\n    }\r\n    getPageInfoStructure() {\r\n        return this.model.pageInfoFields;\r\n    }\r\n    displayConditionSelected(displayConditionResult) {\r\n        const isPrimaryPage = displayConditionResult.isPrimary;\r\n        this.page.defaultPage = isPrimaryPage;\r\n        this.page.homepage = displayConditionResult.homepage;\r\n        if (isPrimaryPage) {\r\n            this.page.label = null;\r\n            this.restrictionsStepHandler.hideStep();\r\n        }\r\n        else {\r\n            this.page.label = displayConditionResult.primaryPage\r\n                ? displayConditionResult.primaryPage.label\r\n                : '';\r\n            this.restrictionsStepHandler.showStep();\r\n        }\r\n        return this.updatePageInfoFields();\r\n    }\r\n    updatePageInfoFields() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (this.page.defaultPage !== undefined) {\r\n                if (this.model.pageType) {\r\n                    const pageInfoFields = yield this.contextAwarePageStructureService.getPageStructureForNewPage(this.model.pageType.code, this.page.defaultPage);\r\n                    this.model.pageInfoFields = pageInfoFields;\r\n                }\r\n                else {\r\n                    this.model.pageInfoFields = {};\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\nlet /* @ngInject */ PageBuilderFactory = class /* @ngInject */ PageBuilderFactory {\r\n    constructor(catalogService, contextAwarePageStructureService) {\r\n        this.catalogService = catalogService;\r\n        this.contextAwarePageStructureService = contextAwarePageStructureService;\r\n    }\r\n    createPageBuilder(restrictionsStepHandler, uriContext) {\r\n        return new PageBuilder(this.catalogService, this.contextAwarePageStructureService, restrictionsStepHandler, uriContext);\r\n    }\r\n};\r\n/* @ngInject */ PageBuilderFactory = __decorate([\r\n    SeDowngradeService(),\r\n    __metadata(\"design:paramtypes\", [ICatalogService,\r\n        ContextAwarePageStructureService])\r\n], /* @ngInject */ PageBuilderFactory);\r\nexport { /* @ngInject */ PageBuilderFactory };\r\n//# sourceMappingURL=PageBuilderFactory.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/dao/PageTypeService.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/interfaces/index.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/ContextAwarePageStructureService.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/pages/types.ts"],"map":"{\"version\":3,\"file\":\"PageBuilderFactory.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/services/pages/PageBuilderFactory.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/services/pages/PageBuilderFactory.d.ts","writeByteOrderMark":false,"text":"import { GenericEditorStructure, ICatalogService, IUriContext, Nullable, ICMSPage, CMSPageTypes, PageTemplateType } from 'smarteditcommons';\r\nimport { PageType } from '../../dao/PageTypeService';\r\nimport { IRestrictionsStepHandler } from '../../interfaces';\r\nimport { ContextAwarePageStructureService } from '../ContextAwarePageStructureService';\r\nexport declare class PageBuilder {\r\n    private catalogService;\r\n    private contextAwarePageStructureService;\r\n    private restrictionsStepHandler;\r\n    private uriContext;\r\n    private model;\r\n    private page;\r\n    constructor(catalogService: ICatalogService, contextAwarePageStructureService: ContextAwarePageStructureService, restrictionsStepHandler: IRestrictionsStepHandler, uriContext: IUriContext);\r\n    pageTypeSelected(pageTypeObject: PageType): Promise<void>;\r\n    pageTemplateSelected(pageTemplateObject: PageTemplateType): void;\r\n    getPageTypeCode(): Nullable<CMSPageTypes>;\r\n    getTemplateUuid(): string;\r\n    getPage(): ICMSPage;\r\n    getPageRestrictions(): string[];\r\n    setPageUid(uid: string): void;\r\n    setRestrictions(onlyOneRestrictionMustApply: boolean, restrictions: string[]): void;\r\n    getPageInfoStructure(): GenericEditorStructure;\r\n    displayConditionSelected(displayConditionResult: ICMSPage): Promise<void>;\r\n    private updatePageInfoFields;\r\n}\r\nexport declare class PageBuilderFactory {\r\n    private catalogService;\r\n    private contextAwarePageStructureService;\r\n    constructor(catalogService: ICatalogService, contextAwarePageStructureService: ContextAwarePageStructureService);\r\n    createPageBuilder(restrictionsStepHandler: IRestrictionsStepHandler, uriContext: IUriContext): PageBuilder;\r\n}\r\n"}}
