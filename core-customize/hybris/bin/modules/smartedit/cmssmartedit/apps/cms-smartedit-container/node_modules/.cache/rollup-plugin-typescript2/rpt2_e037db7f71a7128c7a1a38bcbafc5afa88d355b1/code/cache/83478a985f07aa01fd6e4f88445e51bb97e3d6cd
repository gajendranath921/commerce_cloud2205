{"code":"import { __decorate, __metadata } from \"tslib\";\r\nimport { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { isEqual } from 'lodash';\r\nimport { SeDowngradeComponent } from 'smarteditcommons';\r\nimport { PageRestrictionsCriteriaService } from '../../../../services/pageRestrictions/PageRestrictionsCriteriaService';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"RestrictionsTableComponent\", {\r\n    selector: 'se-restrictions-table',\r\n    template: `<div class=\"se-restriction-table-wrapper se-restriction-table-left\" [ngClass]=\"customClass\"><div class=\"se-restrictions-list fd-menu__list fd-menu__list--separated\" *ngIf=\"restrictions.length > 0\"><div id=\"restriction-{{ index + 1 }}\" *ngFor=\"let restriction of restrictions; let index = index\" class=\"se-restriction__item fd-menu__item\"><div class=\"se-restrictions-list__item-content\"><p class=\"se-restriction__item-name\" [ngClass]=\"{ 'error-input': isInError(index) }\">{{ restriction.name }}</p><div class=\"se-restriction__item-type-and-id\" [ngClass]=\"{ 'error-input': isInError(index) }\">{{ restriction.typeCode }}</div><div class=\"se-restriction__item-description\" [ngClass]=\"{ 'error-input': isInError(index) }\" [title]=\"restriction.description\">{{ restriction.description }}</div><div id=\"restrictionPartOfWorkflow\" *ngIf=\"restriction.canBeEdited!==undefined && !restriction.canBeEdited\" translate=\"se.cms.restrictions.editor.part.of.workflow\"></div></div><div *ngIf=\"editable\"><se-dropdown-menu [dropdownItems]=\"restriction.actions || defaultActions\" [selectedItem]=\"restriction\" [placement]=\"'bottom-start'\"></se-dropdown-menu></div></div></div><div *ngIf=\"restrictions.length === 0\" class=\"se-restrictions-list--empty\"><span class=\"se-restrictions-list--empty__message\" translate=\"se.cms.restrictions.emptylist.message\"></span></div></div>`,\r\n    styles: [`.se-restrictions-list .se-restriction__item{display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-top-color:#eeeeef!important;cursor:default}.se-restrictions-list .se-restriction__item:last-child{margin-bottom:42px}.se-restriction__item-name{font-weight:700;color:#32363a;margin:0}.se-restriction__item-type-and-id{color:#51555a;margin-top:0}.se-restriction__item-description{text-overflow:ellipsis;white-space:initial;overflow:hidden;word-break:break-all;color:#6a6d70;width:90%}.se-restrictions-list--empty__message{color:#6a6d70}.error-input.se-restriction__item-description,.error-input.se-restriction__item-name,.error-input.se-restriction__item-type-and-id{color:#b00}`]\r\n});\r\nlet /* @ngInject */ RestrictionsTableComponent = class /* @ngInject */ RestrictionsTableComponent {\r\n    constructor(pageRestrictionsCriteriaService) {\r\n        this.pageRestrictionsCriteriaService = pageRestrictionsCriteriaService;\r\n        this.REMOVE_RESTRICTION_KEY = 'se.cms.restrictions.item.remove';\r\n        this.EDIT_RESTRICTION_KEY = 'se.cms.restrictions.item.edit';\r\n        this.onEdit = new EventEmitter();\r\n        this.onRemove = new EventEmitter();\r\n        this.errors = [];\r\n        this.criteriaOptions = [];\r\n        this.defaultActions = [];\r\n        this.oldRestrictionsEditability = [];\r\n    }\r\n    ngOnInit() {\r\n        this.oldRestrictionsEditability = this.getRestrictionsEditability(this.restrictions);\r\n        this.defaultActions = this.getDefaultActions();\r\n        this.provideActionsForRestrictions();\r\n        this.criteriaOptions = this.pageRestrictionsCriteriaService.getRestrictionCriteriaOptions();\r\n        this.resetRestrictionCriteria();\r\n    }\r\n    ngOnChanges() {\r\n        if (this.restrictionsEditabilityChanged(this.restrictions)) {\r\n            this.provideActionsForRestrictions();\r\n            this.oldRestrictionsEditability = this.getRestrictionsEditability(this.restrictions);\r\n        }\r\n        this.resetRestrictionCriteria();\r\n    }\r\n    resetRestrictionCriteria() {\r\n        if (!this.restrictions || this.restrictions.length < 2) {\r\n            this.restrictionCriteria = this.criteriaOptions[0];\r\n        }\r\n    }\r\n    removeRestriction(restrictionToRemove) {\r\n        const restrictionIndex = this.restrictions.findIndex((restriction) => restriction.uuid === restrictionToRemove.uuid);\r\n        this.onRemove.emit(restrictionIndex);\r\n        this.removeUnnecessaryError(restrictionIndex);\r\n        this.modifyErrorPositions(restrictionIndex);\r\n    }\r\n    editRestriction(restriction) {\r\n        this.onEdit.emit(restriction);\r\n    }\r\n    isInError(index) {\r\n        var _a;\r\n        return !!((_a = this.errors) === null || _a === void 0 ? void 0 : _a.some((error) => error.position === index));\r\n    }\r\n    getRestrictionsEditability(restrictions) {\r\n        return (restrictions || []).map((restriction) => restriction.canBeEdited);\r\n    }\r\n    modifyErrorPositions(removedRestrictionIndex) {\r\n        this.errors = this.errors.map((error) => {\r\n            if (error.position >= removedRestrictionIndex) {\r\n                error.position = error.position - 1;\r\n            }\r\n            return error;\r\n        });\r\n    }\r\n    removeUnnecessaryError(removedRestrictionIndex) {\r\n        const errorIndex = this.errors.findIndex((error) => error.position === removedRestrictionIndex);\r\n        if (errorIndex > -1) {\r\n            this.errors = this.errors.filter((_, index) => index !== errorIndex);\r\n        }\r\n    }\r\n    getDefaultActions() {\r\n        return [\r\n            {\r\n                key: this.EDIT_RESTRICTION_KEY,\r\n                callback: (restriction) => this.editRestriction(restriction)\r\n            },\r\n            {\r\n                key: this.REMOVE_RESTRICTION_KEY,\r\n                callback: (restrictionToRemove) => this.removeRestriction(restrictionToRemove),\r\n                customCss: 'se-dropdown-item__delete'\r\n            }\r\n        ];\r\n    }\r\n    getRestrictionActions(restriction) {\r\n        const actions = this.getDefaultActions();\r\n        if (!restriction.canBeEdited) {\r\n            return actions.filter((action) => action.key !== this.EDIT_RESTRICTION_KEY);\r\n        }\r\n        return actions;\r\n    }\r\n    provideActionsForRestrictions() {\r\n        (this.restrictions || []).forEach((restriction) => {\r\n            restriction.actions = this.getRestrictionActions(restriction);\r\n        });\r\n    }\r\n    restrictionsEditabilityChanged(restrictions) {\r\n        const restrictionsEditability = this.getRestrictionsEditability(restrictions);\r\n        return !isEqual(restrictionsEditability, this.oldRestrictionsEditability);\r\n    }\r\n};\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", Array)\r\n], /* @ngInject */ RestrictionsTableComponent.prototype, \"restrictions\", void 0);\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", String)\r\n], /* @ngInject */ RestrictionsTableComponent.prototype, \"customClass\", void 0);\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", Boolean)\r\n], /* @ngInject */ RestrictionsTableComponent.prototype, \"editable\", void 0);\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", Object)\r\n], /* @ngInject */ RestrictionsTableComponent.prototype, \"restrictionCriteria\", void 0);\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", Array)\r\n], /* @ngInject */ RestrictionsTableComponent.prototype, \"errors\", void 0);\r\n__decorate([\r\n    Output(),\r\n    __metadata(\"design:type\", EventEmitter)\r\n], /* @ngInject */ RestrictionsTableComponent.prototype, \"onEdit\", void 0);\r\n__decorate([\r\n    Output(),\r\n    __metadata(\"design:type\", EventEmitter)\r\n], /* @ngInject */ RestrictionsTableComponent.prototype, \"onRemove\", void 0);\r\n/* @ngInject */ RestrictionsTableComponent = __decorate([\r\n    SeDowngradeComponent(),\r\n    Component({\r\n        selector: 'se-restrictions-table',\r\n        template: `<div class=\"se-restriction-table-wrapper se-restriction-table-left\" [ngClass]=\"customClass\"><div class=\"se-restrictions-list fd-menu__list fd-menu__list--separated\" *ngIf=\"restrictions.length > 0\"><div id=\"restriction-{{ index + 1 }}\" *ngFor=\"let restriction of restrictions; let index = index\" class=\"se-restriction__item fd-menu__item\"><div class=\"se-restrictions-list__item-content\"><p class=\"se-restriction__item-name\" [ngClass]=\"{ 'error-input': isInError(index) }\">{{ restriction.name }}</p><div class=\"se-restriction__item-type-and-id\" [ngClass]=\"{ 'error-input': isInError(index) }\">{{ restriction.typeCode }}</div><div class=\"se-restriction__item-description\" [ngClass]=\"{ 'error-input': isInError(index) }\" [title]=\"restriction.description\">{{ restriction.description }}</div><div id=\"restrictionPartOfWorkflow\" *ngIf=\"restriction.canBeEdited!==undefined && !restriction.canBeEdited\" translate=\"se.cms.restrictions.editor.part.of.workflow\"></div></div><div *ngIf=\"editable\"><se-dropdown-menu [dropdownItems]=\"restriction.actions || defaultActions\" [selectedItem]=\"restriction\" [placement]=\"'bottom-start'\"></se-dropdown-menu></div></div></div><div *ngIf=\"restrictions.length === 0\" class=\"se-restrictions-list--empty\"><span class=\"se-restrictions-list--empty__message\" translate=\"se.cms.restrictions.emptylist.message\"></span></div></div>`,\r\n        styles: [`.se-restrictions-list .se-restriction__item{display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-top-color:#eeeeef!important;cursor:default}.se-restrictions-list .se-restriction__item:last-child{margin-bottom:42px}.se-restriction__item-name{font-weight:700;color:#32363a;margin:0}.se-restriction__item-type-and-id{color:#51555a;margin-top:0}.se-restriction__item-description{text-overflow:ellipsis;white-space:initial;overflow:hidden;word-break:break-all;color:#6a6d70;width:90%}.se-restrictions-list--empty__message{color:#6a6d70}.error-input.se-restriction__item-description,.error-input.se-restriction__item-name,.error-input.se-restriction__item-type-and-id{color:#b00}`]\r\n    }),\r\n    __metadata(\"design:paramtypes\", [PageRestrictionsCriteriaService])\r\n], /* @ngInject */ RestrictionsTableComponent);\r\nexport { /* @ngInject */ RestrictionsTableComponent };\r\n//# sourceMappingURL=RestrictionsTableComponent.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@types+lodash@4.14.159/node_modules/@types/lodash/ts3.1/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/pageRestrictions/PageRestrictionsCriteriaService.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/restrictions/types.ts"],"map":"{\"version\":3,\"file\":\"RestrictionsTableComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../src/components/restrictions/components/restrictionsTable/RestrictionsTableComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/restrictions/components/restrictionsTable/RestrictionsTableComponent.d.ts","writeByteOrderMark":false,"text":"import { EventEmitter, OnChanges, OnInit } from '@angular/core';\r\nimport { GenericEditorFieldMessage, IDropdownMenuItem } from 'smarteditcommons';\r\nimport { IPageRestrictionCriteria, PageRestrictionsCriteriaService } from '../../../../services/pageRestrictions/PageRestrictionsCriteriaService';\r\nimport { RestrictionCMSItem } from '../../types';\r\nexport declare class RestrictionsTableComponent implements OnInit, OnChanges {\r\n    private pageRestrictionsCriteriaService;\r\n    restrictions: RestrictionCMSItem[];\r\n    customClass: string;\r\n    editable: boolean;\r\n    restrictionCriteria?: IPageRestrictionCriteria;\r\n    errors?: GenericEditorFieldMessage[];\r\n    onEdit?: EventEmitter<RestrictionCMSItem>;\r\n    onRemove: EventEmitter<number>;\r\n    criteriaOptions: IPageRestrictionCriteria[];\r\n    defaultActions: IDropdownMenuItem[];\r\n    private readonly REMOVE_RESTRICTION_KEY;\r\n    private readonly EDIT_RESTRICTION_KEY;\r\n    private oldRestrictionsEditability;\r\n    constructor(pageRestrictionsCriteriaService: PageRestrictionsCriteriaService);\r\n    ngOnInit(): void;\r\n    ngOnChanges(): void;\r\n    resetRestrictionCriteria(): void;\r\n    removeRestriction(restrictionToRemove: RestrictionCMSItem): void;\r\n    editRestriction(restriction: RestrictionCMSItem): void;\r\n    isInError(index: number): boolean;\r\n    getRestrictionsEditability(restrictions: RestrictionCMSItem[]): boolean[];\r\n    private modifyErrorPositions;\r\n    private removeUnnecessaryError;\r\n    private getDefaultActions;\r\n    private getRestrictionActions;\r\n    private provideActionsForRestrictions;\r\n    private restrictionsEditabilityChanged;\r\n}\r\n"}}
