{"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\r\nimport { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { IPageTreeNodeService, SeDowngradeComponent, LogService, UserTrackingService, USER_TRACKING_FUNCTIONALITY } from 'smarteditcommons';\r\nimport { INTERVAL_RETRIES, INTERVAL_MILLISEC, NodeInfoService } from '../../../services/pageTree/NodeInfoService';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"PageTreeSlot\", {\r\n    selector: 'se-page-tree-slot',\r\n    template: `<div><div class=\"se-page-tree-node\" [ngClass]=\"node.isExpanded && 'se-page-tree-node-expand'\" [attr.node-smartedit-element-uuid]=\"node.elementUuid\"><span (click)=\"onClickSlotNode($event)\" [ngClass]=\"node.isExpanded ?\n                    'sap-icon--navigation-down-arrow' :\n                    'sap-icon--navigation-right-arrow'\" class=\"se-page-tree-node--icon\"></span> <span class=\"se-page-tree-slot-node--name\" (click)=\"onClickSlotNode($event)\">{{node.componentId}}</span><div class=\"se-page-tree-slot-node-menu\"><span class=\"se-page-tree-slot-node-menu--icon sap-icon--chain-link\"></span> <span class=\"se-page-tree-slot-node-menu--icon sap-icon--synchronize\"></span></div></div><div *ngIf=\"node.isExpanded && node.componentNodes.length\"><div *ngFor=\"let child of node.componentNodes\"><se-page-tree-component [component]=\"child\" [slotId]=\"node.componentId\" [slotUuid]=\"node.componentUuid\" [slotElementUuid]=\"node.elementUuid\" (onComponentExpanded)=\"onComponentExpanded($event)\"></se-page-tree-component></div></div></div>`,\r\n    styles: [`.se-page-tree-node{height:48px;display:flex;align-items:center;padding:0 12px;border-bottom:1px solid #f1f1f1;width:100%}.se-page-tree-node-expand{background:#e7f1fa}.se-page-tree-node--icon{font-size:14px;line-height:16px;color:var(--sapContent_IconColor);margin-right:10px}.se-page-tree-slot-node--name{font-family:\"72\";font-size:14px;line-height:16px;color:var(--sapContent_LabelColor);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.se-page-tree-slot-node-menu{margin:0 0 0 auto;min-width:60px}.se-page-tree-slot-node-menu--icon{margin:0 0 0 16px;font-size:14px;line-height:16px;color:var(--sapContent_IconColor)}`]\r\n});\r\nlet /* @ngInject */ PageTreeSlot = class /* @ngInject */ PageTreeSlot {\r\n    constructor(pageTreeNodeService, nodeInfoService, logService, userTrackingService) {\r\n        this.pageTreeNodeService = pageTreeNodeService;\r\n        this.nodeInfoService = nodeInfoService;\r\n        this.logService = logService;\r\n        this.userTrackingService = userTrackingService;\r\n        this.onSlotExpanded = new EventEmitter();\r\n        this.publishSlotInterval = null;\r\n    }\r\n    onClickSlotNode($event) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.userTrackingService.trackingUserAction(USER_TRACKING_FUNCTIONALITY.PAGE_STRUCTURE, 'Slot');\r\n            clearInterval(this.publishSlotInterval);\r\n            this.node.isExpanded = !this.node.isExpanded;\r\n            if (!this.node.isExpanded) {\r\n                this.node.componentNodes.forEach((component) => (component.isExpanded = false));\r\n                this.nodeInfoService.publishSlotSelected(this.node);\r\n            }\r\n            else {\r\n                this.onSlotExpanded.emit(this.node);\r\n                yield this.pageTreeNodeService.scrollToElement(this.node.elementUuid);\r\n                if (!(yield this.checkSlotAndPublishSelected())) {\r\n                    let retries = 0;\r\n                    this.publishSlotInterval = setInterval(() => __awaiter(this, void 0, void 0, function* () {\r\n                        if (yield this.checkSlotAndPublishSelected()) {\r\n                            clearInterval(this.publishSlotInterval);\r\n                        }\r\n                        if (retries > INTERVAL_RETRIES) {\r\n                            this.logService.error(`PageTreeComponent:: onClickSlotNode error: smartedit-element ${this.node.elementUuid} is not existed`);\r\n                            clearInterval(this.publishSlotInterval);\r\n                        }\r\n                        retries++;\r\n                    }), INTERVAL_MILLISEC);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    onComponentExpanded(component) {\r\n        this.node.componentNodes\r\n            .filter((node) => node.elementUuid !== component.elementUuid)\r\n            .forEach((node) => {\r\n            if (node.isExpanded) {\r\n                node.isExpanded = false;\r\n                this.nodeInfoService.publishComponentSelected(node, false, this.node.elementUuid);\r\n            }\r\n        });\r\n    }\r\n    checkSlotAndPublishSelected() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const existedSmartEditElement = yield this.pageTreeNodeService.existedSmartEditElement(this.node.elementUuid);\r\n            if (existedSmartEditElement) {\r\n                this.nodeInfoService.publishSlotSelected(this.node);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    }\r\n};\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", Object)\r\n], /* @ngInject */ PageTreeSlot.prototype, \"node\", void 0);\r\n__decorate([\r\n    Output(),\r\n    __metadata(\"design:type\", EventEmitter)\r\n], /* @ngInject */ PageTreeSlot.prototype, \"onSlotExpanded\", void 0);\r\n/* @ngInject */ PageTreeSlot = __decorate([\r\n    SeDowngradeComponent(),\r\n    Component({\r\n        selector: 'se-page-tree-slot',\r\n        template: `<div><div class=\"se-page-tree-node\" [ngClass]=\"node.isExpanded && 'se-page-tree-node-expand'\" [attr.node-smartedit-element-uuid]=\"node.elementUuid\"><span (click)=\"onClickSlotNode($event)\" [ngClass]=\"node.isExpanded ?\n                    'sap-icon--navigation-down-arrow' :\n                    'sap-icon--navigation-right-arrow'\" class=\"se-page-tree-node--icon\"></span> <span class=\"se-page-tree-slot-node--name\" (click)=\"onClickSlotNode($event)\">{{node.componentId}}</span><div class=\"se-page-tree-slot-node-menu\"><span class=\"se-page-tree-slot-node-menu--icon sap-icon--chain-link\"></span> <span class=\"se-page-tree-slot-node-menu--icon sap-icon--synchronize\"></span></div></div><div *ngIf=\"node.isExpanded && node.componentNodes.length\"><div *ngFor=\"let child of node.componentNodes\"><se-page-tree-component [component]=\"child\" [slotId]=\"node.componentId\" [slotUuid]=\"node.componentUuid\" [slotElementUuid]=\"node.elementUuid\" (onComponentExpanded)=\"onComponentExpanded($event)\"></se-page-tree-component></div></div></div>`,\r\n        styles: [`.se-page-tree-node{height:48px;display:flex;align-items:center;padding:0 12px;border-bottom:1px solid #f1f1f1;width:100%}.se-page-tree-node-expand{background:#e7f1fa}.se-page-tree-node--icon{font-size:14px;line-height:16px;color:var(--sapContent_IconColor);margin-right:10px}.se-page-tree-slot-node--name{font-family:\"72\";font-size:14px;line-height:16px;color:var(--sapContent_LabelColor);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.se-page-tree-slot-node-menu{margin:0 0 0 auto;min-width:60px}.se-page-tree-slot-node-menu--icon{margin:0 0 0 16px;font-size:14px;line-height:16px;color:var(--sapContent_IconColor)}`]\r\n    }),\r\n    __metadata(\"design:paramtypes\", [IPageTreeNodeService,\r\n        NodeInfoService,\r\n        LogService,\r\n        UserTrackingService])\r\n], /* @ngInject */ PageTreeSlot);\r\nexport { /* @ngInject */ PageTreeSlot };\r\n//# sourceMappingURL=PageTreeSlot.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/services/pageTree/NodeInfoService.ts"],"map":"{\"version\":3,\"file\":\"PageTreeSlot.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/components/pageTree/PageTreeSlot/PageTreeSlot.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/pageTree/PageTreeSlot/PageTreeSlot.d.ts","writeByteOrderMark":false,"text":"import { EventEmitter } from '@angular/core';\r\nimport { IPageTreeNodeService, LogService, UserTrackingService } from 'smarteditcommons';\r\nimport { SlotNode, ComponentNode, NodeInfoService } from '../../../services/pageTree/NodeInfoService';\r\nexport declare class PageTreeSlot {\r\n    private readonly pageTreeNodeService;\r\n    private readonly nodeInfoService;\r\n    private readonly logService;\r\n    private readonly userTrackingService;\r\n    node: SlotNode;\r\n    onSlotExpanded: EventEmitter<SlotNode>;\r\n    private publishSlotInterval;\r\n    constructor(pageTreeNodeService: IPageTreeNodeService, nodeInfoService: NodeInfoService, logService: LogService, userTrackingService: UserTrackingService);\r\n    onClickSlotNode($event: Event): Promise<void>;\r\n    onComponentExpanded(component: ComponentNode): void;\r\n    private checkSlotAndPublishSelected;\r\n}\r\n"}}
