{"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\r\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, Input } from '@angular/core';\r\nimport { IPermissionService, SeDowngradeComponent, PageVersionSelectionService, UserTrackingService, USER_TRACKING_FUNCTIONALITY } from 'smarteditcommons';\r\nimport { ManagePageVersionService, RollbackPageVersionService } from '../../../services';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"VersionItemMenuComponent\", {\r\n    selector: 'se-version-item-menu',\r\n    template: `<se-popup-overlay class=\"se-version-item-menu__popup-anchor\" [ngClass]=\"{ 'se-version-item-menu__popup-anchor--open': isMenuOpen }\" [popupOverlay]=\"popupConfig\" [popupOverlayTrigger]=\"isMenuOpen\" (popupOverlayOnHide)=\"hideMenu()\"><div *ngIf=\"menuItems.length > 0\" (click)=\"onButtonClick($event)\" class=\"sap-icon--overflow se-version-item-menu__toggle\"></div><div se-popup-overlay-body class=\"se-version-item-menu fd-menu\"><div class=\"se-version-item-menu__item fd-menu__list\" *ngFor=\"let item of menuItems\" (click)=\"executeItemCallback(item)\"><span class=\"se-version-item-menu__item-link fd-menu__item\">{{ item.i18nKey | translate }}</span></div></div></se-popup-overlay>`,\r\n    styles: [`.se-version-item-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;left:initial!important;right:0;transform:translate(5px,8px);right:-11px;top:-8px}.se-version-item-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:\"\";position:absolute;top:-8px}.se-version-item-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:\"\";position:absolute;top:-7px}.se-version-item-menu::after,.se-version-item-menu::before{right:10px}.se-version-item-menu::after,.se-version-item-menu::before{display:none}.se-version-item-menu__item:last-child .se-version-item-menu__item-link{color:#b00}.se-version-item-menu__popup-anchor{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.1428571429rem;line-height:1.25;font-weight:400}.se-version-item-menu__toggle{height:20px;width:20px;cursor:pointer}.sap-icon--overflow{color:#0a6ed1}`],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n});\r\nlet /* @ngInject */ VersionItemMenuComponent = class /* @ngInject */ VersionItemMenuComponent {\r\n    constructor(managePageVersionService, pageVersionSelectionService, rollbackPageVersionService, permissionService, cdr, userTrackingService) {\r\n        this.managePageVersionService = managePageVersionService;\r\n        this.pageVersionSelectionService = pageVersionSelectionService;\r\n        this.rollbackPageVersionService = rollbackPageVersionService;\r\n        this.permissionService = permissionService;\r\n        this.cdr = cdr;\r\n        this.userTrackingService = userTrackingService;\r\n        this.menuItems = [];\r\n        this.popupConfig = {\r\n            halign: 'left',\r\n            valign: 'bottom'\r\n        };\r\n        this.isMenuOpen = false;\r\n    }\r\n    ngOnInit() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.menuItems = yield this.getPermittedButtons(this.getButtonsConfiguration());\r\n            if (!this.cdr.destroyed) {\r\n                this.cdr.detectChanges();\r\n            }\r\n        });\r\n    }\r\n    onButtonClick(event) {\r\n        event.stopPropagation();\r\n        this.isMenuOpen = !this.isMenuOpen;\r\n    }\r\n    hideMenu() {\r\n        this.isMenuOpen = false;\r\n    }\r\n    executeItemCallback(menuItem) {\r\n        this.userTrackingService.trackingUserAction(USER_TRACKING_FUNCTIONALITY.VERSION_MANAGEMENT, menuItem.i18nKey);\r\n        menuItem.callback(this.item);\r\n        this.hideMenu();\r\n    }\r\n    getPermittedButtons(menuItemsConfig) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const buttonsPermissions = menuItemsConfig.map((menuItem) => this.permissionService.isPermitted([\r\n                {\r\n                    names: menuItem.permissions\r\n                }\r\n            ]));\r\n            const permissions = yield Promise.all(buttonsPermissions);\r\n            return menuItemsConfig.filter((_menuItem, index) => permissions[index]);\r\n        });\r\n    }\r\n    getButtonsConfiguration() {\r\n        return [\r\n            {\r\n                i18nKey: 'se.cms.version.item.menu.view.label',\r\n                callback: (versionItem) => this.viewItemCallback(versionItem),\r\n                permissions: ['se.version.page']\r\n            },\r\n            {\r\n                i18nKey: 'se.cms.version.item.menu.edit.label',\r\n                callback: (versionItem) => this.editItemCallback(versionItem),\r\n                permissions: ['se.edit.version.page']\r\n            },\r\n            {\r\n                i18nKey: 'se.cms.version.item.menu.rollback.label',\r\n                callback: (versionItem) => this.rollbackItemCallback(versionItem),\r\n                permissions: ['se.rollback.version.page.versions.menu']\r\n            },\r\n            {\r\n                i18nKey: 'se.cms.version.item.menu.delete.label',\r\n                callback: (versionItem) => this.deleteItemCallback(versionItem),\r\n                permissions: ['se.delete.version.page']\r\n            }\r\n        ];\r\n    }\r\n    deleteItemCallback(versionItem) {\r\n        this.managePageVersionService.deletePageVersion(versionItem.uid);\r\n    }\r\n    editItemCallback(versionItem) {\r\n        this.managePageVersionService.editPageVersion(versionItem);\r\n    }\r\n    viewItemCallback(versionItem) {\r\n        this.pageVersionSelectionService.selectPageVersion(versionItem);\r\n    }\r\n    rollbackItemCallback(versionItem) {\r\n        this.rollbackPageVersionService.rollbackPageVersion(versionItem);\r\n    }\r\n};\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", Object)\r\n], /* @ngInject */ VersionItemMenuComponent.prototype, \"item\", void 0);\r\n/* @ngInject */ VersionItemMenuComponent = __decorate([\r\n    SeDowngradeComponent(),\r\n    Component({\r\n        selector: 'se-version-item-menu',\r\n        template: `<se-popup-overlay class=\"se-version-item-menu__popup-anchor\" [ngClass]=\"{ 'se-version-item-menu__popup-anchor--open': isMenuOpen }\" [popupOverlay]=\"popupConfig\" [popupOverlayTrigger]=\"isMenuOpen\" (popupOverlayOnHide)=\"hideMenu()\"><div *ngIf=\"menuItems.length > 0\" (click)=\"onButtonClick($event)\" class=\"sap-icon--overflow se-version-item-menu__toggle\"></div><div se-popup-overlay-body class=\"se-version-item-menu fd-menu\"><div class=\"se-version-item-menu__item fd-menu__list\" *ngFor=\"let item of menuItems\" (click)=\"executeItemCallback(item)\"><span class=\"se-version-item-menu__item-link fd-menu__item\">{{ item.i18nKey | translate }}</span></div></div></se-popup-overlay>`,\r\n        styles: [`.se-version-item-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;left:initial!important;right:0;transform:translate(5px,8px);right:-11px;top:-8px}.se-version-item-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:\"\";position:absolute;top:-8px}.se-version-item-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:\"\";position:absolute;top:-7px}.se-version-item-menu::after,.se-version-item-menu::before{right:10px}.se-version-item-menu::after,.se-version-item-menu::before{display:none}.se-version-item-menu__item:last-child .se-version-item-menu__item-link{color:#b00}.se-version-item-menu__popup-anchor{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.1428571429rem;line-height:1.25;font-weight:400}.se-version-item-menu__toggle{height:20px;width:20px;cursor:pointer}.sap-icon--overflow{color:#0a6ed1}`],\r\n        changeDetection: ChangeDetectionStrategy.OnPush\r\n    }),\r\n    __metadata(\"design:paramtypes\", [ManagePageVersionService,\r\n        PageVersionSelectionService,\r\n        RollbackPageVersionService,\r\n        IPermissionService,\r\n        ChangeDetectorRef,\r\n        UserTrackingService])\r\n], /* @ngInject */ VersionItemMenuComponent);\r\nexport { /* @ngInject */ VersionItemMenuComponent };\r\n//# sourceMappingURL=VersionItemMenuComponent.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/src/components/versioning/services/index.ts"],"map":"{\"version\":3,\"file\":\"VersionItemMenuComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../../../src/components/versioning/components/versionsPanel/versionItemMenu/VersionItemMenuComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/cmssmartedit/apps/cms-smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/components/versioning/components/versionsPanel/versionItemMenu/VersionItemMenuComponent.d.ts","writeByteOrderMark":false,"text":"import { ChangeDetectorRef, OnInit } from '@angular/core';\r\nimport { IPermissionService, PopupOverlayConfig, PageVersionSelectionService, IPageVersion, UserTrackingService } from 'smarteditcommons';\r\nimport { ManagePageVersionService, RollbackPageVersionService } from '../../../services';\r\ninterface IButtonConfig {\r\n    i18nKey: string;\r\n    permissions?: string[];\r\n    callback?(versionItem?: IPageVersion): void;\r\n}\r\nexport declare class VersionItemMenuComponent implements OnInit {\r\n    private managePageVersionService;\r\n    private pageVersionSelectionService;\r\n    private rollbackPageVersionService;\r\n    private permissionService;\r\n    private cdr;\r\n    private userTrackingService;\r\n    item: IPageVersion;\r\n    menuItems: IButtonConfig[];\r\n    popupConfig: PopupOverlayConfig;\r\n    isMenuOpen: boolean;\r\n    constructor(managePageVersionService: ManagePageVersionService, pageVersionSelectionService: PageVersionSelectionService, rollbackPageVersionService: RollbackPageVersionService, permissionService: IPermissionService, cdr: ChangeDetectorRef, userTrackingService: UserTrackingService);\r\n    ngOnInit(): Promise<void>;\r\n    onButtonClick(event: MouseEvent): void;\r\n    hideMenu(): void;\r\n    executeItemCallback(menuItem: IButtonConfig): void;\r\n    private getPermittedButtons;\r\n    private getButtonsConfiguration;\r\n    private deleteItemCallback;\r\n    private editItemCallback;\r\n    private viewItemCallback;\r\n    private rollbackItemCallback;\r\n}\r\nexport {};\r\n"}}
