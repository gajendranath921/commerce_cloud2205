{"code":"var PromiseUtils_1;\r\nimport { __awaiter, __decorate } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\n/**\r\n * Copyright (c) 2019 SAP SE or an SAP affiliate company. All rights reserved.\r\n * @module smartutils\r\n */\r\nimport { Injectable } from '@angular/core';\r\nimport * as lodash from 'lodash';\r\nimport { LogService } from '../services/log.service';\r\n/**\r\n * @ngdoc service\r\n * @name @smartutils.services:PromiseUtils\r\n *\r\n * @description\r\n * utility service around ES6 Promises.\r\n */\r\nlet PromiseUtils = PromiseUtils_1 = class PromiseUtils {\r\n    constructor() {\r\n        this.WAIT_TIMEOUT = 4;\r\n        this.FAILURE_TIMEOUT = 2000;\r\n        this.handlePromiseRejections = (promise) => {\r\n            const oldThen = promise.then;\r\n            const defaultFailureCallback = this.defaultFailureCallback;\r\n            // eslint-disable-next-line @typescript-eslint/explicit-function-return-type\r\n            promise.then = function (successCallback, _failureCallback) {\r\n                const failureCallback = _failureCallback ? _failureCallback : defaultFailureCallback;\r\n                return oldThen.call(this, successCallback, failureCallback);\r\n            };\r\n            return promise;\r\n        };\r\n        this.defaultFailureCallback = (error) => {\r\n            if (undefined !== error && null !== error && 'canceled' !== error) {\r\n                if (lodash.isPlainObject(error)) {\r\n                    if (!this.isAjaxError(error)) {\r\n                        PromiseUtils_1.logService.error(`exception caught in promise: ${JSON.stringify(error)}`);\r\n                    }\r\n                }\r\n                else if (!lodash.isBoolean(error)) {\r\n                    PromiseUtils_1.logService.error(error);\r\n                }\r\n            }\r\n            PromiseUtils_1.logService.error(`defaultFailureCallback:`, error);\r\n            return Promise.reject(error);\r\n        };\r\n    }\r\n    toPromise(method, context) {\r\n        return function () {\r\n            try {\r\n                return Promise.resolve(method.apply(context, Array.prototype.slice.call(arguments)));\r\n            }\r\n            catch (e) {\r\n                PromiseUtils_1.logService.error('execution of a method that was turned into a promise failed');\r\n                PromiseUtils_1.logService.error(e);\r\n                return Promise.reject(e);\r\n            }\r\n        };\r\n    }\r\n    promise(executor) {\r\n        return this.handlePromiseRejections(new Promise(executor));\r\n    }\r\n    defer() {\r\n        let pResolve;\r\n        let pReject;\r\n        const deferred = {\r\n            promise: this.promise((_resolve, _reject) => {\r\n                pResolve = _resolve;\r\n                pReject = _reject;\r\n            }),\r\n            resolve(value) {\r\n                pResolve(value);\r\n            },\r\n            reject(reason, silenceError) {\r\n                if (silenceError === undefined) {\r\n                    pReject(reason);\r\n                }\r\n                else {\r\n                    pReject('');\r\n                }\r\n            }\r\n        };\r\n        return deferred;\r\n    }\r\n    sleep(ms) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return new Promise((resolve) => setTimeout(resolve, ms));\r\n        });\r\n    }\r\n    isAjaxError(error) {\r\n        return error.hasOwnProperty('headers');\r\n    }\r\n    waitOnCondition(condition, callback, errorMessage, elapsedTime = 0) {\r\n        setTimeout(() => {\r\n            if (condition()) {\r\n                callback();\r\n            }\r\n            else if (elapsedTime < this.FAILURE_TIMEOUT) {\r\n                this.waitOnCondition(condition, callback, errorMessage, elapsedTime + this.WAIT_TIMEOUT);\r\n            }\r\n            else {\r\n                throw new Error(`PromiseUtils: ${errorMessage}`);\r\n            }\r\n        }, this.WAIT_TIMEOUT);\r\n    }\r\n    resolveToCallbackWhenCondition(condition, callback, errorMessage) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return new Promise((resolve) => {\r\n                this.waitOnCondition(condition, () => resolve(callback()), errorMessage ? errorMessage : 'condition for promise resolution was never met');\r\n            });\r\n        });\r\n    }\r\n    attempt(promise) {\r\n        return promise\r\n            .then((data) => ({\r\n            error: null,\r\n            data\r\n        }))\r\n            .catch((error) => ({\r\n            error,\r\n            data: null\r\n        }));\r\n    }\r\n};\r\nPromiseUtils.logService = new LogService();\r\nPromiseUtils = PromiseUtils_1 = __decorate([\r\n    Injectable()\r\n], PromiseUtils);\r\nexport { PromiseUtils };\r\nexport const promiseUtils = new PromiseUtils();\r\n//# sourceMappingURL=promise-utils.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@types+lodash@4.14.159/node_modules/@types/lodash/ts3.1/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smart-utils/src/services/log.service.ts"],"map":"{\"version\":3,\"file\":\"promise-utils.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/utils/promise-utils.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smart-utils/node_modules/.cache/rollup-plugin-typescript2/placeholder/utils/promise-utils.d.ts","writeByteOrderMark":false,"text":"import { LogService } from '../services/log.service';\r\nexport interface Deferred<T> {\r\n    promise: Promise<T>;\r\n    resolve: (value?: T) => void;\r\n    reject: (value?: any, silenceError?: boolean) => void;\r\n}\r\n/**\r\n * @ngdoc service\r\n * @name @smartutils.services:PromiseUtils\r\n *\r\n * @description\r\n * utility service around ES6 Promises.\r\n */\r\nexport declare class PromiseUtils {\r\n    static logService: LogService;\r\n    private WAIT_TIMEOUT;\r\n    private FAILURE_TIMEOUT;\r\n    toPromise<T>(method: (...args: any[]) => T, context?: any): (...innerArgs: any[]) => Promise<T>;\r\n    promise<T>(executor: (resolve: (value?: T | PromiseLike<T>) => void, reject: (reason?: any, silenceError?: boolean) => void) => void): Promise<T>;\r\n    defer<T>(): Deferred<T>;\r\n    sleep(ms: number): Promise<any>;\r\n    handlePromiseRejections: <T>(promise: Promise<T>) => Promise<T>;\r\n    isAjaxError(error: any): boolean;\r\n    waitOnCondition(condition: () => boolean, callback: () => any, errorMessage: string, elapsedTime?: number): void;\r\n    resolveToCallbackWhenCondition<T>(condition: () => boolean, callback: () => T, errorMessage?: string): Promise<T>;\r\n    attempt<T>(promise: Promise<T>): Promise<{\r\n        error: any;\r\n        data: T;\r\n    }>;\r\n    private defaultFailureCallback;\r\n}\r\nexport declare const promiseUtils: PromiseUtils;\r\n"}}
