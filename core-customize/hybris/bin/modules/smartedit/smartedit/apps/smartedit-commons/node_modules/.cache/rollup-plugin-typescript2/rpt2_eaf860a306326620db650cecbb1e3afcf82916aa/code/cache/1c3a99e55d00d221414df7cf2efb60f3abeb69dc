{"code":"import { __awaiter, __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { ISettingsService, LogService } from '@smart/utils';\r\nimport { SeDowngradeService } from '../di';\r\nimport { WindowUtils, USER_TRACKING_KEY_MAP } from '../utils';\r\nlet /* @ngInject */ UserTrackingService = class /* @ngInject */ UserTrackingService {\r\n    constructor(windowUtils, settingService, logService) {\r\n        this.windowUtils = windowUtils;\r\n        this.settingService = settingService;\r\n        this.logService = logService;\r\n        this.CUSTOMER_KEY = 'modelt.customer.code';\r\n        this.PROJECT_KEY = 'modelt.project.code';\r\n        this.ENVIRONMENT_KEY = 'modelt.environment.code';\r\n        this.TRACKING_URL_KEY = 'smartedit.click.tracking.server.url';\r\n        this.DEFAULT_CUSTOMER = 'localCustomer';\r\n        this.DEFAULT_PROJECT = 'localProject';\r\n        this.DEFAULT_ENVIRONMENT = 'localEnvironment';\r\n        this.DEFAULT_TRACKING_URL = 'https://license.hybris.com/collect';\r\n        this.isInitialized = false;\r\n    }\r\n    initConfiguration() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const isTrackingEnabled = yield this.settingService.getBoolean('smartedit.default.click.tracking.enabled');\r\n            if (!isTrackingEnabled) {\r\n                this.isInitialized = false;\r\n                return;\r\n            }\r\n            if (this.isEnvInitialized()) {\r\n                const siteId = yield this.getSiteId();\r\n                let trackingUrl = yield this.settingService.get(this.TRACKING_URL_KEY);\r\n                trackingUrl = trackingUrl !== undefined ? trackingUrl : this.DEFAULT_TRACKING_URL;\r\n                this._paq.push(['setTrackerUrl', trackingUrl]);\r\n                this._paq.push(['setSiteId', siteId]);\r\n                this.isInitialized = true;\r\n            }\r\n            else {\r\n                this.isInitialized = false;\r\n                this.logService.warn('User tracking is enabled and tracking tool is not initialized.');\r\n            }\r\n        });\r\n    }\r\n    trackingUserAction(functionality, key) {\r\n        if (this.isInitialized) {\r\n            if (USER_TRACKING_KEY_MAP.has(key)) {\r\n                key = USER_TRACKING_KEY_MAP.get(key);\r\n            }\r\n            this._paq.push(['trackEvent', 'SmartEdit', functionality, key]);\r\n        }\r\n    }\r\n    // Check if tracking library piwik is loaded\r\n    isEnvInitialized() {\r\n        this._paq = this.windowUtils.getWindow()._paq;\r\n        return this._paq === undefined ? false : this._paq.push !== undefined;\r\n    }\r\n    getSiteId() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let customerCode = yield this.settingService.get(this.CUSTOMER_KEY);\r\n            customerCode = customerCode !== undefined ? customerCode : this.DEFAULT_CUSTOMER;\r\n            let projectCode = yield this.settingService.get(this.PROJECT_KEY);\r\n            projectCode = projectCode !== undefined ? projectCode : this.DEFAULT_PROJECT;\r\n            let environmentCode = yield this.settingService.get(this.ENVIRONMENT_KEY);\r\n            environmentCode =\r\n                environmentCode !== undefined ? environmentCode : this.DEFAULT_ENVIRONMENT;\r\n            return `${customerCode}-${projectCode}-${environmentCode}`;\r\n        });\r\n    }\r\n};\r\n/* @ngInject */ UserTrackingService = __decorate([\r\n    SeDowngradeService(),\r\n    __metadata(\"design:paramtypes\", [WindowUtils,\r\n        ISettingsService,\r\n        LogService])\r\n], /* @ngInject */ UserTrackingService);\r\nexport { /* @ngInject */ UserTrackingService };\r\n//# sourceMappingURL=UserTrackingService.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smart-utils/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/di/index.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/utils/index.ts"],"map":"{\"version\":3,\"file\":\"UserTrackingService.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/services/UserTrackingService.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/node_modules/.cache/rollup-plugin-typescript2/placeholder/services/UserTrackingService.d.ts","writeByteOrderMark":false,"text":"import { ISettingsService, LogService } from '@smart/utils';\r\nimport { WindowUtils } from '../utils';\r\nexport declare class UserTrackingService {\r\n    private readonly windowUtils;\r\n    private readonly settingService;\r\n    private readonly logService;\r\n    readonly CUSTOMER_KEY = \"modelt.customer.code\";\r\n    readonly PROJECT_KEY = \"modelt.project.code\";\r\n    readonly ENVIRONMENT_KEY = \"modelt.environment.code\";\r\n    readonly TRACKING_URL_KEY = \"smartedit.click.tracking.server.url\";\r\n    readonly DEFAULT_CUSTOMER = \"localCustomer\";\r\n    readonly DEFAULT_PROJECT = \"localProject\";\r\n    readonly DEFAULT_ENVIRONMENT = \"localEnvironment\";\r\n    readonly DEFAULT_TRACKING_URL = \"https://license.hybris.com/collect\";\r\n    isInitialized: boolean;\r\n    private _paq;\r\n    constructor(windowUtils: WindowUtils, settingService: ISettingsService, logService: LogService);\r\n    initConfiguration(): Promise<void>;\r\n    trackingUserAction(functionality: string, key: string): void;\r\n    private isEnvInitialized;\r\n    private getSiteId;\r\n}\r\n"}}
