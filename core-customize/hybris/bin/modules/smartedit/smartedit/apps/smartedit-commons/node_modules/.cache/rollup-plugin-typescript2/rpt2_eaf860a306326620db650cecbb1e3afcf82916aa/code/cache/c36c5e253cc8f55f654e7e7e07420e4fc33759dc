{"code":"var /* @ngInject */ WindowUtils_1;\r\nimport { __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { NgZone } from '@angular/core';\r\nimport { annotationService, functionsUtils, urlUtils, WindowUtils as ParentWindowUtils } from '@smart/utils';\r\nimport * as lodash from 'lodash';\r\nimport { SeDowngradeService } from 'smarteditcommons/di/SeDowngradeService';\r\n/* forbiddenNameSpaces window._:false */\r\nwindow.__smartedit__ = window.__smartedit__ || {};\r\nfunction getDecoratorKey(className, decoratorName) {\r\n    return `${className}-${decoratorName}:definition`;\r\n}\r\nlodash.merge(window.__smartedit__, {\r\n    modules: {},\r\n    pushedModules: [],\r\n    smarteditDecoratorPayloads: {},\r\n    addDecoratorPayload(decorator, className, payload) {\r\n        const key = getDecoratorKey(decorator, className);\r\n        if (window.__smartedit__.smarteditDecoratorPayloads[key]) {\r\n            throw new Error('Duplicate class/decorator pair');\r\n        }\r\n        window.__smartedit__.smarteditDecoratorPayloads[key] = payload;\r\n    },\r\n    getDecoratorPayload(decorator, myConstructor) {\r\n        const className = functionsUtils.getConstructorName(annotationService.getOriginalConstructor(myConstructor));\r\n        return window.__smartedit__.smarteditDecoratorPayloads[getDecoratorKey(decorator, className)];\r\n    },\r\n    getComponentDecoratorPayload(className) {\r\n        return window.__smartedit__.smarteditDecoratorPayloads[getDecoratorKey('Component', className)];\r\n    },\r\n    downgradedService: {}\r\n});\r\n/**\r\n * Add here a spread of modules containing invocations of HttpBackendService to mocks some calls to the backend\r\n */\r\nwindow.pushModules = (...modules) => {\r\n    window.__smartedit__.pushedModules = window.__smartedit__.pushedModules.concat(modules);\r\n};\r\n/**\r\n * A collection of utility methods for windows.\r\n */\r\nlet /* @ngInject */ WindowUtils = /* @ngInject */ WindowUtils_1 = class /* @ngInject */ WindowUtils extends ParentWindowUtils {\r\n    constructor(ngZone) {\r\n        super(ngZone);\r\n        /**\r\n         * Given the current frame, retrieves the target frame for gateway purposes\r\n         *\r\n         * @returns The content window or null if it does not exists.\r\n         */\r\n        this.getGatewayTargetFrame = () => {\r\n            /*\r\n             * For below if-else condition, original code won't work if smartedit is running\r\n             * under environment of cypress for testing purpose, so condition to check against cypress environment is added\r\n             * See jira ticket for details: https://jira.tools.sap/browse/CXEC-7344 & 9335\r\n             */\r\n            if (this.isInCypressIframe()) {\r\n                if (this.getSmarteditIframeFromParent()) {\r\n                    return this.getWindow().parent;\r\n                }\r\n                else if (this.getSmarteditIframeFromWindow()) {\r\n                    return this.getWindow().document.getElementById(/* @ngInject */ WindowUtils_1.SMARTEDIT_IFRAME_ID).contentWindow;\r\n                }\r\n            }\r\n            else {\r\n                if (this.isIframe()) {\r\n                    return this.getWindow().parent;\r\n                }\r\n                else if (this.getSmarteditIframeFromWindow()) {\r\n                    return this.getWindow().document.getElementById(/* @ngInject */ WindowUtils_1.SMARTEDIT_IFRAME_ID).contentWindow;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n    }\r\n    getSmarteditIframeFromWindow() {\r\n        return this.getWindow().document.getElementById(/* @ngInject */ WindowUtils_1.SMARTEDIT_IFRAME_ID);\r\n    }\r\n    isInCypressIframe() {\r\n        try {\r\n            return (this.getWindow().top.document.querySelector('iframe') &&\r\n                this.getWindow()\r\n                    .top.document.querySelector('iframe')\r\n                    .id.includes(/* @ngInject */ WindowUtils_1.CYPRESS_IFRSME_ID));\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    }\r\n    getSmarteditIframe() {\r\n        return document.querySelector('iframe#' + /* @ngInject */ WindowUtils_1.SMARTEDIT_IFRAME_ID);\r\n    }\r\n    getSmarteditIframeFromParent() {\r\n        return this.getWindow().parent.document.querySelector('iframe#' + /* @ngInject */ WindowUtils_1.SMARTEDIT_IFRAME_ID);\r\n    }\r\n    getIframe() {\r\n        return document.querySelector('iframe');\r\n    }\r\n    setTrustedIframeDomain(trustedIframeSource) {\r\n        this.trustedIframeDomain = urlUtils.getOrigin(trustedIframeSource);\r\n    }\r\n    getTrustedIframeDomain() {\r\n        return this.trustedIframeDomain;\r\n    }\r\n    isCrossOrigin(location) {\r\n        return urlUtils.getOrigin() !== urlUtils.getOrigin(location);\r\n    }\r\n    /**\r\n     * Will call the javascrit's native setTimeout method to execute a given function after a specified period of time.\r\n     * This method is better than using $timeout since it is difficult to assert on $timeout during end-to-end testing.\r\n     *\r\n     * @param func function that needs to be executed after the specified duration.\r\n     * @param duration time in milliseconds.\r\n     */\r\n    customTimeout(func, duration) {\r\n        setTimeout(function () {\r\n            func();\r\n        }, duration);\r\n    }\r\n};\r\n/* @ngInject */ WindowUtils.SMARTEDIT_IFRAME_ID = 'ySmartEditFrame';\r\n/* @ngInject */ WindowUtils.CYPRESS_IFRSME_ID = 'Your App';\r\n/* @ngInject */ WindowUtils = /* @ngInject */ WindowUtils_1 = __decorate([\r\n    SeDowngradeService(),\r\n    __metadata(\"design:paramtypes\", [NgZone])\r\n], /* @ngInject */ WindowUtils);\r\nexport { /* @ngInject */ WindowUtils };\r\nexport const windowUtils = new WindowUtils();\r\nexport { ParentWindowUtils };\r\n//# sourceMappingURL=WindowUtils.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smart-utils/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@types+angular@1.7.3/node_modules/@types/angular/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@types+lodash@4.14.159/node_modules/@types/lodash/ts3.1/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/di/SeDowngradeService.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/di/types.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/services/index.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/dtos/index.ts"],"map":"{\"version\":3,\"file\":\"WindowUtils.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/utils/WindowUtils.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/node_modules/.cache/rollup-plugin-typescript2/placeholder/utils/WindowUtils.d.ts","writeByteOrderMark":false,"text":"/// <reference types=\"angular-mocks\" />\r\nimport { NgModule, NgZone } from '@angular/core';\r\nimport { WindowUtils as ParentWindowUtils } from '@smart/utils';\r\nimport * as angular from 'angular';\r\nimport * as lodash from 'lodash';\r\nimport { SeConstructor, SeFactory } from 'smarteditcommons/di/types';\r\nimport { YJQuery } from 'smarteditcommons/services';\r\nimport { TypedMap } from '../dtos';\r\ndeclare global {\r\n    interface InternalSmartedit {\r\n        modules: TypedMap<NgModule>;\r\n        pushedModules: NgModule[];\r\n        smarteditDecoratorPayloads: TypedMap<any>;\r\n        addDecoratorPayload: (className: string, decoratorName: string, payload: any) => void;\r\n        getDecoratorPayload: (decorator: string, myConstructor: SeConstructor) => any;\r\n        getComponentDecoratorPayload: (className: string) => {\r\n            selector: string;\r\n            template: string;\r\n        };\r\n        downgradedService: TypedMap<SeConstructor>;\r\n        smartEditContainerAngularApps: string[];\r\n        smartEditInnerAngularApps: string[];\r\n    }\r\n    interface Window {\r\n        Zone: any;\r\n        angular: angular.IAngularStatic;\r\n        CKEDITOR: any;\r\n        _paq: any;\r\n        smarteditLodash: lodash.LoDashStatic;\r\n        smarteditJQuery: YJQuery;\r\n        __karma__: any;\r\n        __smartedit__: InternalSmartedit;\r\n        pushModules(...modules: any[]): void;\r\n    }\r\n}\r\n/**\r\n * A collection of utility methods for windows.\r\n */\r\nexport declare class WindowUtils extends ParentWindowUtils {\r\n    static SMARTEDIT_IFRAME_ID: string;\r\n    static CYPRESS_IFRSME_ID: string;\r\n    private trustedIframeDomain;\r\n    constructor(ngZone?: NgZone);\r\n    /**\r\n     * Given the current frame, retrieves the target frame for gateway purposes\r\n     *\r\n     * @returns The content window or null if it does not exists.\r\n     */\r\n    getGatewayTargetFrame: () => Window;\r\n    getSmarteditIframeFromWindow(): HTMLElement;\r\n    isInCypressIframe(): boolean;\r\n    getSmarteditIframe(): HTMLElement;\r\n    getSmarteditIframeFromParent(): HTMLElement;\r\n    getIframe(): HTMLElement;\r\n    setTrustedIframeDomain(trustedIframeSource: string): void;\r\n    getTrustedIframeDomain(): string;\r\n    isCrossOrigin(location: string): boolean;\r\n    /**\r\n     * Will call the javascrit's native setTimeout method to execute a given function after a specified period of time.\r\n     * This method is better than using $timeout since it is difficult to assert on $timeout during end-to-end testing.\r\n     *\r\n     * @param func function that needs to be executed after the specified duration.\r\n     * @param duration time in milliseconds.\r\n     */\r\n    customTimeout(func: SeFactory, duration: number): void;\r\n}\r\nexport declare const windowUtils: WindowUtils;\r\nexport { ParentWindowUtils };\r\n"}}
