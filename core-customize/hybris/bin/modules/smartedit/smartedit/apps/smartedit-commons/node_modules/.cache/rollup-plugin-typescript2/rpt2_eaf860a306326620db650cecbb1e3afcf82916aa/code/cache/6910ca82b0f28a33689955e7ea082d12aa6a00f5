{"code":"import { __decorate, __metadata, __param } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { Inject, Optional } from '@angular/core';\r\nimport { NavigationEnd, NavigationError, NavigationStart, Router } from '@angular/router';\r\nimport { UpgradeModule } from '@angular/upgrade/static';\r\nimport { LogService } from '@smart/utils';\r\nimport { ReplaySubject } from 'rxjs';\r\nimport { filter, map } from 'rxjs/operators';\r\nimport { SeDowngradeService } from '../../di';\r\nimport { CustomHandlingStrategy } from '../CustomHandlingStrategy';\r\nimport { NavigationEventSource } from './types';\r\n/**\r\n * A service that provides navigation and URL manipulation capabilities.\r\n * It is a reliant source of information on routing state in Smartedit.\r\n */\r\nlet /* @ngInject */ SmarteditRoutingService = class /* @ngInject */ SmarteditRoutingService {\r\n    constructor(router, document, logService, upgrade) {\r\n        this.router = router;\r\n        this.document = document;\r\n        this.logService = logService;\r\n        this.upgrade = upgrade;\r\n        this.listenersInitialized = false;\r\n        this.routeChangeError$ = new ReplaySubject();\r\n        this.routeChangeStart$ = new ReplaySubject();\r\n        this.routeChangeSuccess$ = new ReplaySubject();\r\n        this.previousRouterUrl = '';\r\n    }\r\n    /**\r\n     *  Initializes listeners for navigation events.\r\n     */\r\n    init() {\r\n        if (!this.listenersInitialized) {\r\n            this.notifyOnAngularRouteEvents();\r\n            this.notifyOnAngularJSRouteEvents();\r\n            this.listenersInitialized = true;\r\n        }\r\n    }\r\n    /** Navigates based on the provided URL (absolute). */\r\n    go(url) {\r\n        return this.router.navigateByUrl(url);\r\n    }\r\n    /** Returns the current router URL. */\r\n    path() {\r\n        return this.router.url;\r\n    }\r\n    /** Returns absolute URL. */\r\n    absUrl() {\r\n        return this.document.location.href;\r\n    }\r\n    /** Notifies when the route change has started. */\r\n    routeChangeStart() {\r\n        this.warnAboutListenersNotInitialized();\r\n        return this.routeChangeStart$.pipe(filter((event) => !!event.url && event.url !== this.previousRouterUrl), map((event) => event.routeData));\r\n    }\r\n    /** Notifies when the route change has ended. */\r\n    routeChangeSuccess() {\r\n        this.warnAboutListenersNotInitialized();\r\n        return this.routeChangeSuccess$.pipe(filter((event) => !!event.url && event.url !== this.previousRouterUrl), map((event) => event.routeData));\r\n    }\r\n    /** Notifies when the route change has failed. */\r\n    routeChangeError() {\r\n        this.warnAboutListenersNotInitialized();\r\n        return this.routeChangeError$.pipe(map((event) => event.routeData));\r\n    }\r\n    /** Reloads the given URL. If not provided, it will reload the current URL. */\r\n    reload(url = this.router.url) {\r\n        return this.router\r\n            .navigateByUrl('/', { skipLocationChange: true })\r\n            .then(() => this.router.navigateByUrl(url));\r\n    }\r\n    /**\r\n     * Extracts `url` from Angular router event or `current.originalPath` from AngularJS event\r\n     */\r\n    getCurrentUrlFromEvent(event) {\r\n        if (event instanceof NavigationStart ||\r\n            event instanceof NavigationEnd ||\r\n            event instanceof NavigationError) {\r\n            return event.url;\r\n        }\r\n        return event && event.current && event.current.originalPath;\r\n    }\r\n    /**\r\n     * @internal\r\n     * @ignore\r\n     */\r\n    warnAboutListenersNotInitialized() {\r\n        if (!this.listenersInitialized) {\r\n            this.logService.warn('Listeners not initialized, run `init()` first.');\r\n        }\r\n    }\r\n    /**\r\n     * @internal\r\n     * @ignore\r\n     */\r\n    notifyOnAngularRouteEvents() {\r\n        this.router.events.subscribe((event) => {\r\n            // For some reason CustomHandlingStrategy.shouldProcessUrl is called twice\r\n            // when switching from NG route to AJS route e.g.: /ng -> /pages/...\r\n            // it's get called with /pages/... and then suddenly with /ng\r\n            // however event.url is /pages/... and not /ng\r\n            // That's why it has to do another check for ng prefix in route\r\n            // to avoid duplicated events\r\n            if (event && event.url && !CustomHandlingStrategy.isNgRoute(event.url)) {\r\n                return;\r\n            }\r\n            switch (true) {\r\n                case event instanceof NavigationStart: {\r\n                    this.routeChangeStart$.next({\r\n                        from: NavigationEventSource.NG,\r\n                        url: event.url,\r\n                        routeData: event\r\n                    });\r\n                    break;\r\n                }\r\n                case event instanceof NavigationError: {\r\n                    this.routeChangeError$.next({\r\n                        from: NavigationEventSource.NG,\r\n                        url: event.url,\r\n                        routeData: event\r\n                    });\r\n                    break;\r\n                }\r\n                case event instanceof NavigationEnd: {\r\n                    this.routeChangeSuccess$.next({\r\n                        from: NavigationEventSource.NG,\r\n                        url: event.url,\r\n                        routeData: event\r\n                    });\r\n                    this.previousRouterUrl = event && event.url;\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * @internal\r\n     * @ignore\r\n     */\r\n    notifyOnAngularJSRouteEvents() {\r\n        const rootScope = '$rootScope';\r\n        this.upgrade.$injector\r\n            .get(rootScope)\r\n            .$on('$routeChangeSuccess', (event, current, previous) => {\r\n            this.routeChangeSuccess$.next({\r\n                from: NavigationEventSource.AJS,\r\n                url: current && current.originalPath,\r\n                routeData: { event, current, previous }\r\n            });\r\n            this.previousRouterUrl = current && current.originalPath;\r\n        });\r\n        this.upgrade.$injector\r\n            .get(rootScope)\r\n            .$on('$routeChangeError', (event, current, previous, rejection) => {\r\n            this.routeChangeError$.next({\r\n                from: NavigationEventSource.AJS,\r\n                url: current && current.originalPath,\r\n                routeData: { event, current, previous, rejection }\r\n            });\r\n        });\r\n        this.upgrade.$injector\r\n            .get(rootScope)\r\n            .$on('$routeChangeStart', (event, next, current) => {\r\n            this.routeChangeStart$.next({\r\n                from: NavigationEventSource.AJS,\r\n                url: next && next.originalPath,\r\n                routeData: { event, next, current }\r\n            });\r\n        });\r\n    }\r\n};\r\n/* @ngInject */ SmarteditRoutingService = __decorate([\r\n    SeDowngradeService(),\r\n    __param(0, Optional()),\r\n    __param(1, Inject(DOCUMENT)),\r\n    __metadata(\"design:paramtypes\", [Router,\r\n        Document,\r\n        LogService,\r\n        UpgradeModule])\r\n], /* @ngInject */ SmarteditRoutingService);\r\nexport { /* @ngInject */ SmarteditRoutingService };\r\n//# sourceMappingURL=SmarteditRoutingService.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+common@8.2.14_@angular+core@8.2.14+rxjs@6.5.4/node_modules/@angular/common/common.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+router@8.2.14_e9fbe5720e9434eb9ae0f6720f1ca3f4/node_modules/@angular/router/router.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+upgrade@8.2.14_d2ff5303d1bb22207cb4aaa9bb380a83/node_modules/@angular/upgrade/static.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smart-utils/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@types+angular@1.7.3/node_modules/@types/angular/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/rxjs@6.5.4/node_modules/rxjs/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/rxjs@6.5.4/node_modules/rxjs/operators/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/di/index.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/services/CustomHandlingStrategy.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/src/services/routing/types.ts"],"map":"{\"version\":3,\"file\":\"SmarteditRoutingService.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/services/routing/SmarteditRoutingService.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/node_modules/.cache/rollup-plugin-typescript2/placeholder/services/routing/SmarteditRoutingService.d.ts","writeByteOrderMark":false,"text":"import { Router } from '@angular/router';\r\nimport { UpgradeModule } from '@angular/upgrade/static';\r\nimport { LogService } from '@smart/utils';\r\nimport { Observable } from 'rxjs';\r\nimport { RouteNavigationEnd, RouteNavigationError, RouteNavigationStart } from './types';\r\n/**\r\n * A service that provides navigation and URL manipulation capabilities.\r\n * It is a reliant source of information on routing state in Smartedit.\r\n */\r\nexport declare class SmarteditRoutingService {\r\n    private readonly router;\r\n    private readonly document;\r\n    private readonly logService;\r\n    private readonly upgrade;\r\n    private listenersInitialized;\r\n    private readonly routeChangeError$;\r\n    private readonly routeChangeStart$;\r\n    private readonly routeChangeSuccess$;\r\n    private previousRouterUrl;\r\n    constructor(router: Router, document: Document, logService: LogService, upgrade: UpgradeModule);\r\n    /**\r\n     *  Initializes listeners for navigation events.\r\n     */\r\n    init(): void;\r\n    /** Navigates based on the provided URL (absolute). */\r\n    go(url: string): Promise<boolean>;\r\n    /** Returns the current router URL. */\r\n    path(): string;\r\n    /** Returns absolute URL. */\r\n    absUrl(): string;\r\n    /** Notifies when the route change has started. */\r\n    routeChangeStart(): Observable<RouteNavigationStart>;\r\n    /** Notifies when the route change has ended. */\r\n    routeChangeSuccess(): Observable<RouteNavigationEnd>;\r\n    /** Notifies when the route change has failed. */\r\n    routeChangeError(): Observable<RouteNavigationError>;\r\n    /** Reloads the given URL. If not provided, it will reload the current URL. */\r\n    reload(url?: string): Promise<boolean>;\r\n    /**\r\n     * Extracts `url` from Angular router event or `current.originalPath` from AngularJS event\r\n     */\r\n    getCurrentUrlFromEvent(event: RouteNavigationEnd | RouteNavigationError | RouteNavigationStart): string | null;\r\n    /**\r\n     * @internal\r\n     * @ignore\r\n     */\r\n    private warnAboutListenersNotInitialized;\r\n    /**\r\n     * @internal\r\n     * @ignore\r\n     */\r\n    private notifyOnAngularRouteEvents;\r\n    /**\r\n     * @internal\r\n     * @ignore\r\n     */\r\n    private notifyOnAngularJSRouteEvents;\r\n}\r\n"}}
