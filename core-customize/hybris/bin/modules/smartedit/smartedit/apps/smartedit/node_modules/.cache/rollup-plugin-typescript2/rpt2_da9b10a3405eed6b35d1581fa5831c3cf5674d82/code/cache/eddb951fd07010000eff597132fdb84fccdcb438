{"code":"import { __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { Component, ElementRef, Input } from '@angular/core';\r\nimport { CrossFrameEventService, ELEMENT_UUID_ATTRIBUTE, EVENT_PERSPECTIVE_CHANGED, EVENT_PERSPECTIVE_REFRESHED, EVENT_SMARTEDIT_COMPONENT_UPDATED, PolyfillService, SeCustomComponent, SystemEventService, SMARTEDIT_DRAG_AND_DROP_EVENTS } from 'smarteditcommons';\r\nimport { SakExecutorService } from './SakExecutorService';\r\nconst smarteditElementComponentSelector = 'smartedit-element';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"SmarteditElementComponent\", {\r\n    selector: smarteditElementComponentSelector,\r\n    template: ` <div id=\"projectedContent\"><ng-content></ng-content></div> `\r\n});\r\nlet SmarteditElementComponent = class SmarteditElementComponent {\r\n    constructor(elementRef, sakExecutorService, systemEventService, crossFrameEventService, polyfillService) {\r\n        this.elementRef = elementRef;\r\n        this.sakExecutorService = sakExecutorService;\r\n        this.systemEventService = systemEventService;\r\n        this.crossFrameEventService = crossFrameEventService;\r\n        this.polyfillService = polyfillService;\r\n        this.active = false;\r\n        this.componentDecoratorEnabled = true;\r\n        this.removeDecorators = () => {\r\n            // removing previous content of placeHolder\r\n            if (this.bundle && this.element.contains(this.bundle)) {\r\n                this.element.removeChild(this.bundle);\r\n            }\r\n            this.bundle = this.projectedContent;\r\n            this.element.appendChild(this.bundle);\r\n        };\r\n        this.appendDecorators = () => {\r\n            // removing previous content of placeHolder\r\n            if (this.bundle && this.element.contains(this.bundle)) {\r\n                this.element.removeChild(this.bundle);\r\n            }\r\n            this.sakExecutorService\r\n                .wrapDecorators(this.projectedContent, this.element)\r\n                .then((bundle) => {\r\n                this.bundle = bundle;\r\n                this.element.appendChild(this.bundle);\r\n            });\r\n        };\r\n        this.propagateActiveStateToChildren = () => {\r\n            this.element.querySelectorAll('[active]').forEach((element) => {\r\n                if (this.uuid === this.getUuid(element)) {\r\n                    element.setAttribute('active', this.active + '');\r\n                }\r\n            });\r\n        };\r\n    }\r\n    ngOnInit() {\r\n        const projectedContentWrapper = this.element.querySelector('#projectedContent');\r\n        this.projectedContent = projectedContentWrapper.children[0];\r\n        this.element.removeChild(projectedContentWrapper);\r\n        this.appendDecorators();\r\n    }\r\n    ngAfterViewInit() {\r\n        this.mousenterListener = (event) => {\r\n            if (!this.active) {\r\n                this.active = this.componentDecoratorEnabled;\r\n                this.propagateActiveStateToChildren();\r\n            }\r\n        };\r\n        this.mouseleaveListener = (event) => {\r\n            if (this.active) {\r\n                this.active = false;\r\n                this.propagateActiveStateToChildren();\r\n            }\r\n        };\r\n        // Register Event Listeners\r\n        this.element.addEventListener('mouseenter', this.mousenterListener);\r\n        this.element.addEventListener('mouseleave', this.mouseleaveListener);\r\n        this.unregisterPerspectiveChangeEvent = this.crossFrameEventService.subscribe(EVENT_PERSPECTIVE_CHANGED, (eventId, notPreview) => {\r\n            notPreview && this.appendDecorators();\r\n        });\r\n        this.unregisterPerspectiveRefreshedEvent = this.crossFrameEventService.subscribe(EVENT_PERSPECTIVE_REFRESHED, (eventId, notPreview) => {\r\n            notPreview && this.appendDecorators();\r\n        });\r\n        this.unregisterComponentUpdatedEvent = this.crossFrameEventService.subscribe(EVENT_SMARTEDIT_COMPONENT_UPDATED, this.onComponentUpdated.bind(this));\r\n        // we can't listen to these events in the controller because they could be sent before the component compilation.\r\n        this.unregisterDnDStart = this.systemEventService.subscribe(SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_START, (eventId, smarteditComponentClosestToDraggedElement) => {\r\n            if (this.polyfillService.isEligibleForEconomyMode() &&\r\n                smarteditComponentClosestToDraggedElement &&\r\n                this.uuid ===\r\n                    smarteditComponentClosestToDraggedElement.attr(ELEMENT_UUID_ATTRIBUTE)) {\r\n                this.componentDecoratorEnabled = false;\r\n                this.removeDecorators();\r\n            }\r\n        });\r\n        this.unregisterDnDEnd = this.systemEventService.subscribe(SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_END, () => {\r\n            if (this.polyfillService.isEligibleForEconomyMode()) {\r\n                this.componentDecoratorEnabled = true;\r\n                this.appendDecorators();\r\n            }\r\n        });\r\n    }\r\n    ngOnDestroy() {\r\n        this.removeDecorators();\r\n        this.unregisterPerspectiveChangeEvent();\r\n        this.unregisterPerspectiveRefreshedEvent();\r\n        this.unregisterComponentUpdatedEvent();\r\n        this.unregisterDnDEnd();\r\n        this.unregisterDnDStart();\r\n        this.element.removeEventListener('mouseenter', this.mousenterListener);\r\n        this.element.removeEventListener('mouseleave', this.mouseleaveListener);\r\n        delete this.bundle;\r\n    }\r\n    onComponentUpdated(eventId, componentUpdatedData) {\r\n        const requiresReplayingDecorators = componentUpdatedData && componentUpdatedData.requiresReplayingDecorators;\r\n        const isCurrentComponent = componentUpdatedData &&\r\n            componentUpdatedData.componentId === this.smarteditComponentId &&\r\n            componentUpdatedData.componentType === this.smarteditComponentType;\r\n        if (isCurrentComponent && requiresReplayingDecorators) {\r\n            this.appendDecorators();\r\n        }\r\n    }\r\n    getUuid(element) {\r\n        return element.getAttribute(ELEMENT_UUID_ATTRIBUTE);\r\n    }\r\n    get uuid() {\r\n        return this.element.getAttribute(ELEMENT_UUID_ATTRIBUTE);\r\n    }\r\n    get element() {\r\n        return this.elementRef.nativeElement;\r\n    }\r\n};\r\n__decorate([\r\n    Input('data-smartedit-component-id'),\r\n    __metadata(\"design:type\", String)\r\n], SmarteditElementComponent.prototype, \"smarteditComponentId\", void 0);\r\n__decorate([\r\n    Input('data-smartedit-component-uuid'),\r\n    __metadata(\"design:type\", String)\r\n], SmarteditElementComponent.prototype, \"smarteditComponentUuid\", void 0);\r\n__decorate([\r\n    Input('data-smartedit-component-type'),\r\n    __metadata(\"design:type\", String)\r\n], SmarteditElementComponent.prototype, \"smarteditComponentType\", void 0);\r\n__decorate([\r\n    Input('data-smartedit-container-id'),\r\n    __metadata(\"design:type\", String)\r\n], SmarteditElementComponent.prototype, \"smarteditContainerId\", void 0);\r\n__decorate([\r\n    Input('data-smartedit-container-type'),\r\n    __metadata(\"design:type\", String)\r\n], SmarteditElementComponent.prototype, \"smarteditContainerType\", void 0);\r\nSmarteditElementComponent = __decorate([\r\n    SeCustomComponent(),\r\n    Component({\r\n        selector: smarteditElementComponentSelector,\r\n        template: ` <div id=\"projectedContent\"><ng-content></ng-content></div> `\r\n    }),\r\n    __metadata(\"design:paramtypes\", [ElementRef,\r\n        SakExecutorService,\r\n        SystemEventService,\r\n        CrossFrameEventService,\r\n        PolyfillService])\r\n], SmarteditElementComponent);\r\nexport { SmarteditElementComponent };\r\n//# sourceMappingURL=SmarteditElementComponent.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit/src/services/sakExecutor/SakExecutorService.ts"],"map":"{\"version\":3,\"file\":\"SmarteditElementComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/services/sakExecutor/SmarteditElementComponent.ts\"],\"names\":[],\"mappings\":\";AAAA;;GAEG;AACH,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,KAAK,EAAE,MAAM,eAAe,CAAC;AAE7D,OAAO,EAEH,sBAAsB,EACtB,sBAAsB,EACtB,yBAAyB,EACzB,2BAA2B,EAC3B,iCAAiC,EACjC,eAAe,EACf,iBAAiB,EACjB,kBAAkB,EAClB,8BAA8B,EACjC,MAAM,kBAAkB,CAAC;AAC1B,OAAO,EAAE,kBAAkB,EAAE,MAAM,sBAAsB,CAAC;AAE1D,MAAM,iCAAiC,GAAG,mBAAmB,CAAC;mFAGnD;IACP,QAAQ,EAAE,iCAAiC;IAC3C,QAAQ,EAAE,8DAA8D;CAC3E;AACD,IAAa,yBAAyB,GAAtC,MAAa,yBAAyB;IA+BlC,YACY,UAAsB,EACtB,kBAAsC,EACtC,kBAAsC,EACtC,sBAA8C,EAC9C,eAAgC;QAJhC,eAAU,GAAV,UAAU,CAAY;QACtB,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,2BAAsB,GAAtB,sBAAsB,CAAwB;QAC9C,oBAAe,GAAf,eAAe,CAAiB;QApBrC,WAAM,GAAG,KAAK,CAAC;QAEd,8BAAyB,GAAG,IAAI,CAAC;QA4GjC,qBAAgB,GAAG,GAAS,EAAE;YAClC,2CAA2C;YAC3C,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;gBACnD,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aACzC;YACD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC;YACpC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAC1C,CAAC,CAAC;QAEM,qBAAgB,GAAG,GAAS,EAAE;YAClC,2CAA2C;YAC3C,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;gBACnD,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aACzC;YAED,IAAI,CAAC,kBAAkB;iBAClB,cAAc,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,OAAO,CAAC;iBACnD,IAAI,CAAC,CAAC,MAAmB,EAAE,EAAE;gBAC1B,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;gBACrB,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAC1C,CAAC,CAAC,CAAC;QACX,CAAC,CAAC;QAkBM,mCAA8B,GAAG,GAAS,EAAE;YAChD,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,CAAC,OAAoB,EAAE,EAAE;gBACvE,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;oBACrC,OAAO,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC;iBACpD;YACL,CAAC,CAAC,CAAC;QACP,CAAC,CAAC;IAtIC,CAAC;IAEJ,QAAQ;QACJ,MAAM,uBAAuB,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,mBAAmB,CAAC,CAAC;QAChF,IAAI,CAAC,gBAAgB,GAAG,uBAAuB,CAAC,QAAQ,CAAC,CAAC,CAAgB,CAAC;QAE3E,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,uBAAuB,CAAC,CAAC;QAClD,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC5B,CAAC;IAED,eAAe;QACX,IAAI,CAAC,iBAAiB,GAAG,CAAC,KAAY,EAAQ,EAAE;YAC5C,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBACd,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,yBAAyB,CAAC;gBAC7C,IAAI,CAAC,8BAA8B,EAAE,CAAC;aACzC;QACL,CAAC,CAAC;QAEF,IAAI,CAAC,kBAAkB,GAAG,CAAC,KAAY,EAAQ,EAAE;YAC7C,IAAI,IAAI,CAAC,MAAM,EAAE;gBACb,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;gBACpB,IAAI,CAAC,8BAA8B,EAAE,CAAC;aACzC;QACL,CAAC,CAAC;QAEF,2BAA2B;QAC3B,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,YAAY,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;QACpE,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,YAAY,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;QAErE,IAAI,CAAC,gCAAgC,GAAG,IAAI,CAAC,sBAAsB,CAAC,SAAS,CACzE,yBAAyB,EACzB,CAAC,OAAe,EAAE,UAAmB,EAAE,EAAE;YACrC,UAAU,IAAI,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC1C,CAAC,CACJ,CAAC;QACF,IAAI,CAAC,mCAAmC,GAAG,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAC5E,2BAA2B,EAC3B,CAAC,OAAe,EAAE,UAAmB,EAAE,EAAE;YACrC,UAAU,IAAI,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC1C,CAAC,CACJ,CAAC;QACF,IAAI,CAAC,+BAA+B,GAAG,IAAI,CAAC,sBAAsB,CAAC,SAAS,CACxE,iCAAiC,EACjC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CACrC,CAAC;QAEF,iHAAiH;QACjH,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,CACvD,8BAA8B,CAAC,eAAe,EAC9C,CACI,OAAe,EACf,yCAAmE,EACrE,EAAE;YACA,IACI,IAAI,CAAC,eAAe,CAAC,wBAAwB,EAAE;gBAC/C,yCAAyC;gBACzC,IAAI,CAAC,IAAI;oBACL,yCAAyC,CAAC,IAAI,CAAC,sBAAsB,CAAC,EAC5E;gBACE,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC;gBACvC,IAAI,CAAC,gBAAgB,EAAE,CAAC;aAC3B;QACL,CAAC,CACJ,CAAC;QAEF,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,CACrD,8BAA8B,CAAC,aAAa,EAC5C,GAAG,EAAE;YACD,IAAI,IAAI,CAAC,eAAe,CAAC,wBAAwB,EAAE,EAAE;gBACjD,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;gBACtC,IAAI,CAAC,gBAAgB,EAAE,CAAC;aAC3B;QACL,CAAC,CACJ,CAAC;IACN,CAAC;IAED,WAAW;QACP,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,gCAAgC,EAAE,CAAC;QACxC,IAAI,CAAC,mCAAmC,EAAE,CAAC;QAC3C,IAAI,CAAC,+BAA+B,EAAE,CAAC;QACvC,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC1B,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,YAAY,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;QACvE,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,YAAY,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;QAExE,OAAO,IAAI,CAAC,MAAM,CAAC;IACvB,CAAC;IAyBO,kBAAkB,CACtB,OAAe,EACf,oBAA+C;QAE/C,MAAM,2BAA2B,GAC7B,oBAAoB,IAAI,oBAAoB,CAAC,2BAA2B,CAAC;QAC7E,MAAM,kBAAkB,GACpB,oBAAoB;YACpB,oBAAoB,CAAC,WAAW,KAAK,IAAI,CAAC,oBAAoB;YAC9D,oBAAoB,CAAC,aAAa,KAAK,IAAI,CAAC,sBAAsB,CAAC;QAEvE,IAAI,kBAAkB,IAAI,2BAA2B,EAAE;YACnD,IAAI,CAAC,gBAAgB,EAAE,CAAC;SAC3B;IACL,CAAC;IAUO,OAAO,CAAC,OAAoB;QAChC,OAAO,OAAO,CAAC,YAAY,CAAC,sBAAsB,CAAC,CAAC;IACxD,CAAC;IAED,IAAY,IAAI;QACZ,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,sBAAsB,CAAC,CAAC;IAC7D,CAAC;IAED,IAAY,OAAO;QACf,OAAO,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC;IACzC,CAAC;CACJ,CAAA;AAtLG;IADC,KAAK,CAAC,6BAA6B,CAAC;;uEACD;AAGpC;IADC,KAAK,CAAC,+BAA+B,CAAC;;yEACD;AAGtC;IADC,KAAK,CAAC,+BAA+B,CAAC;;yEACD;AAGtC;IADC,KAAK,CAAC,6BAA6B,CAAC;;uEACD;AAGpC;IADC,KAAK,CAAC,+BAA+B,CAAC;;yEACD;AAd7B,yBAAyB;IALrC,iBAAiB,EAAE;IACnB,SAAS,CAAC;QACP,QAAQ,EAAE,iCAAiC;QAC3C,QAAQ,EAAE,8DAA8D;KAC3E,CAAC;qCAiC0B,UAAU;QACF,kBAAkB;QAClB,kBAAkB;QACd,sBAAsB;QAC7B,eAAe;GApCnC,yBAAyB,CAwLrC;SAxLY,yBAAyB\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit/node_modules/.cache/rollup-plugin-typescript2/placeholder/services/sakExecutor/SmarteditElementComponent.d.ts","writeByteOrderMark":false,"text":"import { ElementRef } from '@angular/core';\r\nimport { CrossFrameEventService, PolyfillService, SystemEventService } from 'smarteditcommons';\r\nimport { SakExecutorService } from './SakExecutorService';\r\nexport declare class SmarteditElementComponent {\r\n    private elementRef;\r\n    private sakExecutorService;\r\n    private systemEventService;\r\n    private crossFrameEventService;\r\n    private polyfillService;\r\n    smarteditComponentId: string;\r\n    smarteditComponentUuid: string;\r\n    smarteditComponentType: string;\r\n    smarteditContainerId: string;\r\n    smarteditContainerType: string;\r\n    active: boolean;\r\n    private componentDecoratorEnabled;\r\n    private projectedContent;\r\n    private bundle;\r\n    private unregisterPerspectiveChangeEvent;\r\n    private unregisterPerspectiveRefreshedEvent;\r\n    private unregisterComponentUpdatedEvent;\r\n    private unregisterDnDEnd;\r\n    private unregisterDnDStart;\r\n    private mousenterListener;\r\n    private mouseleaveListener;\r\n    constructor(elementRef: ElementRef, sakExecutorService: SakExecutorService, systemEventService: SystemEventService, crossFrameEventService: CrossFrameEventService, polyfillService: PolyfillService);\r\n    ngOnInit(): void;\r\n    ngAfterViewInit(): void;\r\n    ngOnDestroy(): void;\r\n    private removeDecorators;\r\n    private appendDecorators;\r\n    private onComponentUpdated;\r\n    private propagateActiveStateToChildren;\r\n    private getUuid;\r\n    private get uuid();\r\n    private get element();\r\n}\r\n"}}
