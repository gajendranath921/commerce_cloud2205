{"code":"import { __decorate, __metadata } from \"tslib\";\r\n/*\r\n * Copyright (c) 2022 SAP SE or an SAP affiliate company. All rights reserved.\r\n */\r\nimport { GatewayProxied, IExperienceService, IPreviewService, LogService, SeDowngradeService, SmarteditRoutingService } from 'smarteditcommons';\r\n/** @internal */\r\nlet /* @ngInject */ ExperienceService = class /* @ngInject */ ExperienceService extends IExperienceService {\r\n    constructor(routingService, logService, previewService) {\r\n        super();\r\n        this.routingService = routingService;\r\n        this.logService = logService;\r\n        this.previewService = previewService;\r\n    }\r\n    buildRefreshedPreviewUrl() {\r\n        return this.getCurrentExperience().then((experience) => {\r\n            if (!experience) {\r\n                throw new Error('ExperienceService.buildRefreshedPreviewUrl() - Invalid experience from ExperienceService.getCurrentExperience()');\r\n            }\r\n            const promise = this.previewService.getResourcePathFromPreviewUrl(experience.siteDescriptor.previewUrl);\r\n            return promise.then((resourcePath) => {\r\n                const previewData = this._convertExperienceToPreviewData(experience, resourcePath);\r\n                return this.previewService.updateUrlWithNewPreviewTicketId(this.routingService.absUrl(), previewData);\r\n            }, (err) => {\r\n                this.logService.error('ExperienceService.buildRefreshedPreviewUrl() - failed to retrieve resource path');\r\n                return Promise.reject(err);\r\n            });\r\n        }, (err) => {\r\n            this.logService.error('ExperienceService.buildRefreshedPreviewUrl() - failed to retrieve current experience');\r\n            return Promise.reject(err);\r\n        });\r\n    }\r\n};\r\n/* @ngInject */ ExperienceService = __decorate([\r\n    SeDowngradeService(IExperienceService),\r\n    GatewayProxied('loadExperience', 'updateExperiencePageContext', 'getCurrentExperience', 'setCurrentExperience', 'hasCatalogVersionChanged', 'buildRefreshedPreviewUrl', 'compareWithCurrentExperience'),\r\n    __metadata(\"design:paramtypes\", [SmarteditRoutingService,\r\n        LogService,\r\n        IPreviewService])\r\n], /* @ngInject */ ExperienceService);\r\nexport { /* @ngInject */ ExperienceService };\r\n//# sourceMappingURL=ExperienceServiceInner.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"ExperienceServiceInner.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/services/ExperienceServiceInner.ts\"],\"names\":[],\"mappings\":\";AAAA;;GAEG;AACH,OAAO,EACH,cAAc,EAEd,kBAAkB,EAElB,eAAe,EACf,UAAU,EACV,kBAAkB,EAClB,uBAAuB,EAC1B,MAAM,kBAAkB,CAAC;AAE1B,gBAAgB;AAWhB,wCAAA,uCAA+B,SAAQ,kBAAkB;IACrD,YACY,cAAuC,EACvC,UAAsB,EACtB,cAA+B;QAEvC,KAAK,EAAE,CAAC;QAJA,mBAAc,GAAd,cAAc,CAAyB;QACvC,eAAU,GAAV,UAAU,CAAY;QACtB,mBAAc,GAAd,cAAc,CAAiB;IAG3C,CAAC;IAED,wBAAwB;QACpB,OAAO,IAAI,CAAC,oBAAoB,EAAE,CAAC,IAAI,CACnC,CAAC,UAAuB,EAAE,EAAE;YACxB,IAAI,CAAC,UAAU,EAAE;gBACb,MAAM,IAAI,KAAK,CACX,iHAAiH,CACpH,CAAC;aACL;YAED,MAAM,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,6BAA6B,CAC7D,UAAU,CAAC,cAAc,CAAC,UAAU,CACvC,CAAC;YAEF,OAAO,OAAO,CAAC,IAAI,CACf,CAAC,YAAoB,EAAE,EAAE;gBACrB,MAAM,WAAW,GAAiB,IAAI,CAAC,+BAA+B,CAClE,UAAU,EACV,YAAY,CACf,CAAC;gBAEF,OAAO,IAAI,CAAC,cAAc,CAAC,+BAA+B,CACtD,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,EAC5B,WAAW,CACd,CAAC;YACN,CAAC,EACD,CAAC,GAAQ,EAAE,EAAE;gBACT,IAAI,CAAC,UAAU,CAAC,KAAK,CACjB,iFAAiF,CACpF,CAAC;gBACF,OAAO,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;YAC/B,CAAC,CACJ,CAAC;QACN,CAAC,EACD,CAAC,GAAQ,EAAE,EAAE;YACT,IAAI,CAAC,UAAU,CAAC,KAAK,CACjB,sFAAsF,CACzF,CAAC;YACF,OAAO,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QAC/B,CAAC,CACJ,CAAC;IACN,CAAC;CACJ,CAAA;AAlDD;IAVC,kBAAkB,CAAC,kBAAkB,CAAC;IACtC,cAAc,CACX,gBAAgB,EAChB,6BAA6B,EAC7B,sBAAsB,EACtB,sBAAsB,EACtB,0BAA0B,EAC1B,0BAA0B,EAC1B,8BAA8B,CACjC;qCAG+B,uBAAuB;QAC3B,UAAU;QACN,eAAe;qCA8C9C\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit/node_modules/.cache/rollup-plugin-typescript2/placeholder/services/ExperienceServiceInner.d.ts","writeByteOrderMark":false,"text":"import { IExperienceService, IPreviewService, LogService, SmarteditRoutingService } from 'smarteditcommons';\r\n/** @internal */\r\nexport declare class ExperienceService extends IExperienceService {\r\n    private routingService;\r\n    private logService;\r\n    private previewService;\r\n    constructor(routingService: SmarteditRoutingService, logService: LogService, previewService: IPreviewService);\r\n    buildRefreshedPreviewUrl(): Promise<string>;\r\n}\r\n"}}
