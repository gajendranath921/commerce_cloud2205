{"code":"var /* @ngInject */ ToolbarComponent_1;\r\nimport { __awaiter, __decorate, __metadata } from \"tslib\";\r\nimport './toolbar.scss';\r\nimport { ChangeDetectorRef, Component, Injector, Input } from '@angular/core';\r\nimport { EVENTS, IIframeClickDetectionService, IToolbarServiceFactory, SeDowngradeComponent, SmarteditRoutingService, SystemEventService, STORE_FRONT_CONTEXT, TOOLBAR_ITEM, UserTrackingService, USER_TRACKING_FUNCTIONALITY } from 'smarteditcommons';\r\nwindow.__smartedit__.addDecoratorPayload(\"Component\", \"ToolbarComponent\", {\r\n    selector: 'se-toolbar',\r\n    template: `<div class=\"se-toolbar\" [ngClass]=\"cssClass\"><div class=\"se-toolbar__left\"><div *ngFor=\"let item of aliases | seProperty:{section:'left'}; trackBy: trackByFn\" class=\"se-template-toolbar se-template-toolbar__left {{item.className}}\"><se-toolbar-section-item [item]=\"item\"></se-toolbar-section-item></div></div><div class=\"se-toolbar__middle\"><div *ngFor=\"let item of aliases | seProperty:{section:'middle'}; trackBy: trackByFn\" class=\"se-template-toolbar se-template-toolbar__middle {{item.className}}\"><se-toolbar-section-item [item]=\"item\"></se-toolbar-section-item></div></div><div class=\"se-toolbar__right\"><div *ngFor=\"let item of aliases | seProperty:{section:'right'}; trackBy: trackByFn\" class=\"se-template-toolbar se-template-toolbar__right {{item.className}}\"><se-toolbar-section-item [item]=\"item\"></se-toolbar-section-item></div></div></div>`\r\n});\r\nlet /* @ngInject */ ToolbarComponent = /* @ngInject */ ToolbarComponent_1 = class /* @ngInject */ ToolbarComponent {\r\n    constructor(toolbarServiceFactory, iframeClickDetectionService, systemEventService, injector, cdr, routingService, userTrackingService) {\r\n        this.toolbarServiceFactory = toolbarServiceFactory;\r\n        this.iframeClickDetectionService = iframeClickDetectionService;\r\n        this.systemEventService = systemEventService;\r\n        this.injector = injector;\r\n        this.cdr = cdr;\r\n        this.routingService = routingService;\r\n        this.userTrackingService = userTrackingService;\r\n        this.imageRoot = '';\r\n        this.aliases = [];\r\n        this.unregCloseActions = null;\r\n        this.unregCloseAll = null;\r\n        this.unregRecalcPermissions = null;\r\n    }\r\n    ngOnInit() {\r\n        this.setup();\r\n    }\r\n    ngOnDestroy() {\r\n        var _a, _b, _c;\r\n        (_a = this.unregCloseActions) === null || _a === void 0 ? void 0 : _a.call(this);\r\n        (_b = this.unregCloseAll) === null || _b === void 0 ? void 0 : _b.call(this);\r\n        (_c = this.unregRecalcPermissions) === null || _c === void 0 ? void 0 : _c.call(this);\r\n    }\r\n    triggerAction(action, $event) {\r\n        $event.preventDefault();\r\n        this.userTrackingService.trackingUserAction(USER_TRACKING_FUNCTIONALITY.TOOL_BAR, action.key);\r\n        this.toolbarService.triggerAction(action);\r\n    }\r\n    getItemVisibility(item) {\r\n        return item.component && (item.isOpen || item.keepAliveOnClose);\r\n    }\r\n    isOnStorefront() {\r\n        return this.routingService.absUrl().includes(STORE_FRONT_CONTEXT);\r\n    }\r\n    createInjector(item) {\r\n        return Injector.create({\r\n            parent: this.injector,\r\n            providers: [\r\n                {\r\n                    provide: TOOLBAR_ITEM,\r\n                    useValue: item\r\n                }\r\n            ]\r\n        });\r\n    }\r\n    trackByFn(_, item) {\r\n        return item.key;\r\n    }\r\n    closeAllActionItems() {\r\n        this.aliases.forEach((alias) => {\r\n            alias.isOpen = false;\r\n        });\r\n    }\r\n    populatePermissions() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const promises = this.aliases.map((alias) => this.toolbarService._populateIsPermissionGranted(alias));\r\n            this.aliases = yield Promise.all(promises);\r\n        });\r\n    }\r\n    setup() {\r\n        this.buildAliases();\r\n        this.populatePermissions();\r\n        this.registerCallbacks();\r\n    }\r\n    buildAliases() {\r\n        this.toolbarService = this.toolbarServiceFactory.getToolbarService(this.toolbarName);\r\n        this.toolbarService.setOnAliasesChange((aliases) => {\r\n            this.aliases = aliases;\r\n            if (!this.cdr.destroyed) {\r\n                this.cdr.detectChanges();\r\n            }\r\n        });\r\n        this.aliases = this.toolbarService.getAliases();\r\n    }\r\n    registerCallbacks() {\r\n        this.unregCloseActions = this.iframeClickDetectionService.registerCallback(/* @ngInject */ ToolbarComponent_1.CLOSE_ALL_ACTION_ITEMS + this.toolbarName, () => this.closeAllActionItems());\r\n        this.unregCloseAll = this.systemEventService.subscribe(EVENTS.PAGE_SELECTED, () => this.closeAllActionItems());\r\n        this.unregRecalcPermissions = this.systemEventService.subscribe(EVENTS.PERMISSION_CACHE_CLEANED, () => this.populatePermissions());\r\n    }\r\n};\r\n/* @ngInject */ ToolbarComponent.CLOSE_ALL_ACTION_ITEMS = 'closeAllActionItems';\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", String)\r\n], /* @ngInject */ ToolbarComponent.prototype, \"cssClass\", void 0);\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", String)\r\n], /* @ngInject */ ToolbarComponent.prototype, \"toolbarName\", void 0);\r\n__decorate([\r\n    Input(),\r\n    __metadata(\"design:type\", Object)\r\n], /* @ngInject */ ToolbarComponent.prototype, \"imageRoot\", void 0);\r\n/* @ngInject */ ToolbarComponent = /* @ngInject */ ToolbarComponent_1 = __decorate([\r\n    SeDowngradeComponent(),\r\n    Component({\r\n        selector: 'se-toolbar',\r\n        template: `<div class=\"se-toolbar\" [ngClass]=\"cssClass\"><div class=\"se-toolbar__left\"><div *ngFor=\"let item of aliases | seProperty:{section:'left'}; trackBy: trackByFn\" class=\"se-template-toolbar se-template-toolbar__left {{item.className}}\"><se-toolbar-section-item [item]=\"item\"></se-toolbar-section-item></div></div><div class=\"se-toolbar__middle\"><div *ngFor=\"let item of aliases | seProperty:{section:'middle'}; trackBy: trackByFn\" class=\"se-template-toolbar se-template-toolbar__middle {{item.className}}\"><se-toolbar-section-item [item]=\"item\"></se-toolbar-section-item></div></div><div class=\"se-toolbar__right\"><div *ngFor=\"let item of aliases | seProperty:{section:'right'}; trackBy: trackByFn\" class=\"se-template-toolbar se-template-toolbar__right {{item.className}}\"><se-toolbar-section-item [item]=\"item\"></se-toolbar-section-item></div></div></div>`\r\n    }),\r\n    __metadata(\"design:paramtypes\", [IToolbarServiceFactory,\r\n        IIframeClickDetectionService,\r\n        SystemEventService,\r\n        Injector,\r\n        ChangeDetectorRef,\r\n        SmarteditRoutingService,\r\n        UserTrackingService])\r\n], /* @ngInject */ ToolbarComponent);\r\nexport { /* @ngInject */ ToolbarComponent };\r\n//# sourceMappingURL=ToolbarComponent.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-container/src/services/toolbar/services/ToolbarService.ts"],"map":"{\"version\":3,\"file\":\"ToolbarComponent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../src/services/toolbar/components/ToolbarComponent.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/services/toolbar/components/ToolbarComponent.d.ts","writeByteOrderMark":false,"text":"import './toolbar.scss';\r\nimport { ChangeDetectorRef, Injector, OnDestroy, OnInit } from '@angular/core';\r\nimport { IIframeClickDetectionService, IToolbarServiceFactory, SmarteditRoutingService, SystemEventService, ToolbarItemInternal, UserTrackingService } from 'smarteditcommons';\r\nimport { ToolbarService } from '../services/ToolbarService';\r\nexport declare class ToolbarComponent implements OnInit, OnDestroy {\r\n    private toolbarServiceFactory;\r\n    private iframeClickDetectionService;\r\n    private systemEventService;\r\n    private injector;\r\n    private cdr;\r\n    private routingService;\r\n    private userTrackingService;\r\n    static readonly CLOSE_ALL_ACTION_ITEMS = \"closeAllActionItems\";\r\n    cssClass: string;\r\n    toolbarName: string;\r\n    imageRoot: string;\r\n    aliases: ToolbarItemInternal[];\r\n    private unregCloseActions;\r\n    private unregCloseAll;\r\n    private unregRecalcPermissions;\r\n    private toolbarService;\r\n    constructor(toolbarServiceFactory: IToolbarServiceFactory<ToolbarService>, iframeClickDetectionService: IIframeClickDetectionService, systemEventService: SystemEventService, injector: Injector, cdr: ChangeDetectorRef, routingService: SmarteditRoutingService, userTrackingService: UserTrackingService);\r\n    ngOnInit(): void;\r\n    ngOnDestroy(): void;\r\n    triggerAction(action: ToolbarItemInternal, $event: Event): void;\r\n    getItemVisibility(item: ToolbarItemInternal): boolean;\r\n    isOnStorefront(): boolean;\r\n    createInjector(item: ToolbarItemInternal): Injector;\r\n    trackByFn(_: number, item: ToolbarItemInternal): string;\r\n    private closeAllActionItems;\r\n    private populatePermissions;\r\n    private setup;\r\n    private buildAliases;\r\n    private registerCallbacks;\r\n}\r\n"}}
