{"code":"import { __decorate, __metadata } from \"tslib\";\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { distinctUntilChanged, map, skip } from 'rxjs/operators';\r\nimport { EVENT_NOTIFICATION_CHANGED, GatewayProxied, INotificationService, LogService, SeDowngradeService, SystemEventService } from 'smarteditcommons';\r\n/**\r\n * The notification service is used to display visual cues to inform the user of the state of the application.\r\n */\r\n/** @internal */\r\nlet /* @ngInject */ NotificationService = class /* @ngInject */ NotificationService {\r\n    constructor(systemEventService, logService) {\r\n        this.systemEventService = systemEventService;\r\n        this.logService = logService;\r\n        this.notificationsChangeAction = new BehaviorSubject(undefined);\r\n        this.notifications = new BehaviorSubject([]);\r\n        this.initNotificationsChangeAction();\r\n    }\r\n    ngOnDestroy() {\r\n        this.notifications.unsubscribe();\r\n        this.notificationsChangeAction.unsubscribe();\r\n    }\r\n    pushNotification(configuration) {\r\n        const action = {\r\n            type: \"PUSH\" /* PUSH */,\r\n            payload: configuration\r\n        };\r\n        this.notificationsChangeAction.next(action);\r\n        return Promise.resolve();\r\n    }\r\n    removeNotification(notificationId) {\r\n        const action = {\r\n            type: \"REMOVE\" /* REMOVE */,\r\n            payload: {\r\n                id: notificationId\r\n            }\r\n        };\r\n        this.notificationsChangeAction.next(action);\r\n        return Promise.resolve();\r\n    }\r\n    removeAllNotifications() {\r\n        const action = {\r\n            type: \"REMOVE_ALL\" /* REMOVE_ALL */\r\n        };\r\n        this.notificationsChangeAction.next(action);\r\n        return Promise.resolve();\r\n    }\r\n    isNotificationDisplayed(notificationId) {\r\n        return !!this.getNotification(notificationId);\r\n    }\r\n    getNotification(notificationId) {\r\n        return this.notifications\r\n            .getValue()\r\n            .find((notification) => notification.id === notificationId);\r\n    }\r\n    getNotifications() {\r\n        return this.notifications.asObservable();\r\n    }\r\n    initNotificationsChangeAction() {\r\n        this.notificationsChangeAction\r\n            .pipe(distinctUntilChanged((_, action) => this.emitWhenActionIsAvailable(action)), \r\n        // Skip first emission with \"undefined\" value.\r\n        // First \"undefined\" is needed for invoking distinctUntilChanged (which requires at least 2 values emited) when first notification is added.\r\n        skip(1), map((action) => this.resolveNotifications(action)))\r\n            .subscribe((notifications) => {\r\n            this.notifications.next(notifications);\r\n            this.systemEventService.publishAsync(EVENT_NOTIFICATION_CHANGED);\r\n        });\r\n    }\r\n    /**\r\n     * Meant for case when a user has quickly pressed ESC key multiple times.\r\n     * There might be some delay when adding / removing a notification because these methods are called in async context.\r\n     * This may lead to the situation where notification has not yet been removed, but ESC key has called the pushNotification.\r\n     *\r\n     * @returns false (emit), true (do not emit)\r\n     */\r\n    emitWhenActionIsAvailable(action) {\r\n        const { payload: newNotification } = action;\r\n        const notification = (action.type === \"PUSH\" /* PUSH */ ||\r\n            action.type === \"REMOVE\" /* REMOVE */) &&\r\n            this.getNotification(newNotification.id);\r\n        switch (action.type) {\r\n            case \"PUSH\" /* PUSH */:\r\n                if (notification) {\r\n                    this.logService.debug(`Notification already exists for id:\"${newNotification.id}\"`);\r\n                    return true;\r\n                }\r\n                return false;\r\n            case \"REMOVE\" /* REMOVE */:\r\n                if (!notification) {\r\n                    this.logService.debug(`Attempt to remove a non existing notification for id:\"${newNotification.id}\"`);\r\n                    return true;\r\n                }\r\n                return false;\r\n            case \"REMOVE_ALL\" /* REMOVE_ALL */:\r\n                return false;\r\n        }\r\n    }\r\n    resolveNotifications(action) {\r\n        const { payload: newNotification } = action;\r\n        switch (action.type) {\r\n            case \"PUSH\" /* PUSH */:\r\n                return [...this.notifications.getValue(), newNotification];\r\n            case \"REMOVE\" /* REMOVE */:\r\n                return this.notifications\r\n                    .getValue()\r\n                    .filter((notification) => notification.id !== newNotification.id);\r\n            case \"REMOVE_ALL\" /* REMOVE_ALL */:\r\n                return [];\r\n        }\r\n    }\r\n};\r\n/* @ngInject */ NotificationService = __decorate([\r\n    SeDowngradeService(INotificationService),\r\n    GatewayProxied('pushNotification', 'removeNotification', 'removeAllNotifications'),\r\n    __metadata(\"design:paramtypes\", [SystemEventService, LogService])\r\n], /* @ngInject */ NotificationService);\r\nexport { /* @ngInject */ NotificationService };\r\n//# sourceMappingURL=NotificationServiceOuter.js.map","references":["/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/@angular+core@8.2.14_rxjs@6.5.4+zone.js@0.9.1/node_modules/@angular/core/core.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/rxjs@6.5.4/node_modules/rxjs/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedittools/common/temp/node_modules/.pnpm/rxjs@6.5.4/node_modules/rxjs/operators/index.d.ts","/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-commons/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"NotificationServiceOuter.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/services/notifications/NotificationServiceOuter.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/wadmin/Documents/cloud-commerce-sample-setup-update-2211/core-customize/hybris/bin/modules/smartedit/smartedit/apps/smartedit-container/node_modules/.cache/rollup-plugin-typescript2/placeholder/services/notifications/NotificationServiceOuter.d.ts","writeByteOrderMark":false,"text":"import { OnDestroy } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { INotificationConfiguration, INotificationPush, INotificationService, LogService, SystemEventService } from 'smarteditcommons';\r\n/**\r\n * The notification service is used to display visual cues to inform the user of the state of the application.\r\n */\r\n/** @internal */\r\nexport declare class NotificationService implements INotificationService, OnDestroy {\r\n    private systemEventService;\r\n    private logService;\r\n    private notificationsChangeAction;\r\n    private notifications;\r\n    constructor(systemEventService: SystemEventService, logService: LogService);\r\n    ngOnDestroy(): void;\r\n    pushNotification(configuration: INotificationPush): Promise<void>;\r\n    removeNotification(notificationId: string): Promise<void>;\r\n    removeAllNotifications(): Promise<void>;\r\n    isNotificationDisplayed(notificationId: string): boolean;\r\n    getNotification(notificationId: string): INotificationConfiguration;\r\n    getNotifications(): Observable<INotificationConfiguration[]>;\r\n    private initNotificationsChangeAction;\r\n    /**\r\n     * Meant for case when a user has quickly pressed ESC key multiple times.\r\n     * There might be some delay when adding / removing a notification because these methods are called in async context.\r\n     * This may lead to the situation where notification has not yet been removed, but ESC key has called the pushNotification.\r\n     *\r\n     * @returns false (emit), true (do not emit)\r\n     */\r\n    private emitWhenActionIsAvailable;\r\n    private resolveNotifications;\r\n}\r\n"}}
