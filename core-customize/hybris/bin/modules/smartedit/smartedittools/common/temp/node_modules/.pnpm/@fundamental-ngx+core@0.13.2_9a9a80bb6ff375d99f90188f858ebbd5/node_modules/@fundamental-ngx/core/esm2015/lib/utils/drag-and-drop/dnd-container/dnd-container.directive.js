/**
 * @fileoverview added by tsickle
 * Generated from: lib/utils/drag-and-drop/dnd-container/dnd-container.directive.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ContentChild, Directive, ElementRef, EventEmitter, Input, Output } from '@angular/core';
import { CdkDrag } from '@angular/cdk/drag-drop';
export class DndContainerDirective {
    /**
     * @param {?} element
     */
    constructor(element) {
        this.element = element;
        /**
         * Class added to element, when it's dragged.
         */
        this.CLASS_WHEN_ELEMENT_DRAGGED = 'fd-dnd-on-drag';
        /**
         * Event thrown when the element is moved by 1px
         */
        this.moved = new EventEmitter();
        /**
         * Event thrown when the element is released
         */
        this.released = new EventEmitter();
        /**
         * Event thrown when the element is started to be dragged
         */
        this.started = new EventEmitter();
        /**
         * Whether this element should stick in one place, without changing position
         */
        this.stickInPlace = false;
    }
    /**
     * @hidden
     * @param {?} isBefore
     * @param {?} listMode
     * @return {?}
     */
    getElementChord(isBefore, listMode) {
        /**
         * Takes distance from the beginning of window page
         * @type {?}
         */
        const rect = (/** @type {?} */ (this.element.nativeElement.getBoundingClientRect()));
        /** @type {?} */
        const position = isBefore ? 'before' : 'after';
        /**
         * Depending on the position, gets the left or right side of element
         * @type {?}
         */
        const x = rect.x + (isBefore || listMode ? 0 : this.element.nativeElement.offsetWidth);
        /** Vertically distance is counted by distance from top of the side + half of the element height */
        return {
            x: x,
            position: position,
            y: rect.y + (this.element.nativeElement.offsetHeight / 2),
            stickToPosition: this.stickInPlace
        };
    }
    /**
     * @hidden
     * @return {?}
     */
    ngAfterContentInit() {
        this.cdkDrag.moved.subscribe((/**
         * @param {?} event
         * @return {?}
         */
        (event) => {
            this.onCdkMove(event);
        }));
        this.cdkDrag.released.subscribe((/**
         * @return {?}
         */
        () => {
            this.onCdkDragReleased();
        }));
        this.cdkDrag.started.subscribe((/**
         * @return {?}
         */
        () => {
            this.onCdkDragStart();
        }));
    }
    /**
     * @hidden
     * @param {?} cdkMovedEvent
     * @return {?}
     */
    onCdkMove(cdkMovedEvent) {
        this.moved.emit(cdkMovedEvent);
    }
    /**
     * @hidden
     * @return {?}
     */
    onCdkDragReleased() {
        /** Remove class which is added, when element is dragged */
        this.element.nativeElement.classList.remove(this.CLASS_WHEN_ELEMENT_DRAGGED);
        this.released.emit();
        /** Resets the position of element. */
        this.cdkDrag.reset();
        /** Removes placeholder element */
        this.removePlaceholder();
    }
    /**
     * @hidden
     * @return {?}
     */
    onCdkDragStart() {
        /** Adds class */
        this.element.nativeElement.classList.add(this.CLASS_WHEN_ELEMENT_DRAGGED);
        if (!this.placeholderElement) {
            this.createPlaceHolder();
        }
        this.started.emit();
    }
    /**
     * @hidden
     * @return {?}
     */
    removePlaceholder() {
        if (this.placeholderElement) {
            this.placeholderElement.remove();
            this.placeholderElement = null;
        }
    }
    /**
     * @hidden
     * @return {?}
     */
    removeLine() {
        if (this.lineElement) {
            this.lineElement.remove();
            this.lineElement = null;
        }
    }
    /**
     * @hidden
     * @param {?} position
     * @param {?} listMode
     * @return {?}
     */
    createLine(position, listMode) {
        /** Creating of line element */
        this.lineElement = document.createElement('DIV');
        if (listMode) {
            this.lineElement.classList.add('drop-area__line');
            this.lineElement.classList.add('drop-area__line--horizontal');
        }
        else {
            this.lineElement.classList.add('drop-area__line');
            this.lineElement.classList.add('drop-area__line--vertical');
        }
        if (position === 'after') {
            this.lineElement.classList.add('after');
        }
        if (position === 'before') {
            this.lineElement.classList.add('before');
        }
        /** Putting element to the container */
        this.element.nativeElement.appendChild(this.lineElement);
    }
    /**
     * @hidden
     * @private
     * @return {?}
     */
    createPlaceHolder() {
        /**
         * Cloning container element
         * @type {?}
         */
        const clone = this.cdkDrag.element.nativeElement.cloneNode(true);
        /** Taking cloned element reference */
        this.placeholderElement = clone.firstChild.parentElement;
        this.placeholderElement.classList.add('fd-dnd-placeholder');
        /** Including element to the container */
        this.element.nativeElement.appendChild(clone);
    }
}
DndContainerDirective.decorators = [
    { type: Directive, args: [{
                // tslint:disable-next-line:directive-selector
                selector: '[fd-dnd-container]',
                host: {
                    'class': 'fd-dnd-container'
                }
            },] }
];
/** @nocollapse */
DndContainerDirective.ctorParameters = () => [
    { type: ElementRef }
];
DndContainerDirective.propDecorators = {
    moved: [{ type: Output }],
    released: [{ type: Output }],
    started: [{ type: Output }],
    stickInPlace: [{ type: Input }],
    cdkDrag: [{ type: ContentChild, args: [CdkDrag, { static: false },] }]
};
if (false) {
    /**
     * Class added to element, when it's dragged.
     * @type {?}
     */
    DndContainerDirective.prototype.CLASS_WHEN_ELEMENT_DRAGGED;
    /**
     * @type {?}
     * @private
     */
    DndContainerDirective.prototype.placeholderElement;
    /**
     * @type {?}
     * @private
     */
    DndContainerDirective.prototype.lineElement;
    /**
     * Event thrown when the element is moved by 1px
     * @type {?}
     */
    DndContainerDirective.prototype.moved;
    /**
     * Event thrown when the element is released
     * @type {?}
     */
    DndContainerDirective.prototype.released;
    /**
     * Event thrown when the element is started to be dragged
     * @type {?}
     */
    DndContainerDirective.prototype.started;
    /**
     * Whether this element should stick in one place, without changing position
     * @type {?}
     */
    DndContainerDirective.prototype.stickInPlace;
    /**
     * @hidden
     * @type {?}
     */
    DndContainerDirective.prototype.cdkDrag;
    /** @type {?} */
    DndContainerDirective.prototype.element;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZG5kLWNvbnRhaW5lci5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZnVuZGFtZW50YWwtbmd4L2NvcmUvIiwic291cmNlcyI6WyJsaWIvdXRpbHMvZHJhZy1hbmQtZHJvcC9kbmQtY29udGFpbmVyL2RuZC1jb250YWluZXIuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUVILFlBQVksRUFBRSxTQUFTLEVBQ3ZCLFVBQVUsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUMvQixNQUFNLEVBQ1QsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLE9BQU8sRUFBZSxNQUFNLHdCQUF3QixDQUFDO0FBVTlELE1BQU0sT0FBTyxxQkFBcUI7Ozs7SUEyQjlCLFlBQ1csT0FBbUI7UUFBbkIsWUFBTyxHQUFQLE9BQU8sQ0FBWTs7OztRQXpCckIsK0JBQTBCLEdBQVcsZ0JBQWdCLENBQUM7Ozs7UUFPdEQsVUFBSyxHQUE4QixJQUFJLFlBQVksRUFBZSxDQUFDOzs7O1FBSW5FLGFBQVEsR0FBdUIsSUFBSSxZQUFZLEVBQVEsQ0FBQzs7OztRQUl4RCxZQUFPLEdBQXVCLElBQUksWUFBWSxFQUFRLENBQUM7Ozs7UUFHdkQsaUJBQVksR0FBWSxLQUFLLENBQUM7SUFRcEMsQ0FBQzs7Ozs7OztJQUdHLGVBQWUsQ0FBQyxRQUFpQixFQUFFLFFBQWlCOzs7OztjQUdqRCxJQUFJLEdBQUcsbUJBQVMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMscUJBQXFCLEVBQUUsRUFBQTs7Y0FFbEUsUUFBUSxHQUFpQixRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsT0FBTzs7Ozs7Y0FHdEQsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLFdB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SUFFL0QsbURBQXdDOzs7OztJQUV4Qyw0Q0FBaUM7Ozs7O0lBRWpDLHNDQUM0RTs7Ozs7SUFHNUUseUNBQ2lFOzs7OztJQUdqRSx3Q0FDZ0U7Ozs7O0lBR2hFLDZDQUF1Qzs7Ozs7SUFHdkMsd0NBQ2lCOztJQUdiLHdDQUEwQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gICAgQWZ0ZXJDb250ZW50SW5pdCxcbiAgICBDb250ZW50Q2hpbGQsIERpcmVjdGl2ZSxcbiAgICBFbGVtZW50UmVmLCBFdmVudEVtaXR0ZXIsIElucHV0LFxuICAgIE91dHB1dFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENka0RyYWcsIENka0RyYWdNb3ZlIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2RyYWctZHJvcCc7XG5pbXBvcnQgeyBFbGVtZW50Q2hvcmQsIExpbmtQb3NpdGlvbiB9IGZyb20gJy4uL2RuZC1saXN0L2RuZC1saXN0LmRpcmVjdGl2ZSc7XG5cbkBEaXJlY3RpdmUoe1xuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpkaXJlY3RpdmUtc2VsZWN0b3JcbiAgICBzZWxlY3RvcjogJ1tmZC1kbmQtY29udGFpbmVyXScsXG4gICAgaG9zdDoge1xuICAgICAgICAnY2xhc3MnOiAnZmQtZG5kLWNvbnRhaW5lcidcbiAgICB9XG59KVxuZXhwb3J0IGNsYXNzIERuZENvbnRhaW5lckRpcmVjdGl2ZSBpbXBsZW1lbnRzIEFmdGVyQ29udGVudEluaXQge1xuXG4gICAgLyoqIENsYXNzIGFkZGVkIHRvIGVsZW1lbnQsIHdoZW4gaXQncyBkcmFnZ2VkLiAqL1xuICAgIHJlYWRvbmx5IENMQVNTX1dIRU5fRUxFTUVOVF9EUkFHR0VEOiBzdHJpbmcgPSAnZmQtZG5kLW9uLWRyYWcnO1xuXG4gICAgcHJpdmF0ZSBwbGFjZWhvbGRlckVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuXG4gICAgcHJpdmF0ZSBsaW5lRWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gICAgLyoqIEV2ZW50IHRocm93biB3aGVuIHRoZSBlbGVtZW50IGlzIG1vdmVkIGJ5IDFweCAqL1xuICAgIEBPdXRwdXQoKVxuICAgIHJlYWRvbmx5IG1vdmVkOiBFdmVudEVtaXR0ZXI8Q2RrRHJhZ01vdmU+ID0gbmV3IEV2ZW50RW1pdHRlcjxDZGtEcmFnTW92ZT4oKTtcblxuICAgIC8qKiBFdmVudCB0aHJvd24gd2hlbiB0aGUgZWxlbWVudCBpcyByZWxlYXNlZCAqL1xuICAgIEBPdXRwdXQoKVxuICAgIHJlYWRvbmx5IHJlbGVhc2VkOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG5cbiAgICAvKiogRXZlbnQgdGhyb3duIHdoZW4gdGhlIGVsZW1lbnQgaXMgc3RhcnRlZCB0byBiZSBkcmFnZ2VkICovXG4gICAgQE91dHB1dCgpXG4gICAgcmVhZG9ubHkgc3RhcnRlZDogRXZlbnRFbWl0dGVyPHZvaWQ+ID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuXG4gICAgLyoqIFdoZXRoZXIgdGhpcyBlbGVtZW50IHNob3VsZCBzdGljayBpbiBvbmUgcGxhY2UsIHdpdGhvdXQgY2hhbmdpbmcgcG9zaXRpb24gKi9cbiAgICBASW5wdXQoKSBzdGlja0luUGxhY2U6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIC8qKiBAaGlkZGVuICovXG4gICAgQENvbnRlbnRDaGlsZChDZGtEcmFnLCB7IHN0YXRpYzogZmFsc2UgfSlcbiAgICBjZGtEcmFnOiBDZGtEcmFnO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBlbGVtZW50OiBFbGVtZW50UmVmLFxuICAgICkge31cblxuICAgIC8qKiBAaGlkZGVuICovXG4gICAgcHVibGljIGdldEVsZW1lbnRDaG9yZChpc0JlZm9yZTogYm9vbGVhbiwgbGlzdE1vZGU6IGJvb2xlYW4pOiBFbGVtZW50Q2hvcmQge1xuXG4gICAgICAgIC8qKiBUYWtlcyBkaXN0YW5jZSBmcm9tIHRoZSBiZWdpbm5pbmcgb2Ygd2luZG93IHBhZ2UgKi9cbiAgICAgICAgY29uc3QgcmVjdCA9IDxET01SZWN0PnRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgIGNvbnN0IHBvc2l0aW9uOiBMaW5rUG9zaXRpb24gPSBpc0JlZm9yZSA/ICdiZWZvcmUnIDogJ2FmdGVyJztcblxuICAgICAgICAvKiogRGVwZW5kaW5nIG9uIHRoZSBwb3NpdGlvbiwgZ2V0cyB0aGUgbGVmdCBvciByaWdodCBzaWRlIG9mIGVsZW1lbnQgKi9cbiAgICAgICAgY29uc3QgeCA9IHJlY3QueCArIChpc0JlZm9yZSB8fCBsaXN0TW9kZSA/IDAgOiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aCk7XG5cbiAgICAgICAgLyoqIFZlcnRpY2FsbHkgZGlzdGFuY2UgaXMgY291bnRlZCBieSBkaXN0YW5jZSBmcm9tIHRvcCBvZiB0aGUgc2lkZSArIGhhbGYgb2YgdGhlIGVsZW1lbnQgaGVpZ2h0ICovXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgICAgICAgeTogcmVjdC55ICsgKHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50Lm9mZnNldEhlaWdodCAvIDIpLFxuICAgICAgICAgICAgc3RpY2tUb1Bvc2l0aW9uOiB0aGlzLnN0aWNrSW5QbGFjZVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKiBAaGlkZGVuICovXG4gICAgcHVibGljIG5nQWZ0ZXJDb250ZW50SW5pdCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jZGtEcmFnLm1vdmVkLnN1YnNjcmliZSgoZXZlbnQ6IENka0RyYWdNb3ZlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uQ2RrTW92ZShldmVudCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNka0RyYWcucmVsZWFzZWQuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25DZGtEcmFnUmVsZWFzZWQoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY2RrRHJhZy5zdGFydGVkLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uQ2RrRHJhZ1N0YXJ0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKiBAaGlkZGVuICovXG4gICAgcHVibGljIG9uQ2RrTW92ZShjZGtNb3ZlZEV2ZW50OiBDZGtEcmFnTW92ZSk6IHZvaWQge1xuICAgICAgICB0aGlzLm1vdmVkLmVtaXQoY2RrTW92ZWRFdmVudCk7XG4gICAgfVxuXG4gICAgLyoqIEBoaWRkZW4gKi9cbiAgICBwdWJsaWMgb25DZGtEcmFnUmVsZWFzZWQoKTogdm9pZCB7XG4gICAgICAgIC8qKiBSZW1vdmUgY2xhc3Mgd2hpY2ggaXMgYWRkZWQsIHdoZW4gZWxlbWVudCBpcyBkcmFnZ2VkICovXG4gICAgICAgIHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5DTEFTU19XSEVOX0VMRU1FTlRfRFJBR0dFRCk7XG4gICAgICAgIHRoaXMucmVsZWFzZWQuZW1pdCgpO1xuXG4gICAgICAgIC8qKiBSZXNldHMgdGhlIHBvc2l0aW9uIG9mIGVsZW1lbnQuICovXG4gICAgICAgIHRoaXMuY2RrRHJhZy5yZXNldCgpO1xuXG4gICAgICAgIC8qKiBSZW1vdmVzIHBsYWNlaG9sZGVyIGVsZW1lbnQgKi9cbiAgICAgICAgdGhpcy5yZW1vdmVQbGFjZWhvbGRlcigpO1xuICAgIH1cblxuICAgIC8qKiBAaGlkZGVuICovXG4gICAgcHVibGljIG9uQ2RrRHJhZ1N0YXJ0KCk6IHZvaWQge1xuICAgICAgICAvKiogQWRkcyBjbGFzcyAqL1xuICAgICAgICB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuQ0xBU1NfV0hFTl9FTEVNRU5UX0RSQUdHRUQpO1xuICAgICAgICBpZiAoIXRoaXMucGxhY2Vob2xkZXJFbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVBsYWNlSG9sZGVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGFydGVkLmVtaXQoKTtcbiAgICB9XG5cbiAgICAvKiogQGhpZGRlbiAqL1xuICAgIHB1YmxpYyByZW1vdmVQbGFjZWhvbGRlcigpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMucGxhY2Vob2xkZXJFbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLnBsYWNlaG9sZGVyRWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMucGxhY2Vob2xkZXJFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBAaGlkZGVuICovXG4gICAgcHVibGljIHJlbW92ZUxpbmUoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmxpbmVFbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLmxpbmVFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy5saW5lRWxlbWVudCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKiogQGhpZGRlbiAqL1xuICAgIHB1YmxpYyBjcmVhdGVMaW5lKHBvc2l0aW9uOiBMaW5rUG9zaXRpb24sIGxpc3RNb2RlOiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIC8qKiBDcmVhdGluZyBvZiBsaW5lIGVsZW1lbnQgKi9cbiAgICAgICAgdGhpcy5saW5lRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xuICAgICAgICBpZiAobGlzdE1vZGUpIHtcbiAgICAgICAgICAgIHRoaXMubGluZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZHJvcC1hcmVhX19saW5lJyk7XG4gICAgICAgICAgICB0aGlzLmxpbmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Ryb3AtYXJlYV9fbGluZS0taG9yaXpvbnRhbCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5saW5lRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdkcm9wLWFyZWFfX2xpbmUnKTtcbiAgICAgICAgICAgIHRoaXMubGluZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZHJvcC1hcmVhX19saW5lLS12ZXJ0aWNhbCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwb3NpdGlvbiA9PT0gJ2FmdGVyJykge1xuICAgICAgICAgICAgdGhpcy5saW5lRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhZnRlcicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwb3NpdGlvbiA9PT0gJ2JlZm9yZScpIHtcbiAgICAgICAgICAgIHRoaXMubGluZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYmVmb3JlJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiogUHV0dGluZyBlbGVtZW50IHRvIHRoZSBjb250YWluZXIgKi9cbiAgICAgICAgdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5saW5lRWxlbWVudCk7XG4gICAgfVxuXG4gICAgLyoqIEBoaWRkZW4gKi9cbiAgICBwcml2YXRlIGNyZWF0ZVBsYWNlSG9sZGVyKCk6IHZvaWQge1xuICAgICAgICAvKiogQ2xvbmluZyBjb250YWluZXIgZWxlbWVudCAqL1xuICAgICAgICBjb25zdCBjbG9uZSA9IHRoaXMuY2RrRHJhZy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgICAgIC8qKiBUYWtpbmcgY2xvbmVkIGVsZW1lbnQgcmVmZXJlbmNlICovXG4gICAgICAgIHRoaXMucGxhY2Vob2xkZXJFbGVtZW50ID0gY2xvbmUuZmlyc3RDaGlsZC5wYXJlbnRFbGVtZW50O1xuXG4gICAgICAgIHRoaXMucGxhY2Vob2xkZXJFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2ZkLWRuZC1wbGFjZWhvbGRlcicpO1xuXG4gICAgICAgIC8qKiBJbmNsdWRpbmcgZWxlbWVudCB0byB0aGUgY29udGFpbmVyICovXG4gICAgICAgIHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LmFwcGVuZENoaWxkKGNsb25lKTtcbiAgICB9XG59XG4iXX0=